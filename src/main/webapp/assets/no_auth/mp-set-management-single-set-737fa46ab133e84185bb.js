(window.webpackJsonp=window.webpackJsonp||[]).push([[382],{1433:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var s=n(11),i=n(1),r=n(43),a=n(7),o=n(34),l=n(56),d=n(162),S=n(23),p=n(1830),c=n(1214),m=n(327),g=n(1632),h=n(1633),u=n(1833),_=n(2253),f=n(2255),C=n(2256),E=n(2261),A=n(1285),v=function(e){function SingleSet(t,n){var s=e.call(this,t,n)||this;return s.cancellation=new o.Cancellation,s.onDragStart=function(){return s.setViewState({draggingItem:!0})},s.onDragEnd=function(){return s.setViewState({draggingItem:!1})},s.state=s.pendingState=_.ViewModel.loadState(s.props),s.model=new _.ViewModel({props:s.props,cancellation:s.cancellation,getState:function(){return s.pendingState},setState:function(e){return s.setViewState(e)},getContext:function(){return s.context.semanticContext},trigger:function(e,t){return s.trigger(e,t)}}),s}return s.__extends(SingleSet,e),SingleSet.prototype.getChildContext=function(){var t=this,n=e.prototype.getChildContext.call(this),i={"mp-set-management":{removeSet:this.model.removeSet,removeSetItem:this.model.removeSetItem,startRenamingSet:this.model.startRenamingSet,fetchSetItems:this.model.fetchSetItems},"mp-set-management--set-view":{getCurrentSet:function(){return t.state.openedSet}}};return s.__assign(s.__assign({},n),i)},SingleSet.prototype.setState=function(t){e.prototype.setState.call(this,t)},SingleSet.prototype.setViewState=function(t){this.pendingState=s.__assign(s.__assign({},this.pendingState),t),e.prototype.setState.call(this,this.pendingState)},SingleSet.prototype.componentDidMount=function(){this.registerEventsListener();var e=_.emptySet(S.Rdf.iri(this.props.openedSet));this.setViewState({sets:r.Map().set(e.iri.value,e)}),this.model.openAndLoadSet(e.iri)},SingleSet.prototype.registerEventsListener=function(){var e=this;this.cancellation.map(d.listen({eventType:d.BuiltInEvents.ComponentRefresh,target:this.props.id})).onValue((function(){return e.model.loadSets({keepItems:!1})}))},SingleSet.prototype.trigger=function(e,t){d.trigger({eventType:e,source:this.props.id,data:t})},SingleSet.prototype.render=function(){var e,t=this,n=a(((e={})[A.CLASS_NAME]=!0,e[A.CLASS_NAME+"--list-view"]="list"===this.state.itemViewMode,e[A.CLASS_NAME+"--grid-view"]="grid"===this.state.itemViewMode,e));return i.createElement(g.DropArea,{className:n,shouldReactToDrag:function(){return!t.state.draggingItem},query:this.props.acceptResourceQuery,onDrop:function(e){var n=_.ViewState.displayedSetIri(t.state);t.model.onDropItemToSet(e,n)},dropMessage:i.createElement("span",null,'Drop items here to add to set "',i.createElement(c.ResourceLabel,{iri:this.props.openedSet}),'"')},this.renderHeader(),this.renderItems())},SingleSet.prototype.renderHeader=function(){var e=this,t=_.ViewState.openedSet(this.state);if(!t)return i.createElement(m.Spinner,null);var n=this.state,r=n.itemsOrdering,a=n.itemViewMode,o=t.items&&t.items.length>0,l=o?{baseClass:A.CLASS_NAME,canReorder:o,isReordering:Boolean(r),onPressReorder:function(){return e.setViewState({itemsOrdering:r?void 0:p.Ordering.empty})},onPressReorderApply:this.model.applyItemsOrder}:void 0;return i.createElement("div",{className:A.CLASS_NAME+"__single-set-header"},i.createElement("div",{className:A.CLASS_NAME+"__single-set-header-top"},this.renderCaption(t),i.createElement("div",{className:A.CLASS_NAME+"__single-set-header-spacer"}),i.createElement(f.SearchAndFilters,{baseClass:A.CLASS_NAME,keywordFilter:this.props.keywordFilter,filters:this.props.filters,setIsOpen:!0,minInputLength:this.model.minSearchTermLength(),searchText:this.state.search.searchText,filterValues:this.state.search.filterValues,onSearchTextChanged:function(t){e.model.onFilterChanged(!0,t,e.state.search.filterValues)},onFilterChanged:function(t){e.model.onFilterChanged(!1,e.state.search.searchText,t)}})),i.createElement("div",{className:A.CLASS_NAME+"__single-set-header-bottom"},this.props.children,i.createElement("div",{className:A.CLASS_NAME+"__single-set-header-spacer"}),l?i.createElement(E.ReorderItemsButton,s.__assign({},l)):null,i.createElement(E.ItemViewModeSwitch,{baseClass:A.CLASS_NAME,mode:a,onModeChanged:this.model.setItemViewMode})),l&&r?i.createElement(E.ReorderConfirmation,s.__assign({},l)):null)},SingleSet.prototype.renderCaption=function(e){var t=this,n=Boolean(e.editing);return i.createElement("div",{className:A.CLASS_NAME+"__single-set-caption"},i.createElement("div",{className:A.CLASS_NAME+"__single-set-icon"},i.createElement("span",{className:"fa fa-folder-open"})),n?i.createElement(C.EditableLabel,{editing:e.editing,onEditCompleted:function(n){return t.model.onSetEditCompleted(e,n)},className:A.CLASS_NAME+"__single-set-label"}):i.createElement(c.ResourceLabel,{iri:this.props.openedSet,className:A.CLASS_NAME+"__single-set-label"}),n?null:i.createElement("button",{type:"button",title:"Rename set",className:A.CLASS_NAME+"__single-set-rename-button",onClick:function(){return t.model.startRenamingSet(e.iri)}},i.createElement("span",{className:"fa fa-pencil"})))},SingleSet.prototype.renderItems=function(){var e=this,t=this.state.itemsOrdering,n=_.ViewState.openedSet(this.state),s=void 0;if(_.ViewState.isSearchOpened(this.state)){s=this.state.search.searchText;var r=this.state.search.results,a=r?r.get(this.props.openedSet):void 0;if(!a)return i.createElement("div",{className:A.CLASS_NAME+"__search-results-empty"},"No results found");n=a}return i.createElement(C.ItemsView,{key:"default-set-items",baseClass:A.CLASS_NAME,set:n,template:this.model.templateForKind,highlightedTerm:s,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,itemsOrdering:t,onOrderChanged:function(t){return e.setViewState({itemsOrdering:t})}})},SingleSet.defaultProps=u.ForAllProps,SingleSet.childContextTypes=s.__assign(s.__assign(s.__assign({},l.Component.childContextTypes),h.SetManagementContextTypes),h.SetViewContextTypes),SingleSet}(l.Component);t.SingleSet=v,t.default=v}}]);
//# sourceMappingURL=mp-set-management-single-set-737fa46ab133e84185bb.js.map