(window.webpackJsonp=window.webpackJsonp||[]).push([[464],{1485:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(11),l=n(1),o=n(72),a=n(10),s=n(16),c=n(19),u=n(33),m=n(56),p=n(23),f=n(633),d=n(162),g=n(634),v=n(116),E=n(327),y=n(216),h=n(1624),S=n(1988),C=n(1588),b=n(3336),A=n(1989),B=n(3337),T=n(3338),_=n(3339),P=n(3340),R=n(1224);!function(e){e[e.Loading=0]="Loading",e[e.Saving=1]="Saving"}(r||(r={}));var F=function(e){function PremiseComponent(t,n){var c=e.call(this,t,n)||this;return c.cancellation=new g.Cancellation,c.editArgument=function(e){c.setState({editingArgumentIndex:s.findIndex(c.state.premises,(function(t){return t===e}))})},c.removeArgument=function(e){c.setState((function(t){return{premises:s.filter(t.premises,(function(t){return t!==e}))}}))},c.argumentFrame=function(e){return l.createElement(o.Form,null,l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Premise"),l.createElement(o.FormControl.Static,null,e.title)),l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Title"),l.createElement(o.FormControl.Static,null,e.argument.title)),e.argument.note?l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Description"),l.createElement(o.FormControl.Static,null,e.argument.note)):null,e.children,l.createElement(o.Button,{bsSize:"sm",bsClass:"btn btn-sm btn-default pull-right",style:{marginLeft:10},onClick:function(){return c.removeArgument(e.argument)}},"Remove Premise"),l.createElement(o.Button,{bsSize:"sm",bsClass:"btn btn-sm btn-default pull-right",onClick:function(){return c.editArgument(e.argument)}},"Edit Premise"),l.createElement("div",{className:"clearfix"}))},c.renderObservationArgument=function(e){return l.createElement(c.argumentFrame,{argument:e,title:"Observation"},l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Place"),l.createElement(o.FormControl.Static,null,l.createElement(m.SemanticContextProvider,{repository:"default"},l.createElement(f.ResourceLinkComponent,{uri:e.place.value})))),l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Date"),l.createElement(o.FormControl.Static,null,a(e.date.value).format("LL"))))},c.renderBeliefAdoptionArgument=function(e){var t=c.props,n=t.assertionBasedBeliefTemplate,r=t.fieldBasedBeliefTemplate;return l.createElement(c.argumentFrame,{argument:e,title:"Adoption"},l.createElement(o.Row,null,l.createElement(o.Col,{md:4},l.createElement(A.ExistingBeliefView,{belief:e.belief,assertionBasedBeliefTemplate:n,fieldBasedBeliefTemplate:r}))))},c.renderInferenceArgument=function(e){var t=c.props,n=t.assertionBasedBeliefTemplate,r=t.fieldBasedBeliefTemplate;return l.createElement(c.argumentFrame,{argument:e,title:"Inference"},l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Logic Type"),l.createElement(o.FormControl.Static,null,l.createElement(m.SemanticContextProvider,{repository:"assets"},l.createElement(f.ResourceLinkComponent,{uri:e.logicType.value})))),l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Evidence"),l.createElement(o.Row,{className:R.evidenceList},e.premises.map((function(e){return l.createElement(o.Col,{md:4,className:R.evidenceList},l.createElement(A.ExistingBeliefView,{belief:e,assertionBasedBeliefTemplate:n,fieldBasedBeliefTemplate:r}))})))))},c.renderPremiseComponent=function(e){switch(e.argumentType){case C.ObservationType:return c.renderObservationArgument(e);case C.BeliefAdoptionType:return c.renderBeliefAdoptionArgument(e);case C.InferenceType:return c.renderInferenceArgument(e)}},c.cancelNewArgument=function(){c.setState({addingPremise:!1,newArgumentType:void 0,editingArgumentIndex:void 0})},c.addArgument=function(e){c.setState((function(t){var n=i.__spreadArrays(t.premises);return t.editingArgumentIndex>=0?n[t.editingArgumentIndex]=e:n.push(e),{premises:n}}))},c.premiseForm=function(e,t){var n=c.props,r=n.acceptEvidenceQuery,i=n.logicTypeQuery,o=n.assertionBasedBeliefTemplate,a=n.fieldBasedBeliefTemplate,addArgument=function(e){c.addArgument(e),c.cancelNewArgument()};return e===C.ObservationType?l.createElement(B.ObservationComponent,{onSave:addArgument,onCancel:c.cancelNewArgument,initialState:t}):e===C.BeliefAdoptionType?l.createElement(T.BeliefAdoptionComponent,{acceptRecordQuery:r,onCancel:c.cancelNewArgument,onSave:addArgument,initialState:t,assertionBasedBeliefTemplate:o}):e===C.InferenceType?l.createElement(_.InferenceMakingComponent,{logicTypeQuery:i,acceptEvidenceQuery:r,onCancel:c.cancelNewArgument,onSave:addArgument,initialState:t,assertionBasedBeliefTemplate:o,fieldBasedBeliefTemplate:a}):l.createElement("p",null,"Select a type of premise for your conclusion")},c.newPremiseSelection=function(){var e=c.state,t=e.premises,n=e.addingPremise,r=e.newArgumentType;return n?l.createElement("div",null,c.premiseTypeSelection(),c.premiseForm(r),t.length?l.createElement("hr",null):null):null},c.premiseTypeSelection=function(){var e="premiseType",onArgumentTypeChange=function(e){return function(){return c.setState({newArgumentType:e})}},isArgumentTypeSelected=function(e){return c.state.newArgumentType===e};return l.createElement(o.FormGroup,null,l.createElement(o.Radio,{name:e,checked:isArgumentTypeSelected(C.ObservationType),onClick:onArgumentTypeChange(C.ObservationType),inline:!0},"Observation"),l.createElement(o.Radio,{name:e,checked:isArgumentTypeSelected(C.BeliefAdoptionType),onClick:onArgumentTypeChange(C.BeliefAdoptionType),inline:!0},"Adoption"),l.createElement(o.Radio,{name:e,checked:isArgumentTypeSelected(C.InferenceType),onClick:onArgumentTypeChange(C.InferenceType),inline:!0},"Inference"))},c.renderPremise=function(e,t,n){var r=c.state.editingArgumentIndex,i=t<n.length-1?l.createElement("hr",null):null;return r===t?l.createElement("div",null,l.createElement(o.FormGroup,null,l.createElement(o.ControlLabel,null,"Premise"),l.createElement(o.FormControl.Static,null,e.argumentType)),c.premiseForm(e.argumentType,e),i):l.createElement("div",null,c.renderPremiseComponent(e),i)},c.state={assertionIri:t.assertion?p.Rdf.iri(t.assertion):void 0,premises:[],status:r.Loading},c}return i.__extends(PremiseComponent,e),PremiseComponent.prototype.componentDidMount=function(){this.state.assertionIri?this.loadArguments():this.setState({status:void 0}),this.listenToEvents()},PremiseComponent.prototype.componentDidUpdate=function(e,t){var n=this.props.onChangeArguments,r=this.state.premises;r!==t.premises&&n&&n(r)},PremiseComponent.prototype.componentWillUnmount=function(){this.cancellation.cancelAll()},PremiseComponent.prototype.loadArguments=function(){var e=this,t=this.props.id,n=this.state.assertionIri;d.trigger({source:t,eventType:d.BuiltInEvents.ComponentLoading}),this.cancellation.map(b.loadArgumentsForAssertion(n)).observe({value:function(n){e.setState({premises:n,initialPremises:i.__spreadArrays(n)}),d.trigger({source:t,eventType:d.BuiltInEvents.ComponentLoaded})},error:function(e){console.error(e)},end:function(){return e.setState({status:void 0})}})},PremiseComponent.prototype.listenToEvents=function(){var e=this,t=this.props.id;d.listen({eventType:P.SaveArguments,target:t}).onValue((function(){return e.saveArguments()})),d.listen({eventType:P.AddArgument,target:t}).onValue((function(){return e.setState({addingPremise:!0,newArgumentType:C.ObservationType})}))},PremiseComponent.prototype.saveArguments=function(){var e=this,t=this.props.id,n=this.state,l=n.assertionIri,o=n.premises,a=n.initialPremises;n.status!==r.Saving&&l&&(this.setState({status:r.Saving}),d.trigger({source:t,eventType:P.ArgumentsSaving}),this.cancellation.map(S.loadAssertion(l)).flatMap((function(e){var t=e.beliefs.map((function(e){return e.iri.getOrElse(void 0)}));return saveArguments(o,a,t)})).observe({value:function(n){d.trigger({source:t,eventType:P.ArgumentsSaved,data:{assertionIri:l.value}}),v.addNotification({level:"success",message:"Arguments have been saved successfully!"}),e.setState({premises:n,initialPremises:i.__spreadArrays(n)})},error:function(e){console.error(e),v.addNotification({level:"error",message:"Something went wrong during saving the arguments!"})},end:function(){return e.setState({status:void 0})}}))},PremiseComponent.prototype.render=function(){var e=this.state,t=e.premises;return e.status===r.Loading?l.createElement(E.Spinner,null):l.createElement("div",null,this.newPremiseSelection(),t.map(this.renderPremise))},PremiseComponent.defaultProps={acceptEvidenceQuery:"ASK {}",logicTypeQuery:"SELECT ?logic ?label {\n      ?logic a "+h.crminf.I3_Inference_Logic+" .\n      ?logic "+y.rdfs.label+" ?label .\n    }"},PremiseComponent}(m.Component);function saveArguments(e,t,n){return function(){if(t.length){var e=t.map(b.removeArgument);return c.zip(e).map((function(){})).toProperty()}return c.constant(void 0)}().flatMap((function(){if(e.length){var t=e.map((function(e){return e.conclusions=i.__spreadArrays(n),b.saveArgument(e).map((function(t){return i.__assign(i.__assign({},e),{iri:u.Just(t)})}))}));return c.zip(t)}return c.constant([])})).toProperty()}t.PremiseComponent=F,t.default=F,t.saveArguments=saveArguments},1989:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(1),l=n(72),o=n(56),a=n(633),s=n(630),c=n(1588),u=n(1224),m=function(e){function ExistingBeliefView(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(ExistingBeliefView,e),ExistingBeliefView.prototype.renderCustomBeliefTemplate=function(e,t){var n=this.props.onCancel;return i.createElement("div",{className:u.evidenceCustom},n?i.createElement("div",{className:u.evidenceCustomDeleteButton},i.createElement("i",{className:"fa fa-times",onClick:n})):null,i.createElement(s.TemplateItem,{template:{source:t,options:{belief:e}}}))},ExistingBeliefView.prototype.render=function(){var e=this.props,t=e.belief,n=e.onCancel,r=e.assertionBasedBeliefTemplate,o=e.fieldBasedBeliefTemplate,a=n?i.createElement("i",{className:"fa fa-times pull-right",onClick:n}):null;return t.argumentBeliefType===c.ArgumentsBeliefTypeAssertionKind?r?this.renderCustomBeliefTemplate(t,r):i.createElement(l.Panel,{header:i.createElement("div",null,i.createElement("span",null,"Assertion based belief"),a),className:"form-horizontal "+u.evidence},ExistingBeliefContentView(t)):t.argumentBeliefType===c.ArgumentsBeliefTypeFieldKind?o?this.renderCustomBeliefTemplate(t,o):i.createElement(l.Panel,{header:i.createElement("div",null,i.createElement("span",null,"Field based belief"),a),className:"form-horizontal "+u.evidence},ExistingBeliefContentView(t)):void 0},ExistingBeliefView}(o.Component);function ExistingBeliefContentView(e){switch(e.argumentBeliefType){case c.ArgumentsBeliefTypeAssertionKind:return[i.createElement(l.FormGroup,null,i.createElement(l.Col,{componentClass:l.ControlLabel,sm:3},"Assertion"),i.createElement(l.Col,{sm:9},i.createElement(l.FormControl.Static,null,i.createElement(o.SemanticContextProvider,{repository:"assets"},i.createElement(a.ResourceLinkComponent,{uri:e.assertion.value})))))];case c.ArgumentsBeliefTypeFieldKind:return[i.createElement(l.FormGroup,null,i.createElement(l.Col,{componentClass:l.ControlLabel,sm:3},"Record"),i.createElement(l.Col,{sm:9},i.createElement(l.FormControl.Static,null,i.createElement(a.ResourceLinkComponent,{uri:e.target.value,guessRepository:!0})))),i.createElement(l.FormGroup,null,i.createElement(l.Col,{componentClass:l.ControlLabel,sm:3},"Field"),i.createElement(l.Col,{sm:9},i.createElement(l.FormControl.Static,null,i.createElement(o.SemanticContextProvider,{repository:"assets"},i.createElement(a.ResourceLinkComponent,{uri:e.field.iri})))))]}}t.ExistingBeliefView=m,t.ExistingBeliefContentView=ExistingBeliefContentView},2345:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(11),l=n(1),o=n(33),a=n(16),s=n(19),c=n(72),u=n(61),m=n(117),p=n(122),f=n(633),d=n(1632),g=n(1658),v=n(2344),E=n(1588),y=n(1224),h=function(e){function BeliefSelection(t,n){var h=e.call(this,t,n)||this;return h.recordDropArea=function(){return l.createElement(d.DropArea,{alwaysVisible:!0,query:h.props.acceptRecordQuery,repository:"assets",onDrop:h.onRecordDrop,dropMessage:h.props.messages.dropRecordPlaceholder,className:y.evidenceDropArea})},h.viewBelief=function(e){return e.argumentsBeliefType===E.ArgumentsBeliefTypeAssertionKind?null:l.createElement("p",null,"Selecting field...")},h.fieldSelection=function(e){var t=h.props,n=t.messages,r=t.multiSelection;return l.createElement(c.Form,{horizontal:!0},l.createElement(c.FormGroup,null,l.createElement(c.Col,{componentClass:c.ControlLabel,sm:2},"Fields:"),l.createElement(c.Col,{sm:10},l.createElement(v.FieldSelection,{multiSelection:r,record:e.record,types:e.types,placeholder:n.fieldSelectionPlaceholder,onCancel:h.onCancelBelief,onSave:h.onFieldSelection}))),l.createElement(c.FormGroup,null,l.createElement(c.Col,{smOffset:2,sm:10},l.createElement(c.ButtonGroup,{className:"pull-right"},l.createElement(c.Button,{onClick:h.onCancelBelief,bsStyle:"danger"},"Cancel"),l.createElement(c.Button,{bsStyle:"success",style:{marginLeft:"12px"},onClick:function(){return h.onSelectBelief(h.state.belief.get())}},"Save")))))},h.onRecordDrop=function(e){return h.getTypes(e).onValue((function(t){var n=a.some(t,(function(e){return g.rso.EX_Assertion.equals(e)})),r={beliefType:E.BeliefTypeArgumentsKind,argumentsBeliefType:n?E.ArgumentsBeliefTypeAssertionKind:E.ArgumentsBeliefTypeFieldKind,assertion:e,record:e,types:t,selectedFields:[]};h.setState({belief:o.Just(r)}),n?h.onSelectBelief(r):m.getOverlaySystem().show("field-selection-overlay",l.createElement(m.OverlayDialog,{onHide:h.onCancelBelief,title:"Field Selection",type:"modal",show:!0},l.createElement("p",null,"Select Field for ",l.createElement(f.ResourceLinkComponent,{uri:e.value,guessRepository:!0}),":"),h.fieldSelection(r)))}))},h.onFieldSelection=function(e){var t=Array.isArray(e)?e:[e];h.setState((function(e){return{belief:e.belief.map((function(e){return i.__assign(i.__assign({},e),{selectedFields:t})}))}}))},h.hideFieldSelectionDialog=function(){return m.getOverlaySystem().hide("field-selection-overlay")},h.onSelectBelief=function(e){h.hideFieldSelectionDialog();var t=[];switch(e.argumentsBeliefType){case E.ArgumentsBeliefTypeFieldKind:var n=a.map(e.selectedFields,(function(t){return{iri:o.Nothing(),beliefType:E.BeliefTypeArgumentsKind,argumentBeliefType:E.ArgumentsBeliefTypeFieldKind,target:e.record,field:t,originRepository:"default",belief:{type:"simple",value:E.SimpleBeliefValue.Agree}}}));t.push.apply(t,n);break;case E.ArgumentsBeliefTypeAssertionKind:var r={iri:o.Nothing(),beliefType:E.BeliefTypeArgumentsKind,argumentBeliefType:E.ArgumentsBeliefTypeAssertionKind,assertion:e.assertion,belief:{type:"simple",value:E.SimpleBeliefValue.Agree}};t.push(r)}h.setState({belief:o.Nothing()}),h.props.onSelect(t)},h.onCancelBelief=function(){h.hideFieldSelectionDialog(),h.setState({belief:o.Nothing()})},h.repositories=p.getRepositoryStatus().map((function(e){return e.keySeq().toArray()})),h.TYPES_QUERY=u.SparqlUtil.Sparql(r||(r=i.__makeTemplateObject(["SELECT DISTINCT ?type WHERE { ?__resource__ a ?type }"],["SELECT DISTINCT ?type WHERE { ?__resource__ a ?type }"]))),h.getTypes=function(e){return h.repositories.flatMap((function(t){return s.combine(t.map((function(t){return h.getTypesFromRepository(t,e)})))})).map(a.flatten).map((function(e){return a.uniqWith(e,(function(e,t){return e.equals(t)}))}))},h.getTypesFromRepository=function(e,t){return u.SparqlClient.select(u.SparqlClient.setBindings(h.TYPES_QUERY,{__resource__:t}),{context:{repository:e}}).map((function(e){return e.results.bindings.map((function(e){return e.type}))}))},h.state={belief:o.Nothing()},h}return i.__extends(BeliefSelection,e),BeliefSelection.prototype.render=function(){return this.state.belief.map(this.viewBelief).getOrElse(this.recordDropArea())},BeliefSelection}(l.Component);t.BeliefSelection=h},3336:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(33),l=n(217),o=n(19),a=n(16),s=n(10),c=n(23),u=c.vocabularies.rdf,m=c.vocabularies.rdfs,p=n(61),f=n(118),d=n(1658),g=n(1588),v=n(1848),E=n(2343),y=f.ldpc(d.rso.ArgumentsContainer.value);t.loadArgumentsForAssertion=function loadArgumentsForAssertion(e){return function findArgumentsForAssertion(e){var t=p.SparqlClient.setBindings(h,{__assertion__:e});return p.SparqlClient.select(t,{context:{repository:"assets"}}).map((function(e){return e.results.bindings.map((function(e){return e.argument}))}))}(e).flatMap((function(e){return a.isEmpty(e)?o.constant([]):o.combine(a.map(e,(function(e){return y.get(e).map((function(t){return c.Rdf.pg(e,t)}))})))})).flatMap((function(e){return a.isEmpty(e)?o.constant([]):o.combine(a.map(e,deserializeArgument))})).toProperty()};var h=p.SparqlUtil.Sparql(S||(S=r.__makeTemplateObject(["\n  SELECT DISTINCT ?argument WHERE {\n    ?__assertion__ <http://www.researchspace.org/ontology/PX_asserts> ?belief .\n    ?argument <http://www.ics.forth.gr/isl/CRMinf/J2_concluded_that> ?belief .\n  }\n"],["\n  SELECT DISTINCT ?argument WHERE {\n    ?__assertion__ <http://www.researchspace.org/ontology/PX_asserts> ?belief .\n    ?argument <http://www.ics.forth.gr/isl/CRMinf/J2_concluded_that> ?belief .\n  }\n"])));function deserializeArgument(e){var t=c.Rdf.getValuesFromPropertyPath([u.type],e);return a.some(t,(function(e){return e.equals(d.crmsci.S19_Encounter_Event)}))?o.constant(function deserializeObservation(e){return{iri:i.Just(e.pointer),argumentType:g.ObservationType,title:c.Rdf.getValueFromPropertyPath([m.label],e).map((function(e){return e.value})).getOrElse(""),note:c.Rdf.getValueFromPropertyPath([d.crm.P3_has_note],e).map((function(e){return e.value})).getOrElse(""),place:c.Rdf.getValueFromPropertyPath([d.crmsci.O21_has_found_at],e).getOrElse(void 0),date:c.Rdf.getValueFromPropertyPath([d.crm.P4_has_time_span,d.crm.P82a_begin_of_the_begin],e).getOrElse(void 0)}}(e)):a.some(t,(function(e){return e.equals(d.crminf.I7_Belief_Adoption)}))?function deserializeBeliefAdoption(e){var t=c.Rdf.getValueFromPropertyPath([d.rso.PX_adopted_assertion],e);if(t.isJust)return o.constant({iri:i.Just(e.pointer),argumentType:g.BeliefAdoptionType,title:c.Rdf.getValueFromPropertyPath([m.label],e).map((function(e){return e.value})).getOrElse(""),note:c.Rdf.getValueFromPropertyPath([d.crm.P3_has_note],e).map((function(e){return e.value})).getOrElse(""),belief:{iri:t,beliefType:g.BeliefTypeArgumentsKind,argumentBeliefType:g.ArgumentsBeliefTypeAssertionKind,assertion:t.get(),belief:{type:"simple",value:"Agree"}}});var n=a.head(c.Rdf.getValuesFromPropertyPath([d.crminf.J6_adopted],e));return deserializeBelief(c.Rdf.pg(n,e.graph)).map((function(t){return{iri:i.Just(e.pointer),argumentType:g.BeliefAdoptionType,title:c.Rdf.getValueFromPropertyPath([m.label],e).map((function(e){return e.value})).getOrElse(""),note:c.Rdf.getValueFromPropertyPath([d.crm.P3_has_note],e).map((function(e){return e.value})).getOrElse(""),belief:t}}))}(e):function deserializeInference(e){var t=c.Rdf.getValuesFromPropertyPath([d.crminf.J1_used_as_premise],e);return o.combine(t.map((function(t){return deserializeBelief(c.Rdf.pg(t,e.graph))}))).map((function(t){return{iri:i.Just(e.pointer),argumentType:g.InferenceType,title:c.Rdf.getValueFromPropertyPath([m.label],e).map((function(e){return e.value})).getOrElse(""),note:c.Rdf.getValueFromPropertyPath([d.crm.P3_has_note],e).map((function(e){return e.value})).getOrElse(""),logicType:c.Rdf.getValueFromPropertyPath([d.crminf.J3_applies],e).getOrElse(void 0),premises:t}})).toProperty()}(e)}function deserializeBelief(e){var t=c.Rdf.getValueFromPropertyPath([d.rso.PX_premise_assertion],e);if(t.isJust){var n={iri:i.Just(e.pointer),beliefType:g.BeliefTypeArgumentsKind,argumentBeliefType:g.ArgumentsBeliefTypeAssertionKind,assertion:t.get(),belief:{type:"simple",value:g.SimpleBeliefValue.Agree}};return o.constant(n)}var r=c.Rdf.getValueFromPropertyPath([d.rso.PX_premise_target],e).getOrElse(void 0),l=c.Rdf.getValueFromPropertyPath([d.rso.PX_premise_field],e).getOrElse(void 0),a=c.Rdf.getValueFromPropertyPath([d.rso.PX_premise_target_repository],e).map((function(e){return e.value})).getOrElse(void 0);return v.getArgumentsFieldDefinition(l).map((function(t){return{iri:i.Just(e.pointer),beliefType:g.BeliefTypeArgumentsKind,argumentBeliefType:g.ArgumentsBeliefTypeFieldKind,target:r,field:t,originRepository:a,belief:{type:"simple",value:g.SimpleBeliefValue.Agree}}}))}var S,C=f.ldpc(d.rso.ArgumentsContainer.value);function getBeliefsForArgument(e,t){return g.matchArgument({Inference:function(e){return o.combine(e.premises.map(E.getBeliefGraphs)).map((function(e){return a.flatten(e)})).toProperty()},BeliefAdoption:function(e){return E.getBeliefGraphs(e.belief)},Observation:function(e){return o.constant([])}})(t)}function serializeArgument(e,t,n){var i=t.conclusions.map((function(e){return c.Rdf.triple(c.Rdf.BASE_IRI,d.crminf.J2_concluded_that,e)})),l=c.Rdf.graph(r.__spreadArrays([c.Rdf.triple(c.Rdf.BASE_IRI,c.vocabularies.rdf.type,d.crminf.I1_Argumentation),c.Rdf.triple(c.Rdf.BASE_IRI,c.vocabularies.rdfs.label,c.Rdf.literal(t.title)),c.Rdf.triple(c.Rdf.BASE_IRI,d.crm.P3_has_note,c.Rdf.literal(t.note))],i)),o=serializeSpecificArgument(t,n);return c.Rdf.union(l,o)}function serializeSpecificArgument(e,t){return g.matchArgument({Inference:function(e){return serializeInference(e,t)},BeliefAdoption:function(e){return serializeBeliefAdoption(e,t)},Observation:serializeObservation})(e)}function serializeBeliefAdoption(e,t){var n=t.map((function(e){return c.Rdf.triple(c.Rdf.BASE_IRI,d.crminf.J6_adopted,e.pointer)}));return e.belief.argumentBeliefType===g.ArgumentsBeliefTypeAssertionKind&&n.push(c.Rdf.triple(c.Rdf.BASE_IRI,d.rso.PX_adopted_assertion,e.belief.assertion)),c.Rdf.graph(r.__spreadArrays([c.Rdf.triple(c.Rdf.BASE_IRI,c.vocabularies.rdf.type,d.crminf.I7_Belief_Adoption)],a.flatMap(t,(function(e){return e.graph.triples.toArray()})),n))}function serializeObservation(e){var t=createObservationTimeSpan(e);return c.Rdf.graph(r.__spreadArrays([c.Rdf.triple(c.Rdf.BASE_IRI,c.vocabularies.rdf.type,d.crmsci.S19_Encounter_Event),c.Rdf.triple(c.Rdf.BASE_IRI,c.vocabularies.rdf.type,d.crmsci.S4_Observation),c.Rdf.triple(c.Rdf.BASE_IRI,d.crmsci.O21_has_found_at,e.place),c.Rdf.triple(c.Rdf.BASE_IRI,d.crm.P4_has_time_span,t.pointer)],t.graph.triples.toJS()))}function createObservationTimeSpan(e){var t=c.Rdf.iri("/time/"+l.v4()),n=e.date,r=c.Rdf.literal(s(e.date.value).format("LL"));return c.Rdf.pg(t,c.Rdf.graph([c.Rdf.triple(t,d.crm.P82a_begin_of_the_begin,n),c.Rdf.triple(t,d.crm.P82a_end_of_the_end,n),c.Rdf.triple(t,c.vocabularies.rdfs.label,r),c.Rdf.triple(t,d.rso.displayLabel,r)]))}function serializeInference(e,t){var n=t.map((function(e){return c.Rdf.triple(c.Rdf.BASE_IRI,d.crminf.J1_used_as_premise,e.pointer)}));return c.Rdf.graph(r.__spreadArrays([c.Rdf.triple(c.Rdf.BASE_IRI,c.vocabularies.rdf.type,d.crminf.I5_Inference_Making),c.Rdf.triple(c.Rdf.BASE_IRI,d.crminf.J3_applies,e.logicType)],n,a.flatMap(t,(function(e){return e.graph.triples.toArray()}))))}t.saveArgument=function saveArgument(e){var t=e.iri.getOrElse(c.Rdf.iri("http://researchspace.org/instances/argument/"+l.v4()));return getBeliefsForArgument(t,e).map((function(n){return serializeArgument(t,e,n)})).flatMap((function(e){return C.addResource(e,i.Just(t.value))}))},t.removeArgument=function removeArgument(e){return C.deleteResource(e.iri.get())},t.getBeliefsForArgument=getBeliefsForArgument,t.serializeArgument=serializeArgument,t.serializeSpecificArgument=serializeSpecificArgument,t.serializeBeliefAdoption=serializeBeliefAdoption,t.serializeObservation=serializeObservation,t.createObservationTimeSpan=createObservationTimeSpan,t.serializeInference=serializeInference},3337:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(1),l=n(72),o=n(16),a=n(33),s=n(10),c=n(2230),u=i.createFactory(c),m=n(23),p=n(1581),f=n(1588),d={placeholder:"Search for Location...",parentsQuery:"\n    SELECT DISTINCT ?item ?parent ?parentLabel WHERE {\n      ?parent skos:inScheme <http://collection.britishmuseum.org/id/place> .\n      ?item skos:broader ?parent .\n      ?parent skos:prefLabel ?parentLabel .\n    }\n  ",childrenQuery:"\n    SELECT DISTINCT ?item ?label ?hasChildren WHERE {\n      ?item skos:broader ?parent .\n      ?item skos:inScheme <http://collection.britishmuseum.org/id/place> .\n      ?item skos:prefLabel ?label .\n      OPTIONAL { ?child skos:broader ?item . }\n      BIND(bound(?child) as ?hasChildren)\n    } ORDER BY ?label\n  ",rootsQuery:"\n    SELECT DISTINCT ?item ?label WHERE {\n      ?item skos:inScheme <http://collection.britishmuseum.org/id/place> .\n      FILTER NOT EXISTS { ?item skos:broader ?parent . }\n      ?item skos:prefLabel ?label .\n    }\n  ",searchQuery:'\n    SELECT DISTINCT ?item ?label ?score ?hasChildren WHERE {\n      ?item skos:inScheme <http://collection.britishmuseum.org/id/place> .\n      ?item skos:prefLabel ?label.\n      ?label bds:search ?__token__ ;\n             bds:minRelevance "0.3" ;\n             bds:relevance ?score ;\n             bds:matchAllTerms "true"  .\n      OPTIONAL { ?child skos:broader ?item. }\n      BIND(BOUND(?child) AS ?hasChildren)\n    }\n    ORDER BY DESC(?score) ?label\n    LIMIT 200\n'},g=function(e){function ObservationComponent(t,n){var r=e.call(this,t,n)||this;return r.onTitleChange=function(e){return r.setState({title:e.target.value})},r.onNoteChange=function(e){return r.setState({note:e.target.value})},r.onDateSelected=function(e){return r.setState({date:m.Rdf.literal(e.format(),m.vocabularies.xsd.dateTime)})},r.onPlaceSelected=function(e){return r.setState({place:p.TreeSelection.leafs(e).map((function(e){return e.iri})).first()})},r.canSave=function(){var e=r.state,t=e.title,n=(e.note,e.place),i=e.date;return!o.isEmpty(t)&&n&&i},r.saveArgument=function(){var e=r.state,t=e.title,n=e.note,i=e.place,l=e.date,o=e.iri;r.props.onSave({iri:o,argumentType:f.ObservationType,title:t,note:n,place:i,date:l})},t.initialState?r.state=t.initialState:r.state={iri:a.Nothing(),title:"",note:"",place:null,date:null},r}return r.__extends(ObservationComponent,e),ObservationComponent.prototype.render=function(){var e=this.props.initialState;return i.createElement(l.Form,null,i.createElement(l.FormGroup,null,i.createElement(l.ControlLabel,null,"Title*"),i.createElement(l.FormControl,{type:"text",placeholder:"Observation title...",value:this.state.title,onChange:this.onTitleChange})),i.createElement(l.FormGroup,null,i.createElement(l.ControlLabel,null,"Description"),i.createElement(l.FormControl,{componentClass:"textarea",placeholder:"Observation description...",value:this.state.note,onChange:this.onNoteChange})),i.createElement(l.FormGroup,null,i.createElement(l.ControlLabel,null,"Date*"),i.createElement(u,{onChange:this.onDateSelected,closeOnSelect:!0,value:this.state.date?s(this.state.date.value):void 0,viewMode:"time",dateFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss",inputProps:{placeholder:"Select observation date..."}})),i.createElement(l.FormGroup,null,i.createElement(l.ControlLabel,null,"Place*"),i.createElement(p.SemanticTreeInput,r.__assign({},d,{initialSelection:this.state.place?[this.state.place]:[],onSelectionChanged:this.onPlaceSelected}))),i.createElement(l.FormGroup,null,i.createElement(l.ButtonGroup,{className:"pull-right"},i.createElement(l.Button,{bsStyle:"default",onClick:this.props.onCancel},"Cancel"),i.createElement(l.Button,{bsStyle:"primary",style:{marginLeft:"12px"},onClick:this.saveArgument,disabled:!this.canSave()},e?"Update Premise":"Add Premise")),i.createElement("div",{className:"clearfix"})))},ObservationComponent}(i.Component);t.ObservationComponent=g},3338:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(1),l=n(16),o=n(33),a=n(72),s=n(1588),c=n(2345),u=n(1989),m=function(e){function BeliefAdoptionComponent(t,n){var r=e.call(this,t,n)||this;return r.newBelief=function(){return i.createElement(c.BeliefSelection,{multiSelection:!1,messages:{beliefHeader:"Belief adoption",dropRecordPlaceholder:"You can drag and drop items from Clipboard here, to adopt the belief for the record...",fieldSelectionHeader:"Field based belief adoption",fieldSelectionPlaceholder:"Select fields to adopt..."},acceptRecordQuery:r.props.acceptRecordQuery,onSelect:r.onFieldsSelection})},r.onFieldsSelection=function(e){r.setState({belief:l.head(e)})},r.onSelectBelief=function(e){r.props.onSave({iri:r.state.iri,argumentType:s.BeliefAdoptionType,title:r.state.title,note:r.state.note,belief:e})},r.onTitleChange=function(e){return r.setState({title:e.target.value})},r.onNoteChange=function(e){return r.setState({note:e.target.value})},t.initialState?r.state=t.initialState:r.state={iri:o.Nothing(),title:"",note:"",belief:void 0},r}return r.__extends(BeliefAdoptionComponent,e),BeliefAdoptionComponent.prototype.render=function(){var e=this,t=this.props,n=t.initialState,r=t.onCancel,l=t.assertionBasedBeliefTemplate,o=this.state,s=o.title,c=o.note,m=o.belief,p=s&&m;return i.createElement(a.Form,null,i.createElement(a.FormGroup,null,i.createElement(a.ControlLabel,null,"Title*"),i.createElement(a.FormControl,{type:"text",placeholder:"Premise title...",value:s,onChange:this.onTitleChange})),i.createElement(a.FormGroup,null,i.createElement(a.ControlLabel,null,"Description"),i.createElement(a.FormControl,{componentClass:"textarea",placeholder:"Premise description...",value:c,onChange:this.onNoteChange})),i.createElement(a.FormGroup,null,i.createElement(a.Row,null,i.createElement(a.Col,{md:4},m?i.createElement(u.ExistingBeliefView,{belief:m,onCancel:function(){return e.setState({belief:void 0})},assertionBasedBeliefTemplate:l}):this.newBelief()))),i.createElement(a.FormGroup,null,i.createElement(a.ButtonGroup,{className:"pull-right"},i.createElement(a.Button,{bsStyle:"default",onClick:r},"Cancel"),i.createElement(a.Button,{bsStyle:"primary",style:{marginLeft:"12px"},onClick:function(){return e.onSelectBelief(m)},disabled:!p},n?"Update Premise":"Add Premise")),i.createElement("div",{className:"clearfix"})))},BeliefAdoptionComponent}(i.Component);t.BeliefAdoptionComponent=m},3339:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),i=n(1),l=n(16),o=n(33),a=n(72),s=n(1559),c=n(61),u=n(1588),m=n(2345),p=n(1989),f=n(1224),d=s.default,g=function(e){function InferenceMakingComponent(t,n){var a=e.call(this,t,n)||this;return a.logicTypeSelector=function(){var e=a.state.logics,t=a.state.logicType?l.find(e,(function(e){return e.value.equals(a.state.logicType)})):null;return i.createElement(d,{placeholder:"Select logic type...",options:e,value:t,onChange:a.onLogicChange,clearable:!1})},a.newPremise=function(){return i.createElement(m.BeliefSelection,{multiSelection:!0,messages:{beliefHeader:"Assertion based evidence",dropRecordPlaceholder:"You can drag and drop items from Clipboard here, to add a resource for use as evidence",fieldSelectionHeader:"Field based evidence",fieldSelectionPlaceholder:"Select fields for evidence..."},acceptRecordQuery:a.props.acceptEvidenceQuery,onSelect:a.savePremise})},a.onTitleChange=function(e){a.setState({title:e.target.value})},a.onNoteChange=function(e){a.setState({note:e.target.value})},a.onLogicChange=function(e){a.setState({logicType:e.value})},a.savePremise=function(e){a.setState((function(t){return{premises:t.premises.concat(e)}}))},a.removePremise=function(e,t){a.setState((function(e){var n=r.__spreadArrays(e.premises);return n.splice(t,1),{premises:n}}))},a.saveArgument=function(){a.props.onSave({iri:a.state.iri,argumentType:u.InferenceType,logicType:a.state.logicType,title:a.state.title,note:a.state.note,premises:a.state.premises})},a.canSave=function(){var e=a.state,t=e.logicType,n=e.title,r=e.premises;return t&&!l.isEmpty(n)&&!l.isEmpty(r)},t.initialState?a.state=t.initialState:a.state={iri:o.Nothing(),title:"",note:"",logicType:void 0,premises:[],logics:[]},a}return r.__extends(InferenceMakingComponent,e),InferenceMakingComponent.prototype.componentDidMount=function(){var e=this;c.SparqlClient.select(this.props.logicTypeQuery).onValue((function(t){var n=t.results.bindings.map((function(e){return{value:e.logic,label:e.label.value}}));e.setState({logics:n})}))},InferenceMakingComponent.prototype.render=function(){var e=this,t=this.props,n=t.initialState,r=t.assertionBasedBeliefTemplate,l=t.fieldBasedBeliefTemplate,o=this.state.premises;return i.createElement(a.Form,null,i.createElement(a.FormGroup,null,i.createElement(a.ControlLabel,null,"Title*"),i.createElement(a.FormControl,{type:"text",placeholder:"Premise title...",value:this.state.title,onChange:this.onTitleChange})),i.createElement(a.FormGroup,null,i.createElement(a.ControlLabel,null,"Description"),i.createElement(a.FormControl,{componentClass:"textarea",placeholder:"Premise description...",value:this.state.note,onChange:this.onNoteChange})),i.createElement(a.FormGroup,null,i.createElement(a.ControlLabel,null,"Logic Type*"),this.logicTypeSelector()),i.createElement(a.FormGroup,null,i.createElement(a.ControlLabel,null,"Evidences"),i.createElement(a.Row,{className:f.evidenceList},o.map((function(t,n){return i.createElement(a.Col,{sm:4,className:f.evidenceItem},i.createElement(p.ExistingBeliefView,{belief:t,onCancel:function(){return e.removePremise(t,n)},assertionBasedBeliefTemplate:r,fieldBasedBeliefTemplate:l}))})),i.createElement(a.Col,{sm:4,className:f.evidenceSelector},this.newPremise()))),i.createElement(a.FormGroup,null,i.createElement(a.ButtonGroup,{className:"pull-right"},i.createElement(a.Button,{bsStyle:"default",onClick:this.props.onCancel},"Cancel"),i.createElement(a.Button,{bsStyle:"primary",style:{marginLeft:"12px"},onClick:this.saveArgument,disabled:!this.canSave()},n?"Update Premise":"Add Premise")),i.createElement("div",{className:"clearfix"})))},InferenceMakingComponent}(i.Component);t.InferenceMakingComponent=g},3340:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(162).EventMaker;t.SaveArguments=r("Premise.SaveArguments"),t.ArgumentsSaving=r("Premise.ArgumentsSaving"),t.ArgumentsSaved=r("Premise.ArgumentsSaved"),t.AddArgument=r("Premise.AddArgument")}}]);
//# sourceMappingURL=rs-premise-63ba7543b651d9469c1e.js.map