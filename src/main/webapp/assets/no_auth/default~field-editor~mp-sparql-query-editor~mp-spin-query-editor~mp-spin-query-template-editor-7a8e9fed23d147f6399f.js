(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{1953:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),r(11).__exportStar(r(2235),t)},2235:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),i=r(1),n=r(35),s=r(20),p=r(1740),a=r(16),l=r(72),u=r(221),c=r(23),d=r(222),h=r(630),f=r(1886);r(1369);var m=r(1370),y=function(e){function SparqlEditor(t){var r=e.call(this,t)||this;return r.__componentWillRecieveProps=a.debounce((function(e){normalizeLineEndings(e.query)!==normalizeLineEndings(this.getQuery().value)&&(this.setBackdrop(e.backdrop),this.setValue(e.query))})),r.onMouseClick=function(e){r.__onMouseClick(e)},r.__onMouseClick=a.debounce((function(e){var t={left:e.clientX+document.documentElement.scrollLeft,top:e.clientY+document.documentElement.scrollTop},o=function getResourceIriFromToken(e){var t=e.state.prefixes;if("string-2"===e.type){var r=e.string.split(":"),o=r[0],i=r[1];if(i){var n=t[o];if(n)return c.Rdf.iri(""+n+i);try{return d.resolveIris([e.string])[0]}catch(e){return}}}else if("variable-3"===e.type){var s=c.Rdf.fullIri(e.string);if(!s.value.length)return;return(o=a.findKey(t,(function(e){return e===s.value})))?void 0:s}return}(r.yasqe.getTokenAt(r.yasqe.coordsChar(t)));r.setState({resourceIri:o,targetTop:t.top,targetLeft:t.left})}),300),r.setValue=function(e){"string"==typeof e&&r.yasqe.setValue(e)},r.onChange=function(e,t){r.props.onChange&&"setValue"!==t.origin&&r.props.onChange(r.getQuery())},r.setBackdrop=function(e){r.yasqe.setBackdrop(!a.isUndefined(e)&&e)},r.state={targetTop:0,targetLeft:0,enablePopover:!1},r.id=Math.random().toString(36).slice(2),r}return o.__extends(SparqlEditor,e),SparqlEditor.prototype.componentDidMount=function(){if(this.props.autocompleters){if(p.defaults.autocompleters=this.props.autocompleters,this.props.autocompleters.indexOf("prefixes")>-1){p.Autocompleters.prefixes.fetchFrom=u.GET_REGISTERED_PREFIXES;var e=p.Autocompleters.prefixes;p.Autocompleters.prefixes=function(t,r){var o=e(t,r);return o.persistent=null,o}}}else p.defaults.autocompleters=["variables"];this.yasqe=p(s.findDOMNode(this),{backdrop:0,value:this.props.query,persistent:this.props.persistent?this.props.persistent:null}),!1===this.props.syntaxErrorCheck&&(this.yasqe.setOption("syntaxErrorCheck",!1),this.yasqe.clearGutter("gutterErrorBar")),this.props.onChange&&this.yasqe.on("change",this.onChange),this.props.size&&this.yasqe.setSize(this.props.size.w,this.props.size.h),this.setBackdrop(this.props.backdrop);var t=this.yasqe.getWrapperElement();t&&t.addEventListener("click",this.onMouseClick)},SparqlEditor.prototype.componentWillReceiveProps=function(e){this.__componentWillRecieveProps(e)},SparqlEditor.prototype.componentWillUnmount=function(){var e=this.yasqe.getWrapperElement();e&&e.removeEventListener("click",this.onMouseClick)},SparqlEditor.prototype.renderPopover=function(){var e=this.props.popoverTemplate,t=this.state,r=t.resourceIri,o=t.targetTop,n=t.targetLeft,s=t.enablePopover;if(!r||!s)return null;var p=i.createElement(h.TemplateItem,{template:{source:e,options:{iri:r.value}}});return i.createElement(l.Overlay,{show:!0},i.createElement(f.TargetedPopover,{id:"sparql-editor-popover",targetTop:o,targetLeft:n,popoverSide:"bottom",arrowAlignment:"center"},p))},SparqlEditor.prototype.render=function(){return n.div({id:this.id,className:m.sparqlEditor},this.renderPopover())},SparqlEditor.prototype.getQuery=function(){return{value:this.yasqe.getValue(),queryType:this.yasqe.getQueryType(),queryMode:this.yasqe.getQueryMode()}},SparqlEditor.defaultProps={popoverTemplate:'\n<div style="white-space: normal">\n<strong><mp-label iri="{{iri}}"></mp-label></strong><br/>\n<semantic-query query="SELECT ?description WHERE { <{{iri}}> rdfs:comment|<http://schema.org/description> ?description } LIMIT 1"></semantic-query>\n</div>\n'},SparqlEditor}(i.Component);function normalizeLineEndings(e){return e?e.replace(/\r\n|\r/g,"\n"):e}t.SparqlEditor=y}}]);
//# sourceMappingURL=default~field-editor~mp-sparql-query-editor~mp-spin-query-editor~mp-spin-query-template-editor-7a8e9fed23d147f6399f.js.map