(window.webpackJsonp=window.webpackJsonp||[]).push([[472],{1372:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),a=r(1),o=r(43),i=r(217),p=r(23),s=r(162),l=r(34),u=r(1632),d=r(328),m=r(630),c=r(1553),v=r(1631),f=r(1948),g=r(1946),h=r(2975),I=r(1374),D=function(e){function DragAndDropInput(t,r){var n=e.call(this,t,r)||this;return n.cancelation=new l.Cancellation,n.dropMessage=function(){return a.createElement(m.TemplateItem,{template:{source:n.props.dropAreaTemplate}})},n.renderPlaceholderCard=function(e){var t=e?{onClick:n.onCreateNew}:{};return a.createElement(m.TemplateItem,{template:{source:n.props.placeholderItemTemplate,options:{canCreateNew:e}},componentProps:t})},n.onCreateNew=function(){n.setState((function(e){return{nestedFormOpen:!e.nestedFormOpen}}))},n.onNestedFormSubmit=function(e){n.setState({nestedFormOpen:!1}),n.addAndValidate(e)},n.onDrop=function(e){if(!(n.props.values.findIndex((function(t){return c.FieldValue.isAtomic(t)&&t.value.isIri()&&t.value.equals(e)}))>=0)){var t=c.FieldValue.fromLabeled({value:e});n.addAndValidate(t)}},n.addAndValidate=function(e){var t=n.isEmpty()?o.List([e]):n.props.values.push(e),r=n.props,a=r.updateValues,i=r.handler;a((function(e){var r=e.errors;return i.validate({values:t,errors:r})}))},n.onRemoveItem=function(e){var t=p.Rdf.iri(e),r=n.props.values.findIndex((function(e){return c.FieldValue.isAtomic(e)&&e.value.isIri()&&e.value.equals(t)})),a=n.props.values.remove(r),o=n.props,i=o.updateValues,s=o.handler;i((function(e){var t=e.errors;return s.validate({values:a,errors:t})}))},n.onItemDragStart=function(){return n.setState({draggingItem:!0})},n.onItemDragEnd=function(){return n.setState({draggingItem:!1})},n.state={draggingItem:!1,nestedFormOpen:!1,id:n.props.id||i.v4()},n}return n.__extends(DragAndDropInput,e),DragAndDropInput.prototype.componentDidMount=function(){var e=this;this.cancelation.map(s.listen({eventType:h.RemoveItemEvent,target:this.state.id})).onValue((function(t){return e.onRemoveItem(t.data.iri)}))},DragAndDropInput.prototype.render=function(){var e=this,t=g.tryExtractNestedForm(this.props.children),r=Boolean(t);return a.createElement("div",{className:I.holder},this.props.readonly?this.renderItems(!1):a.createElement(a.Fragment,null,a.createElement(u.DropArea,{shouldReactToDrag:function(){return!e.state.draggingItem&&e.props.definition.maxOccurs!=e.props.values.filter((function(e){return!c.FieldValue.isEmpty(e)})).size},query:f.createDropAskQueryForField(this.props.definition),onDrop:this.onDrop,dropMessage:this.dropMessage()},this.renderItems(r)),this.state.nestedFormOpen?a.createElement(g.NestedModalForm,{definition:this.props.definition,onSubmit:this.onNestedFormSubmit,onCancel:function(){return e.setState({nestedFormOpen:!1})}},t):null))},DragAndDropInput.prototype.isEmpty=function(){return this.props.values.isEmpty()||this.props.values.every(c.FieldValue.isEmpty)},DragAndDropInput.prototype.renderItems=function(e){var t=this,r=!1===this.props.renderHeader?I.itemArea+" "+I["itemArea--no-header"]:I.itemArea,n=!this.props.readonly&&this.props.values.filter((function(e){return!c.FieldValue.isEmpty(e)})).size<this.props.definition.maxOccurs;return a.createElement("div",{className:r},this.props.values.map((function(e){if(c.FieldValue.isAtomic(e)&&e.value.isIri)return a.createElement(d.Draggable,{iri:e.value.value,key:e.value.value,onDragStart:t.onItemDragStart,onDragEnd:t.onItemDragEnd},a.createElement("div",null,a.createElement(m.TemplateItem,{template:{source:t.props.itemTemplate,options:{iri:e.value.value,inputId:t.state.id}}})));if(c.FieldValue.isEmpty(e))return null;throw new Error("Only atomic IRI values are supported by DragAndDropInput")})),n?this.renderPlaceholderCard(e):null)},DragAndDropInput.defaultProps={dropAreaTemplate:"<span>Drop item here to add it</span>",placeholderItemTemplate:"\n      <div class='DragAndDropInput--placeholderContainer'>\n        Drop item here\n        {{#if canCreateNew}}\n          or click to create a new item\n        {{/if}}\n      </div>\n    ",itemTemplate:'\n        {{#> rsp:itemCardTemplate width=105 height=125 cardMargin=4 footer-paddingY=7 footer-paddingX=8}}\n          {{#*inline "additionalActions"}}\n            <div class="rs-default-card__hover-icon">\n              <mp-event-trigger type=\'Form.DragAndDropInput.RemoveItem\' targets=\'["{{inputId}}"]\' data=\'{"iri": "{{iri}}"}\'>\n                <button type="button" class="rs-button" title="Remove Value">\n                  <i class="rs-icon rs-icon-delete_round"></i>\n                </button>\n              </mp-event-trigger>\n            </div>\n          {{/inline}}\n        {{/rsp:itemCardTemplate}}\n    '},DragAndDropInput}(v.MultipleValuesInput);t.DragAndDropInput=D,t.default=D},2975:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(162).EventMaker;t.RemoveItemEvent=n("Form.DragAndDropInput.RemoveItem")}}]);
//# sourceMappingURL=semantic-form-drag-and-drop-input-b51ec820a1693f9c0699.js.map