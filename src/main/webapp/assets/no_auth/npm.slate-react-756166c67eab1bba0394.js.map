{"version":3,"sources":["webpack:///./node_modules/slate-react/lib/slate-react.es.js","webpack:///./node_modules/slate-react/node_modules/debug/src/browser.js","webpack:///./node_modules/slate-react/node_modules/debug/src/common.js"],"names":["EVENT_HANDLERS","TRANSFER_TYPES","FRAGMENT","HTML","NODE","RICH","TEXT","findDOMNode","key","win","arguments","length","undefined","window","isNode","el","document","querySelector","Error","removeAllRanges","selection","doc","body","createTextRange","range","collapse","select","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","target","props","i","descriptor","enumerable","configurable","writable","Object","defineProperty","protoProps","staticProps","prototype","_extends","assign","source","hasOwnProperty","call","inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","slicedToArray","arr","Array","isArray","Symbol","iterator","sliceIterator","_arr","_n","_d","_e","_s","_i","next","done","push","err","toConsumableArray","arr2","from","PARSER","OffsetKey","parse","string","matches","exec","_matches","index","parseInt","stringify","object","findPoint","nativeNode","nativeOffset","editor","isValue","_normalizeNodeAndOffs","normalizeNodeAndOffset","node","offset","nodeType","childNodes","isLast","direction","getEditableChild","textContent","nearestNode","nearestOffset","parentNode","rangeNode","closest","createRange","textNode","setStart","setEnd","toString","voidNode","hasAttribute","offsetKey","getAttribute","hasDescendant","createPoint","parent","child","triedForward","triedBackward","cloneFragment","event","callback","native","getSelection","fragment","start","end","startVoid","getClosestVoid","endVoid","isCollapsed","encoded","serializeNode","getRangeAt","contents","cloneContents","attach","forEach","trim","r","cloneRange","setEndAfter","firstChild","slice","querySelectorAll","zw","isNewline","span","createElement","style","whiteSpace","appendChild","setAttribute","valFromSelection","plainText","serialize","div","clipboardData","setData","preventDefault","innerHTML","editorEl","position","left","selectAllChildren","requestAnimationFrame","removeChild","addRange","findNode","element","getNode","findDOMPoint","point","texts","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","text","domLength","slateLength","Math","min","max","return","findRange","anchorNode","startContainer","Range","StaticRange","anchorOffset","startOffset","focusNode","endContainer","focusOffset","endOffset","_native","anchor","focus","domAnchor","domFocus","getEventRange","nativeEvent","_event","x","y","query","rect","getBoundingClientRect","isPrevious","width","top","height","getFirstText","_range","previousText","getPreviousText","moveToEndOfNode","nextText","getNextText","moveToStartOfNode","caretRangeFromPoint","caretPositionFromPoint","offsetNode","moveToPoint","error","FRAGMENT$1","HTML$1","TEXT$1","FRAGMENT_MATCHER","getEventTransfer","transfer","dataTransfer","getType","html","rich","files","indexOf","embeddedTypes","getEmbeddedTypes","prefix","substring","JSON","deserializeNode","items","map","item","kind","getAsFile","filter","exists","data","type","getTransferType","types","getData","TEXT$2","setEventTransfer","content","mime","toUpperCase","obj","e","setSelectionFromDOM","domSelection","rangeCount","anchorText","focusText","anchorInline","getClosestInline","focusInline","focusBlock","getClosestBlock","anchorBlock","isVoid","setFocus","setOffset","moveAnchorTo","_nextText","moveFocusTo","createSelection","setIsFocused","set","marks","blur","debug","AfterPlugin","isDraggingInternally","isMouseDown","onBeforeInput","insertText","_event$getTargetRange","getTargetRanges","targetRange","inputType","deleteAtRange","deleteWordBackwardAtRange","deleteWordForwardAtRange","deleteLineBackwardAtRange","deleteLineForwardAtRange","hasVoidParent","path","moveToStartOfNextText","splitBlockAtRange","insertTextAtRange","onBlur","onClick","readOnly","ancestors","getAncestors","some","a","onCopy","onCut","endBlock","endInline","isVoidBlock","isVoidInline","removeNodeByKey","delete","onDragEnd","onDragStart","selectionIncludesNode","blocks","block","moveToRangeOfNode","onDrop","moveForward","n","split","line","splitBlock","insertFragment","dispatchEvent","MouseEvent","view","bubbles","cancelable","onFocus","deselect","onInput","setTextFromDomNode","domNode","getDescendant","leaves","getLeaves","lastText","getLastText","lastLeaf","last","leaf","find","isLastText","isLastLeaf","lastChar","charAt","entire","resolveRange","onKeyDown","isSplitBlock","isDeleteBackward","deleteCharBackward","isDeleteForward","deleteCharForward","isDeleteLineBackward","deleteLineBackward","isDeleteLineForward","deleteLineForward","isDeleteWordBackward","deleteWordBackward","isDeleteWordForward","deleteWordForward","isRedo","redo","isUndo","undo","isMoveLineBackward","moveToStartOfBlock","isMoveLineForward","moveToEndOfBlock","isExtendLineBackward","moveFocusToStartOfBlock","isExtendLineForward","moveFocusToEndOfBlock","isMoveBackward","moveBackward","moveToStart","isMoveForward","moveToEnd","isMoveWordBackward","moveWordBackward","isMoveWordForward","moveWordForward","isExtendBackward","startText","isPreviousInVoid","moveFocusBackward","isExtendForward","_startText","isNextInVoid","moveFocusForward","onMouseDown","onMouseUp","onPaste","startBlock","defaultBlock","defaultMarks","getInsertMarksAtRange","frag","deserialize","onSelect","debug$1","BeforePlugin","activeElement","compositionCount","isComposing","isCopying","isDragging","isSynthetic","relatedTarget","contains","onCompositionEnd","onCompositionStart","onDragEnter","onDragExit","onDragLeave","onDragOver","dropEffect","isBlurred","isCompose","isBold","isItalic","isTransposeCharacter","DOMPlugin","options","_options$plugins","plugins","beforePlugin","afterPlugin","concat","debug$2","Leaf","_React$Component","_ref","_temp","_this","this","_len","args","_key","getPrototypeOf","apply","_initialiseProps","shouldComponentUpdate","render","_props","renderMarks","_props2","renderText","attributes","reduce","children","mark","run","_props3","nodes","size","Component","propTypes","isRequired","number","_this2","message","_len2","_key2","debug$3","Text","_initialiseProps$1","decorations","decs","d","assertPath","compare","renderLeaf","list","defaultProps","_this3","nextProps","p","pLast","nLast","equals","debug$4","Void","_initialiseProps$2","Tag","spacer","color","outline","contentEditable","any","bool","id","getChildrenDecorations","activeDecorations","asMutable","childrenDecorations","orderChildDecorations","isEmpty","toArray","keyOrders","globalOrder","forEachDescendant","endPoints","order","decoration","startKeyOrder","containingChildOrder","getContainingChildOrder","nextChildIndex","findIndex","containingChild","isRangeStart","endKeyOrder","isRangeEnd","sort","b","add","remove","toList","debug$5","Node$1","Node$$1","_initialiseProps$3","shouldUpdate","isSelected","isFocused","indexes","getSelectionIndexes","getDecorations","isChildSelected","renderNode","isLeafBlock","getTextDirection","dir","findDOMRange","isBackward$$1","isBackward","OVERFLOWS","IS_IOS_11","navigator","userAgent","match","scrollToSelection","scroller","findScrollContainer","overflowY","getComputedStyle","includes","isWindow","documentElement","backward","cursorRect","collapsed","getClientRects","yOffset","xOffset","scrollerTop","scrollerLeft","scrollerBordersY","scrollerBordersX","scrollerPaddingTop","scrollerPaddingBottom","scrollerPaddingLeft","scrollerPaddingRight","innerWidth","innerHeight","pageYOffset","pageXOffset","offsetWidth","offsetHeight","scrollTop","scrollLeft","_window$getComputedSt","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","paddingTop","paddingBottom","paddingLeft","paddingRight","scrollerRect","cursorTop","cursorLeft","scrollTo","FIREFOX_NODE_TYPE_ACCESS_ERROR","debug$6","Content","tmp","isUpdatingSelection","handlers","handler","onEvent","updateSelection","updated","isUnset","isInEditor","preventScroll","isSet","current","setBaseAndExtent","setTimeout","ref","test","isContentEditable","onNativeSelectionChange","_this$props","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","componentDidUpdate","toRange","className","tabIndex","role","tagName","spellCheck","Container","wordWrap","WebkitUserModify","suppressContentEditableWarning","autoCorrect","PROPS","ReactPlugin","placeholder","decorateNode","renderEditor","ret","editorPlugin","memo","prop","when","getTexts","debug$7","Editor$1","Editor$$1","state","defaultValue","mounted","change","resolves","updates","resolveController","react","controller","onChange","handleChange","construct","autoFocus","commands","queries","schema","valueFromProps","valueFromState","setReadOnly","setValue","setState","applyOperation","_controller","command","_controller2","hasCommand","_controller3","hasQuery","_controller4","normalize","_controller5","_controller6","registerCommand","_controller7","registerQuery","_controller8","_controller9","withoutNormalizing","_controller10","_controller11","_controller12","_controller13","applyOperations","_controller14","setOperationFlag","_controller15","getFlag","_controller16","unsetOperationFlag","_controller17","withoutNormalization","_controller18","get","get$$1","operations","func","array","Editor","_typeof","exports","log","_console","console","formatArgs","useColors","namespace","module","humanize","diff","c","splice","lastC","replace","save","namespaces","storage","setItem","removeItem","load","getItem","process","env","DEBUG","__nwjs","toLowerCase","WebkitAppearance","firebug","exception","table","RegExp","$1","localstorage","localStorage","colors","formatters","j","v","setup","selectColor","hash","charCodeAt","createDebug","abs","prevTime","enabled","curr","Number","Date","ms","prev","coerce","unshift","format","formatter","val","logFn","destroy","extend","init","instances","delimiter","default","stack","disable","enable","names","skips","len","substr","name","keys"],"mappings":"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","file":"npm.slate-react-756166c67eab1bba0394.js","sourcesContent":["import { Node, Value, PathUtils, Editor } from 'slate';\nimport getWindow from 'get-window';\nimport invariant from 'tiny-invariant';\nimport Base64 from 'slate-base64-serializer';\nimport Plain from 'slate-plain-serializer';\nimport { IS_IE, IS_EDGE, IS_IOS, IS_FIREFOX, HAS_INPUT_EVENTS_LEVEL_2, IS_SAFARI } from 'slate-dev-environment';\nimport Debug from 'debug';\nimport Hotkeys from 'slate-hotkeys';\nimport ReactDOM from 'react-dom';\nimport React from 'react';\nimport Types from 'prop-types';\nimport SlateTypes from 'slate-prop-types';\nimport ImmutableTypes from 'react-immutable-proptypes';\nimport { Set } from 'immutable';\nimport warning from 'tiny-warning';\nimport isBackward from 'selection-is-backward';\nimport throttle from 'lodash/throttle';\nimport PlaceholderPlugin from 'slate-react-placeholder';\nimport memoizeOne from 'memoize-one';\n\n/**\n * Event handlers used by Slate plugins.\n *\n * @type {Array}\n */\n\nvar EVENT_HANDLERS = ['onBeforeInput', 'onBlur', 'onClick', 'onContextMenu', 'onCompositionEnd', 'onCompositionStart', 'onCopy', 'onCut', 'onDragEnd', 'onDragEnter', 'onDragExit', 'onDragLeave', 'onDragOver', 'onDragStart', 'onDrop', 'onInput', 'onFocus', 'onKeyDown', 'onKeyUp', 'onMouseDown', 'onMouseUp', 'onPaste', 'onSelect'];\n\n/**\n * The transfer types that Slate recognizes.\n *\n * @type {Object}\n */\n\nvar TRANSFER_TYPES = {\n  FRAGMENT: 'application/x-slate-fragment',\n  HTML: 'text/html',\n  NODE: 'application/x-slate-node',\n  RICH: 'text/rtf',\n  TEXT: 'text/plain'\n\n  /**\n   * Export.\n   *\n   * @type {Object}\n   */\n\n};\n\n/**\n * Find the DOM node for a `key`.\n *\n * @param {String|Node} key\n * @param {Window} win (optional)\n * @return {Element}\n */\n\nfunction findDOMNode(key) {\n  var win = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n\n  if (Node.isNode(key)) {\n    key = key.key;\n  }\n\n  var el = win.document.querySelector('[data-key=\"' + key + '\"]');\n\n  if (!el) {\n    throw new Error('Unable to find a DOM node for \"' + key + '\". This is often because of forgetting to add `props.attributes` to a custom component.');\n  }\n\n  return el;\n}\n\n/**\n * COMPAT: if we are in <= IE11 and the selection contains\n * tables, `removeAllRanges()` will throw\n * \"unable to complete the operation due to error 800a025e\"\n *\n * @param {Selection} selection document selection\n */\n\nfunction removeAllRanges(selection) {\n  var doc = window.document;\n\n  if (doc && doc.body.createTextRange) {\n    // All IE but Edge\n    var range = doc.body.createTextRange();\n    range.collapse();\n    range.select();\n  } else {\n    selection.removeAllRanges();\n  }\n}\n\nvar classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n\n\n\nvar defineProperty = function (obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n};\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n\nvar inherits = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n\n\n\n\n\n\n\n\n\nvar possibleConstructorReturn = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n\n\n\nvar slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar toConsumableArray = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n};\n\n/**\n * Offset key parser regex.\n *\n * @type {RegExp}\n */\n\nvar PARSER = /^([\\w-]+)(?::(\\d+))?$/;\n\n/**\n * Parse an offset key `string`.\n *\n * @param {String} string\n * @return {Object}\n */\n\nfunction parse(string) {\n  var matches = PARSER.exec(string);\n\n  if (!matches) {\n    throw new Error(\"Invalid offset key string \\\"\" + string + \"\\\".\");\n  }\n\n  var _matches = slicedToArray(matches, 3),\n      original = _matches[0],\n      key = _matches[1],\n      index = _matches[2]; // eslint-disable-line no-unused-vars\n\n\n  return {\n    key: key,\n    index: parseInt(index, 10)\n  };\n}\n\n/**\n * Stringify an offset key `object`.\n *\n * @param {Object} object\n *   @property {String} key\n *   @property {Number} index\n * @return {String}\n */\n\nfunction stringify(object) {\n  return object.key + \":\" + object.index;\n}\n\n/**\n * Export.\n *\n * @type {Object}\n */\n\nvar OffsetKey = {\n  parse: parse,\n  stringify: stringify\n};\n\n/**\n * Constants.\n *\n * @type {String}\n */\n\nvar ZERO_WIDTH_ATTRIBUTE = 'data-slate-zero-width';\nvar ZERO_WIDTH_SELECTOR = '[' + ZERO_WIDTH_ATTRIBUTE + ']';\nvar OFFSET_KEY_ATTRIBUTE = 'data-offset-key';\nvar RANGE_SELECTOR = '[' + OFFSET_KEY_ATTRIBUTE + ']';\nvar TEXT_SELECTOR = '[data-key]';\nvar VOID_SELECTOR = '[data-slate-void]';\n\n/**\n * Find a Slate point from a DOM selection's `nativeNode` and `nativeOffset`.\n *\n * @param {Element} nativeNode\n * @param {Number} nativeOffset\n * @param {Editor} editor\n * @return {Point}\n */\n\nfunction findPoint(nativeNode, nativeOffset, editor) {\n  invariant(!Value.isValue(editor), 'As of Slate 0.42.0, the `findPoint` utility takes an `editor` instead of a `value`.');\n\n  var _normalizeNodeAndOffs = normalizeNodeAndOffset(nativeNode, nativeOffset),\n      nearestNode = _normalizeNodeAndOffs.node,\n      nearestOffset = _normalizeNodeAndOffs.offset;\n\n  var window = getWindow(nativeNode);\n  var parentNode = nearestNode.parentNode;\n\n  var rangeNode = parentNode.closest(RANGE_SELECTOR);\n  var offset = void 0;\n  var node = void 0;\n\n  // Calculate how far into the text node the `nearestNode` is, so that we can\n  // determine what the offset relative to the text node is.\n  if (rangeNode) {\n    var range = window.document.createRange();\n    var textNode = rangeNode.closest(TEXT_SELECTOR);\n    range.setStart(textNode, 0);\n    range.setEnd(nearestNode, nearestOffset);\n    node = textNode;\n    offset = range.toString().length;\n  } else {\n    // For void nodes, the element with the offset key will be a cousin, not an\n    // ancestor, so find it by going down from the nearest void parent.\n    var voidNode = parentNode.closest(VOID_SELECTOR);\n    if (!voidNode) return null;\n    rangeNode = voidNode.querySelector(RANGE_SELECTOR);\n    if (!rangeNode) return null;\n    node = rangeNode;\n    offset = node.textContent.length;\n  }\n\n  // COMPAT: If the parent node is a Slate zero-width space, this is because the\n  // text node should have no characters. However, during IME composition the\n  // ASCII characters will be prepended to the zero-width space, so subtract 1\n  // from the offset to account for the zero-width space character.\n  if (offset == node.textContent.length && parentNode.hasAttribute(ZERO_WIDTH_ATTRIBUTE)) {\n    offset--;\n  }\n\n  // Get the string value of the offset key attribute.\n  var offsetKey = rangeNode.getAttribute(OFFSET_KEY_ATTRIBUTE);\n  if (!offsetKey) return null;\n\n  var _OffsetKey$parse = OffsetKey.parse(offsetKey),\n      key = _OffsetKey$parse.key;\n\n  // COMPAT: If someone is clicking from one Slate editor into another, the\n  // select event fires twice, once for the old editor's `element` first, and\n  // then afterwards for the correct `element`. (2017/03/03)\n\n\n  var value = editor.value;\n\n  if (!value.document.hasDescendant(key)) return null;\n\n  var point = value.document.createPoint({ key: key, offset: offset });\n  return point;\n}\n\n/**\n * From a DOM selection's `node` and `offset`, normalize so that it always\n * refers to a text node.\n *\n * @param {Element} node\n * @param {Number} offset\n * @return {Object}\n */\n\nfunction normalizeNodeAndOffset(node, offset) {\n  // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n  if (node.nodeType == 1 && node.childNodes.length) {\n    var isLast = offset == node.childNodes.length;\n    var direction = isLast ? 'backward' : 'forward';\n    var index = isLast ? offset - 1 : offset;\n    node = getEditableChild(node, index, direction);\n\n    // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n    while (node.nodeType == 1 && node.childNodes.length) {\n      var i = isLast ? node.childNodes.length - 1 : 0;\n      node = getEditableChild(node, i, direction);\n    }\n\n    // Determine the new offset inside the text node.\n    offset = isLast ? node.textContent.length : 0;\n  }\n\n  // Return the node and offset.\n  return { node: node, offset: offset };\n}\n\n/**\n * Get the nearest editable child at `index` in a `parent`, preferring\n * `direction`.\n *\n * @param {Element} parent\n * @param {Number} index\n * @param {String} direction ('forward' or 'backward')\n * @return {Element|Null}\n */\n\nfunction getEditableChild(parent, index, direction) {\n  var childNodes = parent.childNodes;\n\n  var child = childNodes[index];\n  var i = index;\n  var triedForward = false;\n  var triedBackward = false;\n\n  // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n  while (child.nodeType == 8 || child.nodeType == 1 && child.childNodes.length == 0 || child.nodeType == 1 && child.getAttribute('contenteditable') == 'false') {\n    if (triedForward && triedBackward) break;\n\n    if (i >= childNodes.length) {\n      triedForward = true;\n      i = index - 1;\n      direction = 'backward';\n      continue;\n    }\n\n    if (i < 0) {\n      triedBackward = true;\n      i = index + 1;\n      direction = 'forward';\n      continue;\n    }\n\n    child = childNodes[i];\n    if (direction == 'forward') i++;\n    if (direction == 'backward') i--;\n  }\n\n  return child || null;\n}\n\nvar FRAGMENT = TRANSFER_TYPES.FRAGMENT;\nvar HTML = TRANSFER_TYPES.HTML;\nvar TEXT = TRANSFER_TYPES.TEXT;\n\n/**\n * Prepares a Slate document fragment to be copied to the clipboard.\n *\n * @param {Event} event\n * @param {Editor} editor\n */\n\nfunction cloneFragment(event, editor) {\n  var callback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function () {\n    return undefined;\n  };\n\n  invariant(!Value.isValue(editor), 'As of Slate 0.42.0, the `cloneFragment` utility takes an `editor` instead of a `value`.');\n\n  var window = getWindow(event.target);\n  var native = window.getSelection();\n  var value = editor.value;\n  var document = value.document,\n      fragment = value.fragment,\n      selection = value.selection;\n  var start = selection.start,\n      end = selection.end;\n\n  var startVoid = document.getClosestVoid(start.key, editor);\n  var endVoid = document.getClosestVoid(end.key, editor);\n\n  // If the selection is collapsed, and it isn't inside a void node, abort.\n  if (native.isCollapsed && !startVoid) return;\n\n  // Create a fake selection so that we can add a Base64-encoded copy of the\n  // fragment to the HTML, to decode on future pastes.\n  var encoded = Base64.serializeNode(fragment);\n  var range = native.getRangeAt(0);\n  var contents = range.cloneContents();\n  var attach = contents.childNodes[0];\n\n  // Make sure attach is a non-empty node, since empty nodes will not get copied\n  contents.childNodes.forEach(function (node) {\n    if (node.textContent && node.textContent.trim() !== '') {\n      attach = node;\n    }\n  });\n\n  // COMPAT: If the end node is a void node, we need to move the end of the\n  // range from the void node's spacer span, to the end of the void node's\n  // content, since the spacer is before void's content in the DOM.\n  if (endVoid) {\n    var r = range.cloneRange();\n    var node = findDOMNode(endVoid, window);\n    r.setEndAfter(node);\n    contents = r.cloneContents();\n  }\n\n  // COMPAT: If the start node is a void node, we need to attach the encoded\n  // fragment to the void node's content node instead of the spacer, because\n  // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n  // most browsers. (2018/04/27)\n  if (startVoid) {\n    attach = contents.childNodes[0].childNodes[1].firstChild;\n  }\n\n  // Remove any zero-width space spans from the cloned DOM so that they don't\n  // show up elsewhere when pasted.\n  [].slice.call(contents.querySelectorAll(ZERO_WIDTH_SELECTOR)).forEach(function (zw) {\n    var isNewline = zw.getAttribute(ZERO_WIDTH_ATTRIBUTE) === 'n';\n    zw.textContent = isNewline ? '\\n' : '';\n  });\n\n  // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n  // in the HTML, and can be used for intra-Slate pasting. If it's a text\n  // node, wrap it in a `<span>` so we have something to set an attribute on.\n  if (attach.nodeType == 3) {\n    var span = window.document.createElement('span');\n\n    // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n    // then leading and trailing spaces will be ignored. (2017/09/21)\n    span.style.whiteSpace = 'pre';\n\n    span.appendChild(attach);\n    contents.appendChild(span);\n    attach = span;\n  }\n\n  attach.setAttribute('data-slate-fragment', encoded);\n\n  //  Creates value from only the selected blocks\n  //  Then gets plaintext for clipboard with proper linebreaks for BLOCK elements\n  //  Via Plain serializer\n  var valFromSelection = Value.create({ document: fragment });\n  var plainText = Plain.serialize(valFromSelection);\n\n  // Add the phony content to a div element. This is needed to copy the\n  // contents into the html clipboard register.\n  var div = window.document.createElement('div');\n  div.appendChild(contents);\n\n  // For browsers supporting it, we set the clipboard registers manually,\n  // since the result is more predictable.\n  // COMPAT: IE supports the setData method, but only in restricted sense.\n  // IE doesn't support arbitrary MIME types or common ones like 'text/plain';\n  // it only accepts \"Text\" (which gets mapped to 'text/plain') and \"Url\"\n  // (mapped to 'text/url-list'); so, we should only enter block if !IS_IE\n  if (event.clipboardData && event.clipboardData.setData && !IS_IE) {\n    event.preventDefault();\n    event.clipboardData.setData(TEXT, plainText);\n    event.clipboardData.setData(FRAGMENT, encoded);\n    event.clipboardData.setData(HTML, div.innerHTML);\n    callback();\n    return;\n  }\n\n  // COMPAT: For browser that don't support the Clipboard API's setData method,\n  // we must rely on the browser to natively copy what's selected.\n  // So we add the div (containing our content) to the DOM, and select it.\n  var editorEl = event.target.closest('[data-slate-editor]');\n  div.setAttribute('contenteditable', true);\n  div.style.position = 'absolute';\n  div.style.left = '-9999px';\n  editorEl.appendChild(div);\n  native.selectAllChildren(div);\n\n  // Revert to the previous selection right after copying.\n  window.requestAnimationFrame(function () {\n    editorEl.removeChild(div);\n    removeAllRanges(native);\n    native.addRange(range);\n    callback();\n  });\n}\n\n/**\n * Find a Slate node from a DOM `element`.\n *\n * @param {Element} element\n * @param {Editor} editor\n * @return {Node|Null}\n */\n\nfunction findNode(element, editor) {\n  invariant(!Value.isValue(editor), 'As of Slate 0.42.0, the `findNode` utility takes an `editor` instead of a `value`.');\n\n  var closest = element.closest('[data-key]');\n  if (!closest) return null;\n\n  var key = closest.getAttribute('data-key');\n  if (!key) return null;\n\n  var value = editor.value;\n  var document = value.document;\n\n  var node = document.getNode(key);\n  return node || null;\n}\n\n/**\n * Find a native DOM selection point from a Slate `point`.\n *\n * @param {Point} point\n * @param {Window} win (optional)\n * @return {Object|Null}\n */\n\nfunction findDOMPoint(point) {\n  var win = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n\n  var el = findDOMNode(point.key, win);\n  var start = 0;\n\n  // For each leaf, we need to isolate its content, which means filtering to its\n  // direct text and zero-width spans. (We have to filter out any other siblings\n  // that may have been rendered alongside them.)\n  var texts = Array.from(el.querySelectorAll('[data-slate-content], [data-slate-zero-width]'));\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = texts[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var text = _step.value;\n\n      var node = text.childNodes[0];\n      var domLength = node.textContent.length;\n      var slateLength = domLength;\n\n      if (text.hasAttribute('data-slate-length')) {\n        slateLength = parseInt(text.getAttribute('data-slate-length'), 10);\n      }\n\n      var end = start + slateLength;\n\n      if (point.offset <= end) {\n        var offset = Math.min(domLength, Math.max(0, point.offset - start));\n        return { node: node, offset: offset };\n      }\n\n      start = end;\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator.return) {\n        _iterator.return();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * Find a Slate range from a DOM `native` selection.\n *\n * @param {Selection} native\n * @param {Editor} editor\n * @return {Range}\n */\n\nfunction findRange(native, editor) {\n  invariant(!Value.isValue(editor), 'As of Slate 0.42.0, the `findNode` utility takes an `editor` instead of a `value`.');\n\n  var el = native.anchorNode || native.startContainer;\n  if (!el) return null;\n\n  var window = getWindow(el);\n\n  // If the `native` object is a DOM `Range` or `StaticRange` object, change it\n  // into something that looks like a DOM `Selection` instead.\n  if (native instanceof window.Range || window.StaticRange && native instanceof window.StaticRange) {\n    native = {\n      anchorNode: native.startContainer,\n      anchorOffset: native.startOffset,\n      focusNode: native.endContainer,\n      focusOffset: native.endOffset\n    };\n  }\n\n  var _native = native,\n      anchorNode = _native.anchorNode,\n      anchorOffset = _native.anchorOffset,\n      focusNode = _native.focusNode,\n      focusOffset = _native.focusOffset,\n      isCollapsed = _native.isCollapsed;\n  var value = editor.value;\n\n  var anchor = findPoint(anchorNode, anchorOffset, editor);\n  var focus = isCollapsed ? anchor : findPoint(focusNode, focusOffset, editor);\n  if (!anchor || !focus) return null;\n\n  // COMPAT: ??? The Edge browser seems to have a case where if you select the\n  // last word of a span, it sets the endContainer to the containing span.\n  // `selection-is-backward` doesn't handle this case.\n  if (IS_IE || IS_EDGE) {\n    var domAnchor = findDOMPoint(anchor);\n    var domFocus = findDOMPoint(focus);\n\n    native = {\n      anchorNode: domAnchor.node,\n      anchorOffset: domAnchor.offset,\n      focusNode: domFocus.node,\n      focusOffset: domFocus.offset\n    };\n  }\n\n  var document = value.document;\n\n  var range = document.createRange({\n    anchor: anchor,\n    focus: focus\n  });\n\n  return range;\n}\n\n/**\n * Get the target range from a DOM `event`.\n *\n * @param {Event} event\n * @param {Editor} editor\n * @return {Range}\n */\n\nfunction getEventRange(event, editor) {\n  invariant(!Value.isValue(editor), 'As of Slate 0.42.0, the `findNode` utility takes an `editor` instead of a `value`.');\n\n  if (event.nativeEvent) {\n    event = event.nativeEvent;\n  }\n\n  var _event = event,\n      x = _event.x,\n      y = _event.y,\n      target = _event.target;\n\n  if (x == null || y == null) return null;\n\n  var value = editor.value;\n  var document = value.document;\n\n  var node = findNode(target, editor);\n  if (!node) return null;\n\n  // If the drop target is inside a void node, move it into either the next or\n  // previous node, depending on which side the `x` and `y` coordinates are\n  // closest to.\n  if (editor.query('isVoid', node)) {\n    var rect = target.getBoundingClientRect();\n    var isPrevious = node.object == 'inline' ? x - rect.left < rect.left + rect.width - x : y - rect.top < rect.top + rect.height - y;\n\n    var text = node.getFirstText();\n    var _range = document.createRange();\n\n    if (isPrevious) {\n      var previousText = document.getPreviousText(text.key);\n\n      if (previousText) {\n        return _range.moveToEndOfNode(previousText);\n      }\n    }\n\n    var nextText = document.getNextText(text.key);\n    return nextText ? _range.moveToStartOfNode(nextText) : null;\n  }\n\n  // Else resolve a range from the caret position where the drop occured.\n  var window = getWindow(target);\n  var native = void 0;\n\n  // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n  if (window.document.caretRangeFromPoint) {\n    native = window.document.caretRangeFromPoint(x, y);\n  } else if (window.document.caretPositionFromPoint) {\n    var position = window.document.caretPositionFromPoint(x, y);\n    native = window.document.createRange();\n    native.setStart(position.offsetNode, position.offset);\n    native.setEnd(position.offsetNode, position.offset);\n  } else if (window.document.body.createTextRange) {\n    // COMPAT: In IE, `caretRangeFromPoint` and\n    // `caretPositionFromPoint` don't exist. (2018/07/11)\n    native = window.document.body.createTextRange();\n\n    try {\n      native.moveToPoint(x, y);\n    } catch (error) {\n      // IE11 will raise an `unspecified error` if `moveToPoint` is\n      // called during a dropEvent.\n      return null;\n    }\n  }\n\n  // Resolve a Slate range from the DOM range.\n  var range = findRange(native, editor);\n  if (!range) return null;\n\n  return range;\n}\n\n/**\n * Transfer types.\n *\n * @type {String}\n */\n\nvar FRAGMENT$1 = TRANSFER_TYPES.FRAGMENT;\nvar HTML$1 = TRANSFER_TYPES.HTML;\nvar NODE = TRANSFER_TYPES.NODE;\nvar RICH = TRANSFER_TYPES.RICH;\nvar TEXT$1 = TRANSFER_TYPES.TEXT;\n\n/**\n * Fragment matching regexp for HTML nodes.\n *\n * @type {RegExp}\n */\n\nvar FRAGMENT_MATCHER = / data-slate-fragment=\"([^\\s\"]+)\"/;\n\n/**\n * Get the transfer data from an `event`.\n *\n * @param {Event} event\n * @return {Object}\n */\n\nfunction getEventTransfer(event) {\n  // COMPAT: IE 11 doesn't populate nativeEvent with either\n  // dataTransfer or clipboardData. We'll need to use the base event\n  // object (2018/14/6)\n  if (!IS_IE && event.nativeEvent) {\n    event = event.nativeEvent;\n  }\n\n  var transfer = event.dataTransfer || event.clipboardData;\n  var fragment = getType(transfer, FRAGMENT$1);\n  var node = getType(transfer, NODE);\n  var html = getType(transfer, HTML$1);\n  var rich = getType(transfer, RICH);\n  var text = getType(transfer, TEXT$1);\n  var files = void 0;\n\n  // If there isn't a fragment, but there is HTML, check to see if the HTML is\n  // actually an encoded fragment.\n  if (!fragment && html && ~html.indexOf(' data-slate-fragment=\"')) {\n    var matches = FRAGMENT_MATCHER.exec(html);\n\n    var _matches = slicedToArray(matches, 2),\n        full = _matches[0],\n        encoded = _matches[1]; // eslint-disable-line no-unused-vars\n\n\n    if (encoded) fragment = encoded;\n  }\n\n  // COMPAT: Edge doesn't handle custom data types\n  // These will be embedded in text/plain in this case (2017/7/12)\n  if (text) {\n    var embeddedTypes = getEmbeddedTypes(text);\n\n    if (embeddedTypes[FRAGMENT$1]) fragment = embeddedTypes[FRAGMENT$1];\n    if (embeddedTypes[NODE]) node = embeddedTypes[NODE];\n    if (embeddedTypes[TEXT$1]) text = embeddedTypes[TEXT$1];\n  }\n\n  // Decode a fragment or node if they exist.\n  if (fragment) fragment = Base64.deserializeNode(fragment);\n  if (node) node = Base64.deserializeNode(node);\n\n  // COMPAT: Edge sometimes throws 'NotSupportedError'\n  // when accessing `transfer.items` (2017/7/12)\n  try {\n    // Get and normalize files if they exist.\n    if (transfer.items && transfer.items.length) {\n      files = Array.from(transfer.items).map(function (item) {\n        return item.kind == 'file' ? item.getAsFile() : null;\n      }).filter(function (exists) {\n        return exists;\n      });\n    } else if (transfer.files && transfer.files.length) {\n      files = Array.from(transfer.files);\n    }\n  } catch (err) {\n    if (transfer.files && transfer.files.length) {\n      files = Array.from(transfer.files);\n    }\n  }\n\n  // Determine the type of the data.\n  var data = { files: files, fragment: fragment, html: html, node: node, rich: rich, text: text };\n  data.type = getTransferType(data);\n  return data;\n}\n\n/**\n * Takes text input, checks whether contains embedded data\n * and returns object with original text +/- additional data\n *\n * @param {String} text\n * @return {Object}\n */\n\nfunction getEmbeddedTypes(text) {\n  var prefix = 'SLATE-DATA-EMBED::';\n\n  if (text.substring(0, prefix.length) != prefix) {\n    return { TEXT: text };\n  }\n\n  // Attempt to parse, if fails then just standard text/plain\n  // Otherwise, already had data embedded\n  try {\n    return JSON.parse(text.substring(prefix.length));\n  } catch (err) {\n    throw new Error('Unable to parse custom Slate drag event data.');\n  }\n}\n\n/**\n * Get the type of a transfer from its `data`.\n *\n * @param {Object} data\n * @return {String}\n */\n\nfunction getTransferType(data) {\n  if (data.fragment) return 'fragment';\n  if (data.node) return 'node';\n\n  // COMPAT: Microsoft Word adds an image of the selected text to the data.\n  // Since files are preferred over HTML or text, this would cause the type to\n  // be considered `files`. But it also adds rich text data so we can check\n  // for that and properly set the type to `html` or `text`. (2016/11/21)\n  if (data.rich && data.html) return 'html';\n  if (data.rich && data.text) return 'text';\n\n  if (data.files && data.files.length) return 'files';\n  if (data.html) return 'html';\n  if (data.text) return 'text';\n  return 'unknown';\n}\n\n/**\n * Get one of types `TYPES.FRAGMENT`, `TYPES.NODE`, `text/html`, `text/rtf` or\n * `text/plain` from transfers's `data` if possible, otherwise return null.\n *\n * @param {Object} transfer\n * @param {String} type\n * @return {String}\n */\n\nfunction getType(transfer, type) {\n  if (!transfer.types || !transfer.types.length) {\n    // COMPAT: In IE 11, there is no `types` field but `getData('Text')`\n    // is supported`. (2017/06/23)\n    return type == TEXT$1 ? transfer.getData('Text') || null : null;\n  }\n\n  // COMPAT: In Edge, transfer.types doesn't respond to `indexOf`. (2017/10/25)\n  var types = Array.from(transfer.types);\n\n  return types.indexOf(type) !== -1 ? transfer.getData(type) || null : null;\n}\n\n/**\n * The default plain text transfer type.\n *\n * @type {String}\n */\n\nvar TEXT$2 = TRANSFER_TYPES.TEXT;\n\n/**\n * Set data with `type` and `content` on an `event`.\n *\n * COMPAT: In Edge, custom types throw errors, so embed all non-standard\n * types in text/plain compound object. (2017/7/12)\n *\n * @param {Event} event\n * @param {String} type\n * @param {String} content\n */\n\nfunction setEventTransfer(event, type, content) {\n  var mime = TRANSFER_TYPES[type.toUpperCase()];\n\n  if (!mime) {\n    throw new Error('Cannot set unknown transfer type \"' + mime + '\".');\n  }\n\n  if (event.nativeEvent) {\n    event = event.nativeEvent;\n  }\n\n  var transfer = event.dataTransfer || event.clipboardData;\n\n  try {\n    transfer.setData(mime, content);\n    // COMPAT: Safari needs to have the 'text' (and not 'text/plain') value in dataTransfer\n    // to display the cursor while dragging internally.\n    transfer.setData('text', transfer.getData('text'));\n  } catch (err) {\n    var prefix = 'SLATE-DATA-EMBED::';\n    var text = transfer.getData(TEXT$2);\n    var obj = {};\n\n    // If the existing plain text data is prefixed, it's Slate JSON data.\n    if (text.substring(0, prefix.length) === prefix) {\n      try {\n        obj = JSON.parse(text.substring(prefix.length));\n      } catch (e) {\n        throw new Error('Failed to parse Slate data from `DataTransfer` object.');\n      }\n    } else {\n      // Otherwise, it's just set it as is.\n      obj[TEXT$2] = text;\n    }\n\n    obj[mime] = content;\n    var string = '' + prefix + JSON.stringify(obj);\n    transfer.setData(TEXT$2, string);\n  }\n}\n\nfunction setSelectionFromDOM(window, editor, domSelection) {\n  var value = editor.value;\n  var document = value.document;\n\n  // If there are no ranges, the editor was blurred natively.\n\n  if (!domSelection.rangeCount) {\n    editor.blur();\n    return;\n  }\n\n  // Otherwise, determine the Slate selection from the native one.\n  var range = findRange(domSelection, editor);\n\n  if (!range) {\n    return;\n  }\n\n  var _range = range,\n      anchor = _range.anchor,\n      focus = _range.focus;\n\n  var anchorText = document.getNode(anchor.key);\n  var focusText = document.getNode(focus.key);\n  var anchorInline = document.getClosestInline(anchor.key);\n  var focusInline = document.getClosestInline(focus.key);\n  var focusBlock = document.getClosestBlock(focus.key);\n  var anchorBlock = document.getClosestBlock(anchor.key);\n\n  // COMPAT: If the anchor point is at the start of a non-void, and the\n  // focus point is inside a void node with an offset that isn't `0`, set\n  // the focus offset to `0`. This is due to void nodes <span>'s being\n  // positioned off screen, resulting in the offset always being greater\n  // than `0`. Since we can't know what it really should be, and since an\n  // offset of `0` is less destructive because it creates a hanging\n  // selection, go with `0`. (2017/09/07)\n  if (anchorBlock && !editor.isVoid(anchorBlock) && anchor.offset == 0 && focusBlock && editor.isVoid(focusBlock) && focus.offset != 0) {\n    range = range.setFocus(focus.setOffset(0));\n  }\n\n  // COMPAT: If the selection is at the end of a non-void inline node, and\n  // there is a node after it, put it in the node after instead. This\n  // standardizes the behavior, since it's indistinguishable to the user.\n  if (anchorInline && !editor.isVoid(anchorInline) && anchor.offset == anchorText.text.length) {\n    var block = document.getClosestBlock(anchor.key);\n    var nextText = block.getNextText(anchor.key);\n    if (nextText) range = range.moveAnchorTo(nextText.key, 0);\n  }\n\n  if (focusInline && !editor.isVoid(focusInline) && focus.offset == focusText.text.length) {\n    var _block = document.getClosestBlock(focus.key);\n    var _nextText = _block.getNextText(focus.key);\n    if (_nextText) range = range.moveFocusTo(_nextText.key, 0);\n  }\n\n  var selection = document.createSelection(range);\n  selection = selection.setIsFocused(true);\n\n  // Preserve active marks from the current selection.\n  // They will be cleared by `editor.select` if the selection actually moved.\n  selection = selection.set('marks', value.selection.marks);\n\n  editor.select(selection);\n}\n\nfunction setTextFromDomNode(window, editor, domNode) {\n  var point = findPoint(domNode, 0, editor);\n  if (!point) return;\n\n  // Get the text node and leaf in question.\n  var value = editor.value;\n  var document = value.document,\n      selection = value.selection;\n\n  var node = document.getDescendant(point.key);\n  var block = document.getClosestBlock(node.key);\n  var leaves = node.getLeaves();\n  var lastText = block.getLastText();\n  var lastLeaf = leaves.last();\n  var start = 0;\n  var end = 0;\n\n  var leaf = leaves.find(function (r) {\n    start = end;\n    end += r.text.length;\n    if (end > point.offset) return true;\n  }) || lastLeaf;\n\n  // Get the text information.\n  var text = leaf.text;\n  var textContent = domNode.textContent;\n\n  var isLastText = node == lastText;\n  var isLastLeaf = leaf == lastLeaf;\n  var lastChar = textContent.charAt(textContent.length - 1);\n\n  // COMPAT: If this is the last leaf, and the DOM text ends in a new line,\n  // we will have added another new line in <Leaf>'s render method to account\n  // for browsers collapsing a single trailing new lines, so remove it.\n  if (isLastText && isLastLeaf && lastChar == '\\n') {\n    textContent = textContent.slice(0, -1);\n  }\n\n  // If the text is no different, abort.\n  if (textContent == text) return;\n\n  // Determine what the selection should be after changing the text.\n  // const delta = textContent.length - text.length\n  // const corrected = selection.moveToEnd().moveForward(delta)\n  var entire = selection.moveAnchorTo(point.key, start).moveFocusTo(point.key, end);\n\n  entire = document.resolveRange(entire);\n\n  // Change the current value to have the leaf's text replaced.\n  editor.insertTextAtRange(entire, textContent, leaf.marks);\n}\n\n/**\n * Debug.\n *\n * @type {Function}\n */\n\nvar debug = Debug('slate:after');\n\n/**\n * A plugin that adds the \"after\" browser-specific logic to the editor.\n *\n * @param {Object} options\n * @return {Object}\n */\n\nfunction AfterPlugin() {\n  var isDraggingInternally = null;\n  var isMouseDown = false;\n\n  /**\n   * On before input.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onBeforeInput(event, editor, next) {\n    var value = editor.value;\n\n    var isSynthetic = !!event.nativeEvent;\n\n    // If the event is synthetic, it's React's polyfill of `beforeinput` that\n    // isn't a true `beforeinput` event with meaningful information. It only\n    // gets triggered for character insertions, so we can just insert directly.\n    if (isSynthetic) {\n      event.preventDefault();\n      editor.insertText(event.data);\n      return next();\n    }\n\n    // Otherwise, we can use the information in the `beforeinput` event to\n    // figure out the exact change that will occur, and prevent it.\n\n    var _event$getTargetRange = event.getTargetRanges(),\n        _event$getTargetRange2 = slicedToArray(_event$getTargetRange, 1),\n        targetRange = _event$getTargetRange2[0];\n\n    if (!targetRange) return next();\n\n    debug('onBeforeInput', { event: event });\n\n    event.preventDefault();\n\n    var document = value.document,\n        selection = value.selection;\n\n    var range = findRange(targetRange, editor);\n\n    switch (event.inputType) {\n      case 'deleteByDrag':\n      case 'deleteByCut':\n      case 'deleteContent':\n      case 'deleteContentBackward':\n      case 'deleteContentForward':\n        {\n          editor.deleteAtRange(range);\n          break;\n        }\n\n      case 'deleteWordBackward':\n        {\n          editor.deleteWordBackwardAtRange(range);\n          break;\n        }\n\n      case 'deleteWordForward':\n        {\n          editor.deleteWordForwardAtRange(range);\n          break;\n        }\n\n      case 'deleteSoftLineBackward':\n      case 'deleteHardLineBackward':\n        {\n          editor.deleteLineBackwardAtRange(range);\n          break;\n        }\n\n      case 'deleteSoftLineForward':\n      case 'deleteHardLineForward':\n        {\n          editor.deleteLineForwardAtRange(range);\n          break;\n        }\n\n      case 'insertLineBreak':\n      case 'insertParagraph':\n        {\n          var hasVoidParent = document.hasVoidParent(selection.start.path, editor);\n\n          if (hasVoidParent) {\n            editor.moveToStartOfNextText();\n          } else {\n            editor.splitBlockAtRange(range);\n          }\n\n          break;\n        }\n\n      case 'insertFromYank':\n      case 'insertReplacementText':\n      case 'insertText':\n        {\n          // COMPAT: `data` should have the text for the `insertText` input type\n          // and `dataTransfer` should have the text for the\n          // `insertReplacementText` input type, but Safari uses `insertText` for\n          // spell check replacements and sets `data` to `null`. (2018/08/09)\n          var text = event.data == null ? event.dataTransfer.getData('text/plain') : event.data;\n\n          if (text == null) break;\n\n          editor.insertTextAtRange(range, text, selection.marks);\n\n          // If the text was successfully inserted, and the selection had marks\n          // on it, unset the selection's marks.\n          if (selection.marks && value.document != editor.value.document) {\n            editor.select({ marks: null });\n          }\n\n          break;\n        }\n    }\n\n    next();\n  }\n\n  /**\n   * On blur.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onBlur(event, editor, next) {\n    debug('onBlur', { event: event });\n    editor.blur();\n    next();\n  }\n\n  /**\n   * On click.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onClick(event, editor, next) {\n    if (editor.readOnly) return next();\n\n    var value = editor.value;\n    var document = value.document;\n\n    var node = findNode(event.target, editor);\n    if (!node) return next();\n\n    debug('onClick', { event: event });\n\n    var ancestors = document.getAncestors(node.key);\n    var isVoid = node && (editor.isVoid(node) || ancestors.some(function (a) {\n      return editor.isVoid(a);\n    }));\n\n    if (isVoid) {\n      // COMPAT: In Chrome & Safari, selections that are at the zero offset of\n      // an inline node will be automatically replaced to be at the last offset\n      // of a previous inline node, which screws us up, so we always want to set\n      // it to the end of the node. (2016/11/29)\n      editor.focus().moveToEndOfNode(node);\n    }\n\n    next();\n  }\n\n  /**\n   * On copy.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onCopy(event, editor, next) {\n    debug('onCopy', { event: event });\n    cloneFragment(event, editor);\n    next();\n  }\n\n  /**\n   * On cut.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onCut(event, editor, next) {\n    debug('onCut', { event: event });\n\n    // Once the fake cut content has successfully been added to the clipboard,\n    // delete the content in the current selection.\n    cloneFragment(event, editor, function () {\n      // If user cuts a void block node or a void inline node,\n      // manually removes it since selection is collapsed in this case.\n      var value = editor.value;\n      var endBlock = value.endBlock,\n          endInline = value.endInline,\n          selection = value.selection;\n      var isCollapsed = selection.isCollapsed;\n\n      var isVoidBlock = endBlock && editor.isVoid(endBlock) && isCollapsed;\n      var isVoidInline = endInline && editor.isVoid(endInline) && isCollapsed;\n\n      if (isVoidBlock) {\n        editor.removeNodeByKey(endBlock.key);\n      } else if (isVoidInline) {\n        editor.removeNodeByKey(endInline.key);\n      } else {\n        editor.delete();\n      }\n    });\n\n    next();\n  }\n\n  /**\n   * On drag end.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragEnd(event, editor, next) {\n    debug('onDragEnd', { event: event });\n    isDraggingInternally = null;\n    next();\n  }\n\n  /**\n   * On drag start.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragStart(event, editor, next) {\n    debug('onDragStart', { event: event });\n\n    isDraggingInternally = true;\n\n    var value = editor.value;\n    var document = value.document;\n\n    var node = findNode(event.target, editor);\n    var ancestors = document.getAncestors(node.key);\n    var isVoid = node && (editor.isVoid(node) || ancestors.some(function (a) {\n      return editor.isVoid(a);\n    }));\n    var selectionIncludesNode = value.blocks.some(function (block) {\n      return block.key === node.key;\n    });\n\n    // If a void block is dragged and is not selected, select it (necessary for local drags).\n    if (isVoid && !selectionIncludesNode) {\n      editor.moveToRangeOfNode(node);\n    }\n\n    var fragment = editor.value.fragment;\n    var encoded = Base64.serializeNode(fragment);\n    setEventTransfer(event, 'fragment', encoded);\n    next();\n  }\n\n  /**\n   * On drop.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDrop(event, editor, next) {\n    var value = editor.value;\n    var document = value.document,\n        selection = value.selection;\n\n    var window = getWindow(event.target);\n    var target = getEventRange(event, editor);\n    if (!target) return next();\n\n    debug('onDrop', { event: event });\n\n    var transfer = getEventTransfer(event);\n    var type = transfer.type,\n        fragment = transfer.fragment,\n        text = transfer.text;\n\n\n    editor.focus();\n\n    // If the drag is internal and the target is after the selection, it\n    // needs to account for the selection's content being deleted.\n    if (isDraggingInternally && selection.end.key == target.end.key && selection.end.offset < target.end.offset) {\n      target = target.moveForward(selection.start.key == selection.end.key ? 0 - selection.end.offset + selection.start.offset : 0 - selection.end.offset);\n    }\n\n    if (isDraggingInternally) {\n      editor.delete();\n    }\n\n    editor.select(target);\n\n    if (type == 'text' || type == 'html') {\n      var _target = target,\n          anchor = _target.anchor;\n\n      var hasVoidParent = document.hasVoidParent(anchor.key, editor);\n\n      if (hasVoidParent) {\n        var n = document.getNode(anchor.key);\n\n        while (hasVoidParent) {\n          n = document.getNextText(n.key);\n          if (!n) break;\n          hasVoidParent = document.hasVoidParent(n.key, editor);\n        }\n\n        if (n) editor.moveToStartOfNode(n);\n      }\n\n      if (text) {\n        text.split('\\n').forEach(function (line, i) {\n          if (i > 0) editor.splitBlock();\n          editor.insertText(line);\n        });\n      }\n    }\n\n    if (type == 'fragment') {\n      editor.insertFragment(fragment);\n    }\n\n    // COMPAT: React's onSelect event breaks after an onDrop event\n    // has fired in a node: https://github.com/facebook/react/issues/11379.\n    // Until this is fixed in React, we dispatch a mouseup event on that\n    // DOM node, since that will make it go back to normal.\n    var focusNode = document.getNode(target.focus.key);\n    var el = findDOMNode(focusNode, window);\n\n    if (el) {\n      el.dispatchEvent(new MouseEvent('mouseup', {\n        view: window,\n        bubbles: true,\n        cancelable: true\n      }));\n    }\n\n    next();\n  }\n\n  /**\n   * On focus.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onFocus(event, editor, next) {\n    debug('onFocus', { event: event });\n\n    // COMPAT: If the focus event is a mouse-based one, it will be shortly\n    // followed by a `selectionchange`, so we need to deselect here to prevent\n    // the old selection from being set by the `updateSelection` of `<Content>`,\n    // preventing the `selectionchange` from firing. (2018/11/07)\n    if (isMouseDown && !IS_IE && !IS_EDGE) {\n      editor.deselect().focus();\n    } else {\n      editor.focus();\n    }\n\n    next();\n  }\n\n  /**\n   * On input.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onInput(event, editor, next) {\n    debug('onInput');\n    var window = getWindow(event.target);\n\n    // Get the selection point.\n    var selection = window.getSelection();\n    var anchorNode = selection.anchorNode;\n\n\n    setTextFromDomNode(window, editor, anchorNode);\n    setSelectionFromDOM(window, editor, selection);\n    next();\n  }\n\n  /**\n   * On key down.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onKeyDown(event, editor, next) {\n    debug('onKeyDown', { event: event });\n\n    var value = editor.value;\n    var document = value.document,\n        selection = value.selection;\n\n    var hasVoidParent = document.hasVoidParent(selection.start.path, editor);\n\n    // COMPAT: In iOS, some of these hotkeys are handled in the\n    // `onNativeBeforeInput` handler of the `<Content>` component in order to\n    // preserve native autocorrect behavior, so they shouldn't be handled here.\n    if (Hotkeys.isSplitBlock(event) && !IS_IOS) {\n      return hasVoidParent ? editor.moveToStartOfNextText() : editor.splitBlock();\n    }\n\n    if (Hotkeys.isDeleteBackward(event) && !IS_IOS) {\n      return editor.deleteCharBackward();\n    }\n\n    if (Hotkeys.isDeleteForward(event) && !IS_IOS) {\n      return editor.deleteCharForward();\n    }\n\n    if (Hotkeys.isDeleteLineBackward(event)) {\n      return editor.deleteLineBackward();\n    }\n\n    if (Hotkeys.isDeleteLineForward(event)) {\n      return editor.deleteLineForward();\n    }\n\n    if (Hotkeys.isDeleteWordBackward(event)) {\n      return editor.deleteWordBackward();\n    }\n\n    if (Hotkeys.isDeleteWordForward(event)) {\n      return editor.deleteWordForward();\n    }\n\n    if (Hotkeys.isRedo(event)) {\n      return editor.redo();\n    }\n\n    if (Hotkeys.isUndo(event)) {\n      return editor.undo();\n    }\n\n    // COMPAT: Certain browsers don't handle the selection updates properly. In\n    // Chrome, the selection isn't properly extended. And in Firefox, the\n    // selection isn't properly collapsed. (2017/10/17)\n    if (Hotkeys.isMoveLineBackward(event)) {\n      event.preventDefault();\n      return editor.moveToStartOfBlock();\n    }\n\n    if (Hotkeys.isMoveLineForward(event)) {\n      event.preventDefault();\n      return editor.moveToEndOfBlock();\n    }\n\n    if (Hotkeys.isExtendLineBackward(event)) {\n      event.preventDefault();\n      return editor.moveFocusToStartOfBlock();\n    }\n\n    if (Hotkeys.isExtendLineForward(event)) {\n      event.preventDefault();\n      return editor.moveFocusToEndOfBlock();\n    }\n\n    // COMPAT: If a void node is selected, or a zero-width text node adjacent to\n    // an inline is selected, we need to handle these hotkeys manually because\n    // browsers won't know what to do.\n    if (Hotkeys.isMoveBackward(event)) {\n      event.preventDefault();\n\n      if (!selection.isCollapsed) {\n        return editor.moveToStart();\n      }\n\n      return editor.moveBackward();\n    }\n\n    if (Hotkeys.isMoveForward(event)) {\n      event.preventDefault();\n\n      if (!selection.isCollapsed) {\n        return editor.moveToEnd();\n      }\n\n      return editor.moveForward();\n    }\n\n    if (Hotkeys.isMoveWordBackward(event)) {\n      event.preventDefault();\n      return editor.moveWordBackward();\n    }\n\n    if (Hotkeys.isMoveWordForward(event)) {\n      event.preventDefault();\n      return editor.moveWordForward();\n    }\n\n    if (Hotkeys.isExtendBackward(event)) {\n      var previousText = value.previousText,\n          startText = value.startText;\n\n      var isPreviousInVoid = previousText && document.hasVoidParent(previousText.key, editor);\n\n      if (hasVoidParent || isPreviousInVoid || startText.text == '') {\n        event.preventDefault();\n        return editor.moveFocusBackward();\n      }\n    }\n\n    if (Hotkeys.isExtendForward(event)) {\n      var nextText = value.nextText,\n          _startText = value.startText;\n\n      var isNextInVoid = nextText && document.hasVoidParent(nextText.key, editor);\n\n      if (hasVoidParent || isNextInVoid || _startText.text == '') {\n        event.preventDefault();\n        return editor.moveFocusForward();\n      }\n    }\n\n    next();\n  }\n\n  /**\n   * On mouse down.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onMouseDown(event, editor, next) {\n    debug('onMouseDown', { event: event });\n    isMouseDown = true;\n    next();\n  }\n\n  /**\n   * On mouse up.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onMouseUp(event, editor, next) {\n    debug('onMouseUp', { event: event });\n    isMouseDown = false;\n    next();\n  }\n\n  /**\n   * On paste.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onPaste(event, editor, next) {\n    debug('onPaste', { event: event });\n\n    var value = editor.value;\n\n    var transfer = getEventTransfer(event);\n    var type = transfer.type,\n        fragment = transfer.fragment,\n        text = transfer.text;\n\n\n    if (type == 'fragment') {\n      editor.insertFragment(fragment);\n    }\n\n    if (type == 'text' || type == 'html') {\n      if (!text) return next();\n      var document = value.document,\n          selection = value.selection,\n          startBlock = value.startBlock;\n\n      if (editor.isVoid(startBlock)) return next();\n\n      var defaultBlock = startBlock;\n      var defaultMarks = document.getInsertMarksAtRange(selection);\n      var frag = Plain.deserialize(text, { defaultBlock: defaultBlock, defaultMarks: defaultMarks }).document;\n      editor.insertFragment(frag);\n    }\n\n    next();\n  }\n\n  /**\n   * On select.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onSelect(event, editor, next) {\n    debug('onSelect', { event: event });\n    var window = getWindow(event.target);\n    var selection = window.getSelection();\n    setSelectionFromDOM(window, editor, selection);\n    next();\n  }\n\n  /**\n   * Return the plugin.\n   *\n   * @type {Object}\n   */\n\n  return {\n    onBeforeInput: onBeforeInput,\n    onBlur: onBlur,\n    onClick: onClick,\n    onCopy: onCopy,\n    onCut: onCut,\n    onDragEnd: onDragEnd,\n    onDragStart: onDragStart,\n    onDrop: onDrop,\n    onFocus: onFocus,\n    onInput: onInput,\n    onKeyDown: onKeyDown,\n    onMouseDown: onMouseDown,\n    onMouseUp: onMouseUp,\n    onPaste: onPaste,\n    onSelect: onSelect\n  };\n}\n\n/**\n * Debug.\n *\n * @type {Function}\n */\n\nvar debug$1 = Debug('slate:before');\n\n/**\n * A plugin that adds the \"before\" browser-specific logic to the editor.\n *\n * @return {Object}\n */\n\nfunction BeforePlugin() {\n  var activeElement = null;\n  var compositionCount = 0;\n  var isComposing = false;\n  var isCopying = false;\n  var isDragging = false;\n\n  /**\n   * On before input.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onBeforeInput(event, editor, next) {\n    var isSynthetic = !!event.nativeEvent;\n    if (editor.readOnly) return;\n\n    // COMPAT: If the browser supports Input Events Level 2, we will have\n    // attached a custom handler for the real `beforeinput` events, instead of\n    // allowing React's synthetic polyfill, so we need to ignore synthetics.\n    if (isSynthetic && HAS_INPUT_EVENTS_LEVEL_2) return;\n\n    debug$1('onBeforeInput', { event: event });\n    next();\n  }\n\n  /**\n   * On blur.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onBlur(event, editor, next) {\n    if (isCopying) return;\n    if (editor.readOnly) return;\n\n    var relatedTarget = event.relatedTarget,\n        target = event.target;\n\n    var window = getWindow(target);\n\n    // COMPAT: If the current `activeElement` is still the previous one, this is\n    // due to the window being blurred when the tab itself becomes unfocused, so\n    // we want to abort early to allow to editor to stay focused when the tab\n    // becomes focused again.\n    if (activeElement === window.document.activeElement) return;\n\n    // COMPAT: The `relatedTarget` can be null when the new focus target is not\n    // a \"focusable\" element (eg. a `<div>` without `tabindex` set).\n    if (relatedTarget) {\n      var el = ReactDOM.findDOMNode(editor);\n\n      // COMPAT: The event should be ignored if the focus is returning to the\n      // editor from an embedded editable element (eg. an <input> element inside\n      // a void node).\n      if (relatedTarget === el) return;\n\n      // COMPAT: The event should be ignored if the focus is moving from the\n      // editor to inside a void node's spacer element.\n      if (relatedTarget.hasAttribute('data-slate-spacer')) return;\n\n      // COMPAT: The event should be ignored if the focus is moving to a non-\n      // editable section of an element that isn't a void node (eg. a list item\n      // of the check list example).\n      var node = findNode(relatedTarget, editor);\n      if (el.contains(relatedTarget) && node && !editor.isVoid(node)) return;\n    }\n\n    debug$1('onBlur', { event: event });\n    next();\n  }\n\n  /**\n   * On composition end.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onCompositionEnd(event, editor, next) {\n    var n = compositionCount;\n\n    // The `count` check here ensures that if another composition starts\n    // before the timeout has closed out this one, we will abort unsetting the\n    // `isComposing` flag, since a composition is still in affect.\n    window.requestAnimationFrame(function () {\n      if (compositionCount > n) return;\n      isComposing = false;\n    });\n\n    debug$1('onCompositionEnd', { event: event });\n    next();\n  }\n\n  /**\n   * On click.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onClick(event, editor, next) {\n    debug$1('onClick', { event: event });\n    next();\n  }\n\n  /**\n   * On composition start.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onCompositionStart(event, editor, next) {\n    isComposing = true;\n    compositionCount++;\n\n    var value = editor.value;\n    var selection = value.selection;\n\n\n    if (!selection.isCollapsed) {\n      // https://github.com/ianstormtaylor/slate/issues/1879\n      // When composition starts and the current selection is not collapsed, the\n      // second composition key-down would drop the text wrapping <spans> which\n      // resulted on crash in content.updateSelection after composition ends\n      // (because it cannot find <span> nodes in DOM). This is a workaround that\n      // erases selection as soon as composition starts and preventing <spans>\n      // to be dropped.\n      editor.delete();\n    }\n\n    debug$1('onCompositionStart', { event: event });\n    next();\n  }\n\n  /**\n   * On copy.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onCopy(event, editor, next) {\n    var window = getWindow(event.target);\n    isCopying = true;\n    window.requestAnimationFrame(function () {\n      return isCopying = false;\n    });\n\n    debug$1('onCopy', { event: event });\n    next();\n  }\n\n  /**\n   * On cut.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onCut(event, editor, next) {\n    if (editor.readOnly) return;\n\n    var window = getWindow(event.target);\n    isCopying = true;\n    window.requestAnimationFrame(function () {\n      return isCopying = false;\n    });\n\n    debug$1('onCut', { event: event });\n    next();\n  }\n\n  /**\n   * On drag end.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragEnd(event, editor, next) {\n    isDragging = false;\n    debug$1('onDragEnd', { event: event });\n    next();\n  }\n\n  /**\n   * On drag enter.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragEnter(event, editor, next) {\n    debug$1('onDragEnter', { event: event });\n    next();\n  }\n\n  /**\n   * On drag exit.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragExit(event, editor, next) {\n    debug$1('onDragExit', { event: event });\n    next();\n  }\n\n  /**\n   * On drag leave.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragLeave(event, editor, next) {\n    debug$1('onDragLeave', { event: event });\n    next();\n  }\n\n  /**\n   * On drag over.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragOver(event, editor, next) {\n    // If the target is inside a void node, and only in this case,\n    // call `preventDefault` to signal that drops are allowed.\n    // When the target is editable, dropping is already allowed by\n    // default, and calling `preventDefault` hides the cursor.\n    var node = findNode(event.target, editor);\n    if (editor.isVoid(node)) event.preventDefault();\n\n    // COMPAT: IE won't call onDrop on contentEditables unless the\n    // default dragOver is prevented:\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/913982/\n    // (2018/07/11)\n    if (IS_IE) {\n      event.preventDefault();\n    }\n\n    // If a drag is already in progress, don't do this again.\n    if (!isDragging) {\n      isDragging = true;\n\n      // COMPAT: IE will raise an `unspecified error` if dropEffect is\n      // set. (2018/07/11)\n      if (!IS_IE) {\n        event.nativeEvent.dataTransfer.dropEffect = 'move';\n      }\n    }\n\n    debug$1('onDragOver', { event: event });\n    next();\n  }\n\n  /**\n   * On drag start.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDragStart(event, editor, next) {\n    isDragging = true;\n    debug$1('onDragStart', { event: event });\n    next();\n  }\n\n  /**\n   * On drop.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onDrop(event, editor, next) {\n    if (editor.readOnly) return;\n\n    // Prevent default so the DOM's value isn't corrupted.\n    event.preventDefault();\n\n    debug$1('onDrop', { event: event });\n    next();\n  }\n\n  /**\n   * On focus.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onFocus(event, editor, next) {\n    if (isCopying) return;\n    if (editor.readOnly) return;\n\n    var el = ReactDOM.findDOMNode(editor);\n\n    // Save the new `activeElement`.\n    var window = getWindow(event.target);\n    activeElement = window.document.activeElement;\n\n    // COMPAT: If the editor has nested editable elements, the focus can go to\n    // those elements. In Firefox, this must be prevented because it results in\n    // issues with keyboard navigation. (2017/03/30)\n    if (IS_FIREFOX && event.target != el) {\n      el.focus();\n      return;\n    }\n\n    debug$1('onFocus', { event: event });\n    next();\n  }\n\n  /**\n   * On input.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onInput(event, editor, next) {\n    if (isComposing) return;\n    if (editor.value.selection.isBlurred) return;\n    debug$1('onInput', { event: event });\n    next();\n  }\n\n  /**\n   * On key down.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onKeyDown(event, editor, next) {\n    if (editor.readOnly) return;\n\n    // When composing, we need to prevent all hotkeys from executing while\n    // typing. However, certain characters also move the selection before\n    // we're able to handle it, so prevent their default behavior.\n    if (isComposing) {\n      if (Hotkeys.isCompose(event)) event.preventDefault();\n      return;\n    }\n\n    // Certain hotkeys have native editing behaviors in `contenteditable`\n    // elements which will editor the DOM and cause our value to be out of sync,\n    // so they need to always be prevented.\n    if (!IS_IOS && (Hotkeys.isBold(event) || Hotkeys.isDeleteBackward(event) || Hotkeys.isDeleteForward(event) || Hotkeys.isDeleteLineBackward(event) || Hotkeys.isDeleteLineForward(event) || Hotkeys.isDeleteWordBackward(event) || Hotkeys.isDeleteWordForward(event) || Hotkeys.isItalic(event) || Hotkeys.isRedo(event) || Hotkeys.isSplitBlock(event) || Hotkeys.isTransposeCharacter(event) || Hotkeys.isUndo(event))) {\n      event.preventDefault();\n    }\n\n    debug$1('onKeyDown', { event: event });\n    next();\n  }\n\n  /**\n   * On paste.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onPaste(event, editor, next) {\n    if (editor.readOnly) return;\n\n    // Prevent defaults so the DOM state isn't corrupted.\n    event.preventDefault();\n\n    debug$1('onPaste', { event: event });\n    next();\n  }\n\n  /**\n   * On select.\n   *\n   * @param {Event} event\n   * @param {Editor} editor\n   * @param {Function} next\n   */\n\n  function onSelect(event, editor, next) {\n    if (isCopying) return;\n    if (isComposing) return;\n\n    if (editor.readOnly) return;\n\n    // Save the new `activeElement`.\n    var window = getWindow(event.target);\n    activeElement = window.document.activeElement;\n\n    debug$1('onSelect', { event: event });\n    next();\n  }\n\n  /**\n   * Return the plugin.\n   *\n   * @type {Object}\n   */\n\n  return {\n    onBeforeInput: onBeforeInput,\n    onBlur: onBlur,\n    onClick: onClick,\n    onCompositionEnd: onCompositionEnd,\n    onCompositionStart: onCompositionStart,\n    onCopy: onCopy,\n    onCut: onCut,\n    onDragEnd: onDragEnd,\n    onDragEnter: onDragEnter,\n    onDragExit: onDragExit,\n    onDragLeave: onDragLeave,\n    onDragOver: onDragOver,\n    onDragStart: onDragStart,\n    onDrop: onDrop,\n    onFocus: onFocus,\n    onInput: onInput,\n    onKeyDown: onKeyDown,\n    onPaste: onPaste,\n    onSelect: onSelect\n  };\n}\n\n/**\n * A plugin that adds the browser-specific logic to the editor.\n *\n * @param {Object} options\n * @return {Object}\n */\n\nfunction DOMPlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === undefined ? [] : _options$plugins;\n\n  var beforePlugin = BeforePlugin();\n  var afterPlugin = AfterPlugin();\n  return [beforePlugin].concat(toConsumableArray(plugins), [afterPlugin]);\n}\n\n/**\n * Debugger.\n *\n * @type {Function}\n */\n\nvar debug$2 = Debug('slate:leaves');\n\n/**\n * Leaf.\n *\n * @type {Component}\n */\n\nvar Leaf = function (_React$Component) {\n  inherits(Leaf, _React$Component);\n\n  function Leaf() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    classCallCheck(this, Leaf);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = possibleConstructorReturn(this, (_ref = Leaf.__proto__ || Object.getPrototypeOf(Leaf)).call.apply(_ref, [this].concat(args))), _this), _initialiseProps.call(_this), _temp), possibleConstructorReturn(_this, _ret);\n  }\n  /**\n   * Property types.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Debug.\n   *\n   * @param {String} message\n   * @param {Mixed} ...args\n   */\n\n  createClass(Leaf, [{\n    key: 'shouldComponentUpdate',\n\n\n    /**\n     * Should component update?\n     *\n     * @param {Object} props\n     * @return {Boolean}\n     */\n\n    value: function shouldComponentUpdate(props) {\n      // If any of the regular properties have changed, re-render.\n      if (props.index != this.props.index || props.marks != this.props.marks || props.text != this.props.text || props.parent != this.props.parent) {\n        return true;\n      }\n\n      // Otherwise, don't update.\n      return false;\n    }\n\n    /**\n     * Render the leaf.\n     *\n     * @return {Element}\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      this.debug('render', this);\n\n      var _props = this.props,\n          node = _props.node,\n          index = _props.index;\n\n      var offsetKey = OffsetKey.stringify({\n        key: node.key,\n        index: index\n      });\n\n      return React.createElement(\n        'span',\n        { 'data-slate-leaf': true, 'data-offset-key': offsetKey },\n        this.renderMarks()\n      );\n    }\n\n    /**\n     * Render all of the leaf's mark components.\n     *\n     * @return {Element}\n     */\n\n  }, {\n    key: 'renderMarks',\n    value: function renderMarks() {\n      var _props2 = this.props,\n          marks = _props2.marks,\n          node = _props2.node,\n          offset = _props2.offset,\n          text = _props2.text,\n          editor = _props2.editor;\n\n      var leaf = this.renderText();\n      var attributes = {\n        'data-slate-mark': true\n      };\n\n      return marks.reduce(function (children, mark) {\n        var props = {\n          editor: editor,\n          mark: mark,\n          marks: marks,\n          node: node,\n          offset: offset,\n          text: text,\n          children: children,\n          attributes: attributes\n        };\n        var element = editor.run('renderMark', props);\n        return element || children;\n      }, leaf);\n    }\n\n    /**\n     * Render the text content of the leaf, accounting for browsers.\n     *\n     * @return {Element}\n     */\n\n  }, {\n    key: 'renderText',\n    value: function renderText() {\n      var _props3 = this.props,\n          block = _props3.block,\n          node = _props3.node,\n          editor = _props3.editor,\n          parent = _props3.parent,\n          text = _props3.text,\n          index = _props3.index,\n          leaves = _props3.leaves;\n\n      // COMPAT: Render text inside void nodes with a zero-width space.\n      // So the node can contain selection but the text is not visible.\n\n      if (editor.query('isVoid', parent)) {\n        return React.createElement(\n          'span',\n          { 'data-slate-zero-width': 'z', 'data-slate-length': parent.text.length },\n          '\\uFEFF'\n        );\n      }\n\n      // COMPAT: If this is the last text node in an empty block, render a zero-\n      // width space that will convert into a line break when copying and pasting\n      // to support expected plain text.\n      if (text === '' && parent.object === 'block' && parent.text === '' && parent.nodes.last() === node) {\n        return React.createElement(\n          'span',\n          { 'data-slate-zero-width': 'n', 'data-slate-length': 0 },\n          '\\uFEFF',\n          React.createElement('br', null)\n        );\n      }\n\n      // COMPAT: If the text is empty, it's because it's on the edge of an inline\n      // node, so we render a zero-width space so that the selection can be\n      // inserted next to it still.\n      if (text === '') {\n        return React.createElement(\n          'span',\n          { 'data-slate-zero-width': 'z', 'data-slate-length': 0 },\n          '\\uFEFF'\n        );\n      }\n\n      // COMPAT: Browsers will collapse trailing new lines at the end of blocks,\n      // so we need to add an extra trailing new lines to prevent that.\n      var lastText = block.getLastText();\n      var lastChar = text.charAt(text.length - 1);\n      var isLastText = node === lastText;\n      var isLastLeaf = index === leaves.size - 1;\n      if (isLastText && isLastLeaf && lastChar === '\\n') return React.createElement(\n        'span',\n        { 'data-slate-content': true },\n        text + '\\n'\n      );\n\n      // Otherwise, just return the content.\n      return React.createElement(\n        'span',\n        { 'data-slate-content': true },\n        text\n      );\n    }\n  }]);\n  return Leaf;\n}(React.Component);\n\n/**\n * Export.\n *\n * @type {Component}\n */\n\nLeaf.propTypes = {\n  block: SlateTypes.block.isRequired,\n  editor: Types.object.isRequired,\n  index: Types.number.isRequired,\n  leaves: SlateTypes.leaves.isRequired,\n  marks: SlateTypes.marks.isRequired,\n  node: SlateTypes.node.isRequired,\n  offset: Types.number.isRequired,\n  parent: SlateTypes.node.isRequired,\n  text: Types.string.isRequired };\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.debug = function (message) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    debug$2.apply(undefined, [message, _this2.props.node.key + '-' + _this2.props.index].concat(args));\n  };\n};\n\n/**\n * Debug.\n *\n * @type {Function}\n */\n\nvar debug$3 = Debug('slate:node');\n\n/**\n * Text.\n *\n * @type {Component}\n */\n\nvar Text = function (_React$Component) {\n  inherits(Text, _React$Component);\n\n  function Text() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    classCallCheck(this, Text);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = possibleConstructorReturn(this, (_ref = Text.__proto__ || Object.getPrototypeOf(Text)).call.apply(_ref, [this].concat(args))), _this), _initialiseProps$1.call(_this), _temp), possibleConstructorReturn(_this, _ret);\n  }\n  /**\n   * Property types.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Default prop types.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Debug.\n   *\n   * @param {String} message\n   * @param {Mixed} ...args\n   */\n\n  /**\n   * Should the node update?\n   *\n   * @param {Object} nextProps\n   * @param {Object} value\n   * @return {Boolean}\n   */\n\n  createClass(Text, [{\n    key: 'render',\n\n\n    /**\n     * Render.\n     *\n     * @return {Element}\n     */\n\n    value: function render() {\n      var _this2 = this;\n\n      this.debug('render', this);\n\n      var _props = this.props,\n          decorations = _props.decorations,\n          editor = _props.editor,\n          node = _props.node,\n          style = _props.style;\n      var value = editor.value;\n      var document = value.document;\n      var key = node.key;\n\n\n      var decs = decorations.filter(function (d) {\n        var start = d.start,\n            end = d.end;\n\n        // If either of the decoration's keys match, include it.\n\n        if (start.key === key || end.key === key) return true;\n\n        // Otherwise, if the decoration is in a single node, it's not ours.\n        if (start.key === end.key) return false;\n\n        // If the node's path is before the start path, ignore it.\n        var path = document.assertPath(key);\n        if (PathUtils.compare(path, start.path) === -1) return false;\n\n        // If the node's path is after the end path, ignore it.\n        if (PathUtils.compare(path, end.path) === 1) return false;\n\n        // Otherwise, include it.\n        return true;\n      });\n\n      // PERF: Take advantage of cache by avoiding arguments\n      var leaves = decs.size === 0 ? node.getLeaves() : node.getLeaves(decs);\n      var offset = 0;\n\n      var children = leaves.map(function (leaf, i) {\n        var child = _this2.renderLeaf(leaves, leaf, i, offset);\n        offset += leaf.text.length;\n        return child;\n      });\n\n      return React.createElement(\n        'span',\n        { 'data-key': key, style: style },\n        children\n      );\n    }\n\n    /**\n     * Render a single leaf given a `leaf` and `offset`.\n     *\n     * @param {List<Leaf>} leaves\n     * @param {Leaf} leaf\n     * @param {Number} index\n     * @param {Number} offset\n     * @return {Element} leaf\n     */\n\n  }]);\n  return Text;\n}(React.Component);\n\n/**\n * Export.\n *\n * @type {Component}\n */\n\nText.propTypes = {\n  block: SlateTypes.block,\n  decorations: ImmutableTypes.list.isRequired,\n  editor: Types.object.isRequired,\n  node: SlateTypes.node.isRequired,\n  parent: SlateTypes.node.isRequired,\n  style: Types.object };\nText.defaultProps = {\n  style: null };\n\nvar _initialiseProps$1 = function _initialiseProps() {\n  var _this3 = this;\n\n  this.debug = function (message) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    var node = _this3.props.node;\n    var key = node.key;\n\n    debug$3.apply(undefined, [message, key + ' (text)'].concat(args));\n  };\n\n  this.shouldComponentUpdate = function (nextProps) {\n    var props = _this3.props;\n\n    var n = nextProps;\n    var p = props;\n\n    // If the node has changed, update. PERF: There are cases where it will have\n    // changed, but it's properties will be exactly the same (eg. copy-paste)\n    // which this won't catch. But that's rare and not a drag on performance, so\n    // for simplicity we just let them through.\n    if (n.node != p.node) return true;\n\n    // If the node parent is a block node, and it was the last child of the\n    // block, re-render to cleanup extra `\\n`.\n    if (n.parent.object == 'block') {\n      var pLast = p.parent.nodes.last();\n      var nLast = n.parent.nodes.last();\n      if (p.node == pLast && n.node != nLast) return true;\n    }\n\n    // Re-render if the current decorations have changed.\n    if (!n.decorations.equals(p.decorations)) return true;\n\n    // Otherwise, don't update.\n    return false;\n  };\n\n  this.renderLeaf = function (leaves, leaf, index, offset) {\n    var _props2 = _this3.props,\n        block = _props2.block,\n        node = _props2.node,\n        parent = _props2.parent,\n        editor = _props2.editor;\n    var text = leaf.text,\n        marks = leaf.marks;\n\n\n    return React.createElement(Leaf, {\n      key: node.key + '-' + index,\n      block: block,\n      editor: editor,\n      index: index,\n      marks: marks,\n      node: node,\n      offset: offset,\n      parent: parent,\n      leaves: leaves,\n      text: text\n    });\n  };\n};\n\n/**\n * Debug.\n *\n * @type {Function}\n */\n\nvar debug$4 = Debug('slate:void');\n\n/**\n * Void.\n *\n * @type {Component}\n */\n\nvar Void = function (_React$Component) {\n  inherits(Void, _React$Component);\n\n  function Void() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    classCallCheck(this, Void);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = possibleConstructorReturn(this, (_ref = Void.__proto__ || Object.getPrototypeOf(Void)).call.apply(_ref, [this].concat(args))), _this), _initialiseProps$2.call(_this), _temp), possibleConstructorReturn(_this, _ret);\n  }\n  /**\n   * Property types.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Debug.\n   *\n   * @param {String} message\n   * @param {Mixed} ...args\n   */\n\n  createClass(Void, [{\n    key: 'render',\n\n\n    /**\n     * Render.\n     *\n     * @return {Element}\n     */\n\n    value: function render() {\n      var props = this.props;\n      var children = props.children,\n          node = props.node,\n          readOnly = props.readOnly;\n\n      var Tag = node.object == 'block' ? 'div' : 'span';\n      var style = {\n        height: '0',\n        color: 'transparent',\n        outline: 'none',\n        position: 'absolute'\n      };\n\n      var spacer = React.createElement(\n        Tag,\n        { 'data-slate-spacer': true, style: style },\n        this.renderText()\n      );\n\n      var content = React.createElement(\n        Tag,\n        { contentEditable: readOnly ? null : false },\n        children\n      );\n\n      this.debug('render', { props: props });\n\n      return React.createElement(\n        Tag,\n        {\n          'data-slate-void': true,\n          'data-key': node.key,\n          contentEditable: readOnly || node.object == 'block' ? null : false\n        },\n        readOnly ? null : spacer,\n        content\n      );\n    }\n\n    /**\n     * Render the void node's text node, which will catch the cursor when it the\n     * void node is navigated to with the arrow keys.\n     *\n     * Having this text node there means the browser continues to manage the\n     * selection natively, so it keeps track of the right offset when moving\n     * across the block.\n     *\n     * @return {Element}\n     */\n\n  }]);\n  return Void;\n}(React.Component);\n\n/**\n * Export.\n *\n * @type {Component}\n */\n\nVoid.propTypes = {\n  block: SlateTypes.block,\n  children: Types.any.isRequired,\n  editor: Types.object.isRequired,\n  node: SlateTypes.node.isRequired,\n  parent: SlateTypes.node.isRequired,\n  readOnly: Types.bool.isRequired };\n\nvar _initialiseProps$2 = function _initialiseProps() {\n  var _this2 = this;\n\n  this.debug = function (message) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    var node = _this2.props.node;\n    var key = node.key,\n        type = node.type;\n\n    var id = key + ' (' + type + ')';\n    debug$4.apply(undefined, [message, '' + id].concat(args));\n  };\n\n  this.renderText = function () {\n    var _props = _this2.props,\n        block = _props.block,\n        decorations = _props.decorations,\n        node = _props.node,\n        readOnly = _props.readOnly,\n        editor = _props.editor;\n\n    var child = node.getFirstText();\n    return React.createElement(Text, {\n      block: node.object == 'block' ? node : block,\n      decorations: decorations,\n      editor: editor,\n      key: child.key,\n      node: child,\n      parent: node,\n      readOnly: readOnly\n    });\n  };\n};\n\n/**\n * Split the decorations in lists of relevant decorations for each child.\n *\n * @param {Node} node\n * @param {List} decorations\n * @return {Array<List<Decoration>>}\n */\n\nfunction getChildrenDecorations(node, decorations) {\n  var activeDecorations = Set().asMutable();\n  var childrenDecorations = [];\n\n  orderChildDecorations(node, decorations).forEach(function (item) {\n    if (item.isRangeStart) {\n      // Item is a decoration start\n      activeDecorations.add(item.decoration);\n    } else if (item.isRangeEnd) {\n      // item is a decoration end\n      activeDecorations.remove(item.decoration);\n    } else {\n      // Item is a child node\n      childrenDecorations.push(activeDecorations.toList());\n    }\n  });\n\n  return childrenDecorations;\n}\n\n/**\n * Orders the children of provided node and its decoration endpoints (start, end)\n * so that decorations can be passed only to relevant children (see use in Node.render())\n *\n * @param {Node} node\n * @param {List} decorations\n * @return {Array<Item>}\n *\n * where type Item =\n * {\n *   child: Node,\n *   // Index of the child in its parent\n *   index: number\n * }\n * or {\n *   // True if this represents the start of the given decoration\n *   isRangeStart: boolean,\n *   // True if this represents the end of the given decoration\n *   isRangeEnd: boolean,\n *   decoration: Range\n * }\n */\n\nfunction orderChildDecorations(node, decorations) {\n  if (decorations.isEmpty()) {\n    return node.nodes.toArray().map(function (child, index) {\n      return {\n        child: child,\n        index: index\n      };\n    });\n  }\n\n  // Map each key to its global order\n  var keyOrders = defineProperty({}, node.key, 0);\n  var globalOrder = 1;\n\n  node.forEachDescendant(function (child) {\n    keyOrders[child.key] = globalOrder;\n    globalOrder = globalOrder + 1;\n  });\n\n  var childNodes = node.nodes.toArray();\n\n  var endPoints = childNodes.map(function (child, index) {\n    return {\n      child: child,\n      index: index,\n      order: keyOrders[child.key]\n    };\n  });\n\n  decorations.forEach(function (decoration) {\n    // Range start.\n    // A rangeStart should be before the child containing its startKey, in order\n    // to consider it active before going down the child.\n    var startKeyOrder = keyOrders[decoration.start.key];\n    var containingChildOrder = startKeyOrder === undefined ? 0 : getContainingChildOrder(childNodes, keyOrders, startKeyOrder);\n\n    endPoints.push({\n      isRangeStart: true,\n      order: containingChildOrder - 0.5,\n      decoration: decoration\n    });\n\n    // Range end.\n    var endKeyOrder = (keyOrders[decoration.end.key] || globalOrder) + 0.5;\n\n    endPoints.push({\n      isRangeEnd: true,\n      order: endKeyOrder,\n      decoration: decoration\n    });\n  });\n\n  return endPoints.sort(function (a, b) {\n    return a.order > b.order ? 1 : -1;\n  });\n}\n\n/*\n * Returns the key order of the child right before the given order.\n */\n\nfunction getContainingChildOrder(children, keyOrders, order) {\n  // Find the first child that is after the given key\n  var nextChildIndex = children.findIndex(function (child) {\n    return order < keyOrders[child.key];\n  });\n\n  if (nextChildIndex <= 0) {\n    return 0;\n  }\n\n  var containingChild = children[nextChildIndex - 1];\n  return keyOrders[containingChild.key];\n}\n\n/**\n * Debug.\n *\n * @type {Function}\n */\n\nvar debug$5 = Debug('slate:node');\n\n/**\n * Node.\n *\n * @type {Component}\n */\n\nvar Node$1 = function (_React$Component) {\n  inherits(Node$$1, _React$Component);\n\n  function Node$$1() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    classCallCheck(this, Node$$1);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = possibleConstructorReturn(this, (_ref = Node$$1.__proto__ || Object.getPrototypeOf(Node$$1)).call.apply(_ref, [this].concat(args))), _this), _initialiseProps$3.call(_this), _temp), possibleConstructorReturn(_this, _ret);\n  }\n  /**\n   * Property types.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Debug.\n   *\n   * @param {String} message\n   * @param {Mixed} ...args\n   */\n\n  createClass(Node$$1, [{\n    key: 'shouldComponentUpdate',\n\n\n    /**\n     * Should the node update?\n     *\n     * @param {Object} nextProps\n     * @param {Object} value\n     * @return {Boolean}\n     */\n\n    value: function shouldComponentUpdate(nextProps) {\n      var props = this.props;\n      var editor = props.editor;\n\n      var shouldUpdate = editor.run('shouldNodeComponentUpdate', props, nextProps);\n      var n = nextProps;\n      var p = props;\n\n      // If the `Component` has a custom logic to determine whether the component\n      // needs to be updated or not, return true if it returns true. If it returns\n      // false, we need to ignore it, because it shouldn't be allowed it.\n      if (shouldUpdate != null) {\n        if (shouldUpdate) {\n          return true;\n        }\n\n        warning(shouldUpdate !== false, \"Returning false in `shouldNodeComponentUpdate` does not disable Slate's internal `shouldComponentUpdate` logic. If you want to prevent updates, use React's `shouldComponentUpdate` instead.\");\n      }\n\n      // If the `readOnly` status has changed, re-render in case there is any\n      // user-land logic that depends on it, like nested editable contents.\n      if (n.readOnly != p.readOnly) return true;\n\n      // If the node has changed, update. PERF: There are cases where it will have\n      // changed, but it's properties will be exactly the same (eg. copy-paste)\n      // which this won't catch. But that's rare and not a drag on performance, so\n      // for simplicity we just let them through.\n      if (n.node != p.node) return true;\n\n      // If the selection value of the node or of some of its children has changed,\n      // re-render in case there is any user-land logic depends on it to render.\n      // if the node is selected update it, even if it was already selected: the\n      // selection value of some of its children could have been changed and they\n      // need to be rendered again.\n      if (n.isSelected || p.isSelected) return true;\n      if (n.isFocused || p.isFocused) return true;\n\n      // If the decorations have changed, update.\n      if (!n.decorations.equals(p.decorations)) return true;\n\n      // Otherwise, don't update.\n      return false;\n    }\n\n    /**\n     * Render.\n     *\n     * @return {Element}\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      this.debug('render', this);\n      var _props = this.props,\n          editor = _props.editor,\n          isSelected = _props.isSelected,\n          isFocused = _props.isFocused,\n          node = _props.node,\n          decorations = _props.decorations,\n          parent = _props.parent,\n          readOnly = _props.readOnly;\n      var value = editor.value;\n      var selection = value.selection;\n\n      var indexes = node.getSelectionIndexes(selection, isSelected);\n      var decs = decorations.concat(node.getDecorations(editor));\n      var childrenDecorations = getChildrenDecorations(node, decs);\n      var children = [];\n\n      node.nodes.forEach(function (child, i) {\n        var isChildSelected = !!indexes && indexes.start <= i && i < indexes.end;\n\n        children.push(_this2.renderNode(child, isChildSelected, childrenDecorations[i]));\n      });\n\n      // Attributes that the developer must mix into the element in their\n      // custom node renderer component.\n      var attributes = { 'data-key': node.key\n\n        // If it's a block node with inline children, add the proper `dir` attribute\n        // for text direction.\n      };if (node.isLeafBlock()) {\n        var direction = node.getTextDirection();\n        if (direction == 'rtl') attributes.dir = 'rtl';\n      }\n\n      var props = {\n        key: node.key,\n        editor: editor,\n        isFocused: isFocused,\n        isSelected: isSelected,\n        node: node,\n        parent: parent,\n        readOnly: readOnly\n      };\n\n      var element = editor.run('renderNode', _extends({}, props, {\n        attributes: attributes,\n        children: children\n      }));\n\n      return editor.query('isVoid', node) ? React.createElement(\n        Void,\n        this.props,\n        element\n      ) : element;\n    }\n\n    /**\n     * Render a `child` node.\n     *\n     * @param {Node} child\n     * @param {Boolean} isSelected\n     * @param {Array<Decoration>} decorations\n     * @return {Element}\n     */\n\n  }]);\n  return Node$$1;\n}(React.Component);\n\n/**\n * Export.\n *\n * @type {Component}\n */\n\nNode$1.propTypes = {\n  block: SlateTypes.block,\n  decorations: ImmutableTypes.list.isRequired,\n  editor: Types.object.isRequired,\n  isFocused: Types.bool.isRequired,\n  isSelected: Types.bool.isRequired,\n  node: SlateTypes.node.isRequired,\n  parent: SlateTypes.node.isRequired,\n  readOnly: Types.bool.isRequired };\n\nvar _initialiseProps$3 = function _initialiseProps() {\n  var _this3 = this;\n\n  this.debug = function (message) {\n    for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    var node = _this3.props.node;\n    var key = node.key,\n        type = node.type;\n\n    debug$5.apply(undefined, [message, key + ' (' + type + ')'].concat(args));\n  };\n\n  this.renderNode = function (child, isSelected, decorations) {\n    var _props2 = _this3.props,\n        block = _props2.block,\n        editor = _props2.editor,\n        node = _props2.node,\n        readOnly = _props2.readOnly,\n        isFocused = _props2.isFocused;\n\n    var Component = child.object == 'text' ? Text : Node$1;\n\n    return React.createElement(Component, {\n      block: node.object == 'block' ? node : block,\n      decorations: decorations,\n      editor: editor,\n      isSelected: isSelected,\n      isFocused: isFocused && isSelected,\n      key: child.key,\n      node: child,\n      parent: node,\n      readOnly: readOnly\n    });\n  };\n};\n\n/**\n * Find a native DOM range Slate `range`.\n *\n * @param {Range} range\n * @param {Window} win (optional)\n * @return {Object|Null}\n */\n\nfunction findDOMRange(range) {\n  var win = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n  var anchor = range.anchor,\n      focus = range.focus,\n      isBackward$$1 = range.isBackward,\n      isCollapsed = range.isCollapsed;\n\n  var domAnchor = findDOMPoint(anchor, win);\n  var domFocus = isCollapsed ? domAnchor : findDOMPoint(focus, win);\n\n  if (!domAnchor || !domFocus) return null;\n\n  var r = win.document.createRange();\n  var start = isBackward$$1 ? domFocus : domAnchor;\n  var end = isBackward$$1 ? domAnchor : domFocus;\n  r.setStart(start.node, start.offset);\n  r.setEnd(end.node, end.offset);\n  return r;\n}\n\n/**\n * CSS overflow values that would cause scrolling.\n *\n * @type {Array}\n */\n\nvar OVERFLOWS = ['auto', 'overlay', 'scroll'];\n\n/**\n * Detect whether we are running IOS version 11\n */\n\nvar IS_IOS_11 = IS_IOS && !!window.navigator.userAgent.match(/os 11_/i);\n\n/**\n * Find the nearest parent with scrolling, or window.\n *\n * @param {el} Element\n */\n\nfunction findScrollContainer(el, window) {\n  var parent = el.parentNode;\n  var scroller = void 0;\n\n  while (!scroller) {\n    if (!parent.parentNode) break;\n\n    var style = window.getComputedStyle(parent);\n    var overflowY = style.overflowY;\n\n\n    if (OVERFLOWS.includes(overflowY)) {\n      scroller = parent;\n      break;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  // COMPAT: Because Chrome does not allow doucment.body.scrollTop, we're\n  // assuming that window.scrollTo() should be used if the scrollable element\n  // turns out to be document.body or document.documentElement. This will work\n  // unless body is intentionally set to scrollable by restricting its height\n  // (e.g. height: 100vh).\n  if (!scroller) {\n    return window.document.body;\n  }\n\n  return scroller;\n}\n\n/**\n * Scroll the current selection's focus point into view if needed.\n *\n * @param {Selection} selection\n */\n\nfunction scrollToSelection(selection) {\n  if (IS_IOS_11) return;\n  if (!selection.anchorNode) return;\n\n  var window = getWindow(selection.anchorNode);\n  var scroller = findScrollContainer(selection.anchorNode, window);\n  var isWindow = scroller == window.document.body || scroller == window.document.documentElement;\n  var backward = isBackward(selection);\n\n  var range = selection.getRangeAt(0).cloneRange();\n  range.collapse(backward);\n  var cursorRect = range.getBoundingClientRect();\n\n  // COMPAT: range.getBoundingClientRect() returns 0s in Safari when range is\n  // collapsed. Expanding the range by 1 is a relatively effective workaround\n  // for vertical scroll, although horizontal may be off by 1 character.\n  // https://bugs.webkit.org/show_bug.cgi?id=138949\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=435438\n  if (IS_SAFARI) {\n    if (range.collapsed && cursorRect.top == 0 && cursorRect.height == 0) {\n      if (range.startOffset == 0) {\n        range.setEnd(range.endContainer, 1);\n      } else {\n        range.setStart(range.startContainer, range.startOffset - 1);\n      }\n\n      cursorRect = range.getBoundingClientRect();\n\n      if (cursorRect.top == 0 && cursorRect.height == 0) {\n        if (range.getClientRects().length) {\n          cursorRect = range.getClientRects()[0];\n        }\n      }\n    }\n  }\n\n  var width = void 0;\n  var height = void 0;\n  var yOffset = void 0;\n  var xOffset = void 0;\n  var scrollerTop = 0;\n  var scrollerLeft = 0;\n  var scrollerBordersY = 0;\n  var scrollerBordersX = 0;\n  var scrollerPaddingTop = 0;\n  var scrollerPaddingBottom = 0;\n  var scrollerPaddingLeft = 0;\n  var scrollerPaddingRight = 0;\n\n  if (isWindow) {\n    var innerWidth = window.innerWidth,\n        innerHeight = window.innerHeight,\n        pageYOffset = window.pageYOffset,\n        pageXOffset = window.pageXOffset;\n\n    width = innerWidth;\n    height = innerHeight;\n    yOffset = pageYOffset;\n    xOffset = pageXOffset;\n  } else {\n    var offsetWidth = scroller.offsetWidth,\n        offsetHeight = scroller.offsetHeight,\n        scrollTop = scroller.scrollTop,\n        scrollLeft = scroller.scrollLeft;\n\n    var _window$getComputedSt = window.getComputedStyle(scroller),\n        borderTopWidth = _window$getComputedSt.borderTopWidth,\n        borderBottomWidth = _window$getComputedSt.borderBottomWidth,\n        borderLeftWidth = _window$getComputedSt.borderLeftWidth,\n        borderRightWidth = _window$getComputedSt.borderRightWidth,\n        paddingTop = _window$getComputedSt.paddingTop,\n        paddingBottom = _window$getComputedSt.paddingBottom,\n        paddingLeft = _window$getComputedSt.paddingLeft,\n        paddingRight = _window$getComputedSt.paddingRight;\n\n    var scrollerRect = scroller.getBoundingClientRect();\n    width = offsetWidth;\n    height = offsetHeight;\n    scrollerTop = scrollerRect.top + parseInt(borderTopWidth, 10);\n    scrollerLeft = scrollerRect.left + parseInt(borderLeftWidth, 10);\n\n    scrollerBordersY = parseInt(borderTopWidth, 10) + parseInt(borderBottomWidth, 10);\n\n    scrollerBordersX = parseInt(borderLeftWidth, 10) + parseInt(borderRightWidth, 10);\n\n    scrollerPaddingTop = parseInt(paddingTop, 10);\n    scrollerPaddingBottom = parseInt(paddingBottom, 10);\n    scrollerPaddingLeft = parseInt(paddingLeft, 10);\n    scrollerPaddingRight = parseInt(paddingRight, 10);\n    yOffset = scrollTop;\n    xOffset = scrollLeft;\n  }\n\n  var cursorTop = cursorRect.top + yOffset - scrollerTop;\n  var cursorLeft = cursorRect.left + xOffset - scrollerLeft;\n\n  var x = xOffset;\n  var y = yOffset;\n\n  if (cursorLeft < xOffset) {\n    // selection to the left of viewport\n    x = cursorLeft - scrollerPaddingLeft;\n  } else if (cursorLeft + cursorRect.width + scrollerBordersX > xOffset + width) {\n    // selection to the right of viewport\n    x = cursorLeft + scrollerBordersX + scrollerPaddingRight - width;\n  }\n\n  if (cursorTop < yOffset) {\n    // selection above viewport\n    y = cursorTop - scrollerPaddingTop;\n  } else if (cursorTop + cursorRect.height + scrollerBordersY > yOffset + height) {\n    // selection below viewport\n    y = cursorTop + scrollerBordersY + scrollerPaddingBottom + cursorRect.height - height;\n  }\n\n  if (isWindow) {\n    window.scrollTo(x, y);\n  } else {\n    scroller.scrollTop = y;\n    scroller.scrollLeft = x;\n  }\n}\n\nvar FIREFOX_NODE_TYPE_ACCESS_ERROR = /Permission denied to access property \"nodeType\"/;\n\n/**\n * Debug.\n *\n * @type {Function}\n */\n\nvar debug$6 = Debug('slate:content');\n\n/**\n * Content.\n *\n * @type {Component}\n */\n\nvar Content = function (_React$Component) {\n  inherits(Content, _React$Component);\n\n  function Content() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    classCallCheck(this, Content);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = possibleConstructorReturn(this, (_ref = Content.__proto__ || Object.getPrototypeOf(Content)).call.apply(_ref, [this].concat(args))), _this), _this.tmp = {\n      isUpdatingSelection: false\n\n      /**\n       * Create a set of bound event handlers.\n       *\n       * @type {Object}\n       */\n\n    }, _this.handlers = EVENT_HANDLERS.reduce(function (obj, handler) {\n      obj[handler] = function (event) {\n        return _this.onEvent(handler, event);\n      };\n      return obj;\n    }, {}), _this.updateSelection = function () {\n      var editor = _this.props.editor;\n      var value = editor.value;\n      var selection = value.selection;\n      var isBackward$$1 = selection.isBackward;\n\n      var window = getWindow(_this.element);\n      var native = window.getSelection();\n      var activeElement = window.document.activeElement;\n\n      // COMPAT: In Firefox, there's a but where `getSelection` can return `null`.\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=827585 (2018/11/07)\n\n      if (!native) {\n        return;\n      }\n\n      var rangeCount = native.rangeCount,\n          anchorNode = native.anchorNode;\n\n      var updated = false;\n\n      // If the Slate selection is blurred, but the DOM's active element is still\n      // the editor, we need to blur it.\n      if (selection.isBlurred && activeElement === _this.element) {\n        _this.element.blur();\n        updated = true;\n      }\n\n      // If the Slate selection is unset, but the DOM selection has a range\n      // selected in the editor, we need to remove the range.\n      if (selection.isUnset && rangeCount && _this.isInEditor(anchorNode)) {\n        removeAllRanges(native);\n        updated = true;\n      }\n\n      // If the Slate selection is focused, but the DOM's active element is not\n      // the editor, we need to focus it. We prevent scrolling because we handle\n      // scrolling to the correct selection.\n      if (selection.isFocused && activeElement !== _this.element) {\n        _this.element.focus({ preventScroll: true });\n        updated = true;\n      }\n\n      // Otherwise, figure out which DOM nodes should be selected...\n      if (selection.isFocused && selection.isSet) {\n        var current = !!rangeCount && native.getRangeAt(0);\n        var range = findDOMRange(selection, window);\n\n        if (!range) {\n          warning(false, 'Unable to find a native DOM range from the current selection.');\n\n          return;\n        }\n\n        var startContainer = range.startContainer,\n            startOffset = range.startOffset,\n            endContainer = range.endContainer,\n            endOffset = range.endOffset;\n\n        // If the new range matches the current selection, there is nothing to fix.\n        // COMPAT: The native `Range` object always has it's \"start\" first and \"end\"\n        // last in the DOM. It has no concept of \"backwards/forwards\", so we have\n        // to check both orientations here. (2017/10/31)\n\n        if (current) {\n          if (startContainer == current.startContainer && startOffset == current.startOffset && endContainer == current.endContainer && endOffset == current.endOffset || startContainer == current.endContainer && startOffset == current.endOffset && endContainer == current.startContainer && endOffset == current.startOffset) {\n            return;\n          }\n        }\n\n        // Otherwise, set the `isUpdatingSelection` flag and update the selection.\n        updated = true;\n        _this.tmp.isUpdatingSelection = true;\n        removeAllRanges(native);\n\n        // COMPAT: IE 11 does not support `setBaseAndExtent`. (2018/11/07)\n        if (native.setBaseAndExtent) {\n          // COMPAT: Since the DOM range has no concept of backwards/forwards\n          // we need to check and do the right thing here.\n          if (isBackward$$1) {\n            native.setBaseAndExtent(range.endContainer, range.endOffset, range.startContainer, range.startOffset);\n          } else {\n            native.setBaseAndExtent(range.startContainer, range.startOffset, range.endContainer, range.endOffset);\n          }\n        } else {\n          native.addRange(range);\n        }\n\n        // Scroll to the selection, in case it's out of view.\n        scrollToSelection(native);\n\n        // Then unset the `isUpdatingSelection` flag after a delay, to ensure that\n        // it is still set when selection-related events from updating it fire.\n        setTimeout(function () {\n          // COMPAT: In Firefox, it's not enough to create a range, you also need\n          // to focus the contenteditable element too. (2016/11/16)\n          if (IS_FIREFOX && _this.element) {\n            _this.element.focus();\n          }\n\n          _this.tmp.isUpdatingSelection = false;\n        });\n      }\n\n      if (updated) {\n        debug$6('updateSelection', { selection: selection, native: native, activeElement: activeElement });\n      }\n    }, _this.ref = function (element) {\n      _this.element = element;\n    }, _this.isInEditor = function (target) {\n      var _this2 = _this,\n          element = _this2.element;\n\n\n      var el = void 0;\n\n      try {\n        // COMPAT: In Firefox, sometimes the node can be comment which doesn't\n        // have .closest and it crashes.\n        if (target.nodeType === 8) {\n          return false;\n        }\n\n        // COMPAT: Text nodes don't have `isContentEditable` property. So, when\n        // `target` is a text node use its parent node for check.\n        el = target.nodeType === 3 ? target.parentNode : target;\n      } catch (err) {\n        // COMPAT: In Firefox, `target.nodeType` will throw an error if target is\n        // originating from an internal \"restricted\" element (e.g. a stepper\n        // arrow on a number input)\n        // see github.com/ianstormtaylor/slate/issues/1819\n        if (IS_FIREFOX && FIREFOX_NODE_TYPE_ACCESS_ERROR.test(err.message)) {\n          return false;\n        }\n\n        throw err;\n      }\n\n      return el.isContentEditable && (el === element || el.closest('[data-slate-editor]') === element);\n    }, _this.onNativeSelectionChange = throttle(function (event) {\n      if (_this.props.readOnly) return;\n\n      var window = getWindow(event.target);\n      var activeElement = window.document.activeElement;\n\n      if (activeElement !== _this.element) return;\n\n      _this.props.onEvent('onSelect', event);\n    }, 100), _this.renderNode = function (child, isSelected, decorations) {\n      var _this$props = _this.props,\n          editor = _this$props.editor,\n          readOnly = _this$props.readOnly;\n      var value = editor.value;\n      var document = value.document,\n          selection = value.selection;\n      var isFocused = selection.isFocused;\n\n\n      return React.createElement(Node$1, {\n        block: null,\n        editor: editor,\n        decorations: decorations,\n        isSelected: isSelected,\n        isFocused: isFocused && isSelected,\n        key: child.key,\n        node: child,\n        parent: document,\n        readOnly: readOnly\n      });\n    }, _temp), possibleConstructorReturn(_this, _ret);\n  }\n  /**\n   * Property types.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Default properties.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Temporary values.\n   *\n   * @type {Object}\n   */\n\n  createClass(Content, [{\n    key: 'componentDidMount',\n\n\n    /**\n     * When the editor first mounts in the DOM we need to:\n     *\n     *   - Add native DOM event listeners.\n     *   - Update the selection, in case it starts focused.\n     */\n\n    value: function componentDidMount() {\n      var window = getWindow(this.element);\n\n      window.document.addEventListener('selectionchange', this.onNativeSelectionChange);\n\n      // COMPAT: Restrict scope of `beforeinput` to clients that support the\n      // Input Events Level 2 spec, since they are preventable events.\n      if (HAS_INPUT_EVENTS_LEVEL_2) {\n        this.element.addEventListener('beforeinput', this.handlers.onBeforeInput);\n      }\n\n      this.updateSelection();\n    }\n\n    /**\n     * When unmounting, remove DOM event listeners.\n     */\n\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      var window = getWindow(this.element);\n\n      if (window) {\n        window.document.removeEventListener('selectionchange', this.onNativeSelectionChange);\n      }\n\n      if (HAS_INPUT_EVENTS_LEVEL_2) {\n        this.element.removeEventListener('beforeinput', this.handlers.onBeforeInput);\n      }\n    }\n\n    /**\n     * On update, update the selection.\n     */\n\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this.updateSelection();\n    }\n\n    /**\n     * Update the native DOM selection to reflect the internal model.\n     */\n\n    /**\n     * The React ref method to set the root content element locally.\n     *\n     * @param {Element} element\n     */\n\n    /**\n     * Check if an event `target` is fired from within the contenteditable\n     * element. This should be false for edits happening in non-contenteditable\n     * children, such as void nodes and other nested Slate editors.\n     *\n     * @param {Element} target\n     * @return {Boolean}\n     */\n\n  }, {\n    key: 'onEvent',\n\n\n    /**\n     * On `event` with `handler`.\n     *\n     * @param {String} handler\n     * @param {Event} event\n     */\n\n    value: function onEvent(handler, event) {\n      debug$6('onEvent', handler);\n\n      // Ignore `onBlur`, `onFocus` and `onSelect` events generated\n      // programmatically while updating selection.\n      if (this.tmp.isUpdatingSelection && (handler == 'onSelect' || handler == 'onBlur' || handler == 'onFocus')) {\n        return;\n      }\n\n      // COMPAT: There are situations where a select event will fire with a new\n      // native selection that resolves to the same internal position. In those\n      // cases we don't need to trigger any changes, since our internal model is\n      // already up to date, but we do want to update the native selection again\n      // to make sure it is in sync. (2017/10/16)\n      if (handler == 'onSelect') {\n        var editor = this.props.editor;\n        var value = editor.value;\n        var selection = value.selection;\n\n        var window = getWindow(event.target);\n        var native = window.getSelection();\n        var range = findRange(native, editor);\n\n        if (range && range.equals(selection.toRange())) {\n          this.updateSelection();\n          return;\n        }\n      }\n\n      // Don't handle drag and drop events coming from embedded editors.\n      if (handler == 'onDragEnd' || handler == 'onDragEnter' || handler == 'onDragExit' || handler == 'onDragLeave' || handler == 'onDragOver' || handler == 'onDragStart' || handler == 'onDrop') {\n        var closest = event.target.closest('[data-slate-editor]');\n\n        if (closest !== this.element) {\n          return;\n        }\n      }\n\n      // Some events require being in editable in the editor, so if the event\n      // target isn't, ignore them.\n      if (handler == 'onBeforeInput' || handler == 'onBlur' || handler == 'onCompositionEnd' || handler == 'onCompositionStart' || handler == 'onCopy' || handler == 'onCut' || handler == 'onFocus' || handler == 'onInput' || handler == 'onKeyDown' || handler == 'onKeyUp' || handler == 'onPaste' || handler == 'onSelect') {\n        if (!this.isInEditor(event.target)) {\n          return;\n        }\n      }\n\n      this.props.onEvent(handler, event);\n    }\n\n    /**\n     * On native `selectionchange` event, trigger the `onSelect` handler. This is\n     * needed to account for React's `onSelect` being non-standard and not firing\n     * until after a selection has been released. This causes issues in situations\n     * where another change happens while a selection is being made.\n     *\n     * @param {Event} event\n     */\n\n  }, {\n    key: 'render',\n\n\n    /**\n     * Render the editor content.\n     *\n     * @return {Element}\n     */\n\n    value: function render() {\n      var _this3 = this;\n\n      var props = this.props,\n          handlers = this.handlers;\n      var id = props.id,\n          className = props.className,\n          readOnly = props.readOnly,\n          editor = props.editor,\n          tabIndex = props.tabIndex,\n          role = props.role,\n          tagName = props.tagName,\n          spellCheck = props.spellCheck;\n      var value = editor.value;\n\n      var Container = tagName;\n      var document = value.document,\n          selection = value.selection,\n          decorations = value.decorations;\n\n      var indexes = document.getSelectionIndexes(selection);\n      var decs = document.getDecorations(editor).concat(decorations);\n      var childrenDecorations = getChildrenDecorations(document, decs);\n\n      var children = document.nodes.toArray().map(function (child, i) {\n        var isSelected = !!indexes && indexes.start <= i && i < indexes.end;\n\n        return _this3.renderNode(child, isSelected, childrenDecorations[i]);\n      });\n\n      var style = _extends({\n        // Prevent the default outline styles.\n        outline: 'none',\n        // Preserve adjacent whitespace and new lines.\n        whiteSpace: 'pre-wrap',\n        // Allow words to break if they are too long.\n        wordWrap: 'break-word'\n      }, readOnly ? {} : { WebkitUserModify: 'read-write-plaintext-only' }, props.style);\n\n      debug$6('render', { props: props });\n\n      return React.createElement(\n        Container,\n        _extends({}, handlers, {\n          'data-slate-editor': true,\n          ref: this.ref,\n          'data-key': document.key,\n          contentEditable: readOnly ? null : true,\n          suppressContentEditableWarning: true,\n          id: id,\n          className: className,\n          autoCorrect: props.autoCorrect ? 'on' : 'off',\n          spellCheck: spellCheck,\n          style: style,\n          role: readOnly ? null : role || 'textbox',\n          tabIndex: tabIndex\n          // COMPAT: The Grammarly Chrome extension works by changing the DOM out\n          // from under `contenteditable` elements, which leads to weird behaviors\n          // so we have to disable it like this. (2017/04/24)\n          , 'data-gramm': false\n        }),\n        children\n      );\n    }\n\n    /**\n     * Render a `child` node of the document.\n     *\n     * @param {Node} child\n     * @param {Boolean} isSelected\n     * @return {Element}\n     */\n\n  }]);\n  return Content;\n}(React.Component);\n\n/**\n * Export.\n *\n * @type {Component}\n */\n\nContent.propTypes = {\n  autoCorrect: Types.bool.isRequired,\n  className: Types.string,\n  editor: Types.object.isRequired,\n  id: Types.string,\n  readOnly: Types.bool.isRequired,\n  role: Types.string,\n  spellCheck: Types.bool.isRequired,\n  style: Types.object,\n  tabIndex: Types.number,\n  tagName: Types.string };\nContent.defaultProps = {\n  style: {},\n  tagName: 'div' };\n\n/**\n * Props that can be defined by plugins.\n *\n * @type {Array}\n */\n\nvar PROPS = [].concat(toConsumableArray(EVENT_HANDLERS), ['commands', 'decorateNode', 'queries', 'renderEditor', 'renderMark', 'renderNode', 'schema']);\n\n/**\n * A plugin that adds the React-specific rendering logic to the editor.\n *\n * @param {Object} options\n * @return {Object}\n */\n\nfunction ReactPlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var placeholder = options.placeholder,\n      _options$plugins = options.plugins,\n      plugins = _options$plugins === undefined ? [] : _options$plugins;\n\n  /**\n   * Decorate node.\n   *\n   * @param {Object} node\n   * @param {Editor} editor\n   * @param {Function} next\n   * @return {Array}\n   */\n\n  function decorateNode(node, editor, next) {\n    return [];\n  }\n\n  /**\n   * Render editor.\n   *\n   * @param {Object} props\n   * @param {Editor} editor\n   * @param {Function} next\n   * @return {Element}\n   */\n\n  function renderEditor(props, editor, next) {\n    return React.createElement(Content, {\n      autoCorrect: props.autoCorrect,\n      className: props.className,\n      editor: editor,\n      id: props.id,\n      onEvent: function onEvent(handler, event) {\n        return editor.run(handler, event);\n      },\n      readOnly: props.readOnly,\n      role: props.role,\n      spellCheck: props.spellCheck,\n      style: props.style,\n      tabIndex: props.tabIndex,\n      tagName: props.tagName\n    });\n  }\n\n  /**\n   * Render node.\n   *\n   * @param {Object} props\n   * @param {Editor} editor\n   * @param {Function} next\n   * @return {Element}\n   */\n\n  function renderNode(props, editor, next) {\n    var attributes = props.attributes,\n        children = props.children,\n        node = props.node;\n    var object = node.object;\n\n    if (object != 'block' && object != 'inline') return null;\n\n    var Tag = object == 'block' ? 'div' : 'span';\n    var style = { position: 'relative' };\n    return React.createElement(\n      Tag,\n      _extends({}, attributes, { style: style }),\n      children\n    );\n  }\n\n  /**\n   * Return the plugins.\n   *\n   * @type {Array}\n   */\n\n  var ret = [];\n  var editorPlugin = PROPS.reduce(function (memo, prop) {\n    if (prop in options) memo[prop] = options[prop];\n    return memo;\n  }, {});\n\n  ret.push(DOMPlugin({\n    plugins: [editorPlugin].concat(toConsumableArray(plugins))\n  }));\n\n  if (placeholder) {\n    ret.push(PlaceholderPlugin({\n      placeholder: placeholder,\n      when: function when(editor, node) {\n        return node.object === 'document' && node.text === '' && node.nodes.size === 1 && node.getTexts().size === 1;\n      }\n    }));\n  }\n\n  ret.push({\n    decorateNode: decorateNode,\n    renderEditor: renderEditor,\n    renderNode: renderNode\n  });\n\n  return ret;\n}\n\n/**\n * Debug.\n *\n * @type {Function}\n */\n\nvar debug$7 = Debug('slate:editor');\n\n/**\n * Editor.\n *\n * @type {Component}\n */\n\nvar Editor$1 = function (_React$Component) {\n  inherits(Editor$$1, _React$Component);\n\n  function Editor$$1() {\n    var _ref;\n\n    var _temp, _this, _ret;\n\n    classCallCheck(this, Editor$$1);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = possibleConstructorReturn(this, (_ref = Editor$$1.__proto__ || Object.getPrototypeOf(Editor$$1)).call.apply(_ref, [this].concat(args))), _this), _this.state = { value: _this.props.defaultValue\n\n      /**\n       * Temporary values.\n       *\n       * @type {Object}\n       */\n\n    }, _this.tmp = {\n      mounted: false,\n      change: null,\n      resolves: 0,\n      updates: 0\n\n      /**\n       * When the component first mounts, flush a queued change if one exists.\n       */\n\n    }, _this.resolveController = memoizeOne(function () {\n      warning(_this.tmp.resolves < 5 || _this.tmp.resolves !== _this.tmp.updates, 'A Slate <Editor> component is re-resolving the `plugins`, `schema`, `commands`, `queries` or `placeholder` prop on each update, which leads to poor performance. This is often due to passing in a new references for these props with each render by declaring them inline in your render function. Do not do this! Declare them outside your render function, or memoize them instead.');\n\n      _this.tmp.resolves++;\n      var react = ReactPlugin(_extends({}, _this.props, {\n        value: _this.props.value || _this.state.value\n      }));\n\n      var onChange = function onChange(change) {\n        if (_this.tmp.mounted) {\n          _this.handleChange(change);\n        } else {\n          _this.tmp.change = change;\n        }\n      };\n\n      _this.controller = new Editor({ plugins: [react], onChange: onChange }, { controller: _this, construct: false });\n\n      _this.controller.run('onConstruct');\n    }), _temp), possibleConstructorReturn(_this, _ret);\n  }\n  /**\n   * Property types.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Default properties.\n   *\n   * @type {Object}\n   */\n\n  /**\n   * Initial state.\n   *\n   * @type {Object}\n   */\n\n  createClass(Editor$$1, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.tmp.mounted = true;\n      this.tmp.updates++;\n\n      if (this.props.autoFocus) {\n        this.focus();\n      }\n\n      if (this.tmp.change) {\n        this.handleChange(this.tmp.change);\n        this.tmp.change = null;\n      }\n    }\n\n    /**\n     * When the component updates, flush a queued change if one exists.\n     */\n\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate() {\n      this.tmp.updates++;\n\n      if (this.tmp.change) {\n        this.handleChange(this.tmp.change);\n        this.tmp.change = null;\n      }\n    }\n\n    /**\n     * When the component unmounts, make sure async commands don't trigger react updates.\n     */\n\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.tmp.mounted = false;\n    }\n\n    /**\n     * Render the editor.\n     *\n     * @return {Element}\n     */\n\n  }, {\n    key: 'render',\n    value: function render() {\n      debug$7('render', this);\n      var props = _extends({}, this.props, { editor: this\n\n        // Re-resolve the controller if needed based on memoized props.\n      });var commands = props.commands,\n          placeholder = props.placeholder,\n          plugins = props.plugins,\n          queries = props.queries,\n          schema = props.schema;\n\n      this.resolveController(plugins, schema, commands, queries, placeholder);\n\n      // Set the current props on the controller.\n      var options = props.options,\n          readOnly = props.readOnly,\n          valueFromProps = props.value;\n      var valueFromState = this.state.value;\n\n      var value = valueFromProps || valueFromState;\n      this.controller.setReadOnly(readOnly);\n      this.controller.setValue(value, options);\n\n      // Render the editor's children with the controller.\n      var children = this.controller.run('renderEditor', _extends({}, props, {\n        value: value\n      }));\n      return children;\n    }\n\n    /**\n     * Resolve an editor controller from the passed-in props. This method takes\n     * all of the props as individual arguments to be able to properly memoize\n     * against anything that could change and invalidate the old editor.\n     *\n     * @param {Array} plugins\n     * @param {Object} schema\n     * @param {Object} commands\n     * @param {Object} queries\n     * @param {String} placeholder\n     * @return {Editor}\n     */\n\n  }, {\n    key: 'handleChange',\n    value: function handleChange(change) {\n      var onChange = this.props.onChange;\n      var value = this.state.value;\n\n\n      if (value) {\n        // Syncing value inside this component since parent does not want control of it (defaultValue was used)\n        this.setState({ value: change.value });\n      }\n\n      onChange(change);\n    }\n\n    /**\n     * Mimic the API of the `Editor` controller, so that this component instance\n     * can be passed in its place to plugins.\n     */\n\n  }, {\n    key: 'applyOperation',\n    value: function applyOperation() {\n      var _controller;\n\n      return (_controller = this.controller).applyOperation.apply(_controller, arguments);\n    }\n  }, {\n    key: 'command',\n    value: function command() {\n      var _controller2;\n\n      return (_controller2 = this.controller).command.apply(_controller2, arguments);\n    }\n  }, {\n    key: 'hasCommand',\n    value: function hasCommand() {\n      var _controller3;\n\n      return (_controller3 = this.controller).hasCommand.apply(_controller3, arguments);\n    }\n  }, {\n    key: 'hasQuery',\n    value: function hasQuery() {\n      var _controller4;\n\n      return (_controller4 = this.controller).hasQuery.apply(_controller4, arguments);\n    }\n  }, {\n    key: 'normalize',\n    value: function normalize() {\n      var _controller5;\n\n      return (_controller5 = this.controller).normalize.apply(_controller5, arguments);\n    }\n  }, {\n    key: 'query',\n    value: function query() {\n      var _controller6;\n\n      return (_controller6 = this.controller).query.apply(_controller6, arguments);\n    }\n  }, {\n    key: 'registerCommand',\n    value: function registerCommand() {\n      var _controller7;\n\n      return (_controller7 = this.controller).registerCommand.apply(_controller7, arguments);\n    }\n  }, {\n    key: 'registerQuery',\n    value: function registerQuery() {\n      var _controller8;\n\n      return (_controller8 = this.controller).registerQuery.apply(_controller8, arguments);\n    }\n  }, {\n    key: 'run',\n    value: function run() {\n      var _controller9;\n\n      return (_controller9 = this.controller).run.apply(_controller9, arguments);\n    }\n  }, {\n    key: 'withoutNormalizing',\n    value: function withoutNormalizing() {\n      var _controller10;\n\n      return (_controller10 = this.controller).withoutNormalizing.apply(_controller10, arguments);\n    }\n\n    /**\n     * Deprecated.\n     */\n\n  }, {\n    key: 'call',\n    value: function call() {\n      var _controller11;\n\n      return (_controller11 = this.controller).call.apply(_controller11, arguments);\n    }\n  }, {\n    key: 'change',\n    value: function change() {\n      var _controller12;\n\n      return (_controller12 = this.controller).change.apply(_controller12, arguments);\n    }\n  }, {\n    key: 'onChange',\n    value: function onChange() {\n      var _controller13;\n\n      return (_controller13 = this.controller).onChange.apply(_controller13, arguments);\n    }\n  }, {\n    key: 'applyOperations',\n    value: function applyOperations() {\n      var _controller14;\n\n      return (_controller14 = this.controller).applyOperations.apply(_controller14, arguments);\n    }\n  }, {\n    key: 'setOperationFlag',\n    value: function setOperationFlag() {\n      var _controller15;\n\n      return (_controller15 = this.controller).setOperationFlag.apply(_controller15, arguments);\n    }\n  }, {\n    key: 'getFlag',\n    value: function getFlag() {\n      var _controller16;\n\n      return (_controller16 = this.controller).getFlag.apply(_controller16, arguments);\n    }\n  }, {\n    key: 'unsetOperationFlag',\n    value: function unsetOperationFlag() {\n      var _controller17;\n\n      return (_controller17 = this.controller).unsetOperationFlag.apply(_controller17, arguments);\n    }\n  }, {\n    key: 'withoutNormalization',\n    value: function withoutNormalization() {\n      var _controller18;\n\n      return (_controller18 = this.controller).withoutNormalization.apply(_controller18, arguments);\n    }\n  }, {\n    key: 'operations',\n    get: function get$$1() {\n      return this.controller.operations;\n    }\n  }, {\n    key: 'readOnly',\n    get: function get$$1() {\n      return this.controller.readOnly;\n    }\n  }, {\n    key: 'value',\n    get: function get$$1() {\n      return this.controller.value;\n    }\n  }, {\n    key: 'editor',\n    get: function get$$1() {\n      return this.controller.editor;\n    }\n  }, {\n    key: 'schema',\n    get: function get$$1() {\n      invariant(false, 'As of Slate 0.42, the `editor.schema` property no longer exists, and its functionality has been folded into the editor itself. Use the `editor` instead.');\n    }\n  }, {\n    key: 'stack',\n    get: function get$$1() {\n      invariant(false, 'As of Slate 0.42, the `editor.stack` property no longer exists, and its functionality has been folded into the editor itself. Use the `editor` instead.');\n    }\n  }]);\n  return Editor$$1;\n}(React.Component);\n\n/**\n * Export.\n *\n * @type {Component}\n */\n\nEditor$1.propTypes = _extends({\n  autoCorrect: Types.bool,\n  autoFocus: Types.bool,\n  className: Types.string,\n  defaultValue: SlateTypes.value,\n  id: Types.string,\n  onChange: Types.func,\n  options: Types.object,\n  placeholder: Types.any,\n  plugins: Types.array,\n  readOnly: Types.bool,\n  role: Types.string,\n  schema: Types.object,\n  spellCheck: Types.bool,\n  style: Types.object,\n  tabIndex: Types.number,\n  value: SlateTypes.value\n}, EVENT_HANDLERS.reduce(function (obj, handler) {\n  obj[handler] = Types.func;\n  return obj;\n}, {}));\nEditor$1.defaultProps = {\n  autoFocus: false,\n  autoCorrect: true,\n  onChange: function onChange() {},\n  options: {},\n  placeholder: '',\n  plugins: [],\n  readOnly: false,\n  schema: {},\n  spellCheck: true };\n\nvar index = {\n  Editor: Editor$1,\n  cloneFragment: cloneFragment,\n  findDOMNode: findDOMNode,\n  findDOMRange: findDOMRange,\n  findNode: findNode,\n  findRange: findRange,\n  getEventRange: getEventRange,\n  getEventTransfer: getEventTransfer,\n  setEventTransfer: setEventTransfer,\n  ReactPlugin: ReactPlugin\n};\n\nexport default index;\nexport { Editor$1 as Editor, cloneFragment, findDOMNode, findDOMRange, findNode, findRange, getEventRange, getEventTransfer, setEventTransfer, ReactPlugin };\n//# sourceMappingURL=slate-react.es.js.map\n","\"use strict\";\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\n/**\n * Colors.\n */\n\nexports.colors = ['#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC', '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF', '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC', '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF', '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC', '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033', '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366', '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933', '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC', '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF', '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'];\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n// eslint-disable-next-line complexity\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n    return true;\n  } // Internet Explorer and Edge do not support colors.\n\n\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  } // Is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\n\n  return typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || // Is firebug? http://stackoverflow.com/a/398120/376773\n  typeof window !== 'undefined' && window.console && (window.console.firebug || window.console.exception && window.console.table) || // Is firefox >= v31?\n  // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n  typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31 || // Double check webkit in userAgent just in case we are in a worker\n  typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/);\n}\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\n\nfunction formatArgs(args) {\n  args[0] = (this.useColors ? '%c' : '') + this.namespace + (this.useColors ? ' %c' : ' ') + args[0] + (this.useColors ? '%c ' : ' ') + '+' + module.exports.humanize(this.diff);\n\n  if (!this.useColors) {\n    return;\n  }\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit'); // The final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function (match) {\n    if (match === '%%') {\n      return;\n    }\n\n    index++;\n\n    if (match === '%c') {\n      // We only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n  args.splice(lastC, 0, c);\n}\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\n\nfunction log() {\n  var _console;\n\n  // This hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return (typeof console === \"undefined\" ? \"undefined\" : _typeof(console)) === 'object' && console.log && (_console = console).log.apply(_console, arguments);\n}\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\n\nfunction save(namespaces) {\n  try {\n    if (namespaces) {\n      exports.storage.setItem('debug', namespaces);\n    } else {\n      exports.storage.removeItem('debug');\n    }\n  } catch (error) {// Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\n\nfunction load() {\n  var r;\n\n  try {\n    r = exports.storage.getItem('debug');\n  } catch (error) {} // Swallow\n  // XXX (@Qix-) should we be logging these?\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\n\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\n\nfunction localstorage() {\n  try {\n    // TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n    // The Browser also has localStorage in the global context.\n    return localStorage;\n  } catch (error) {// Swallow\n    // XXX (@Qix-) should we be logging these?\n  }\n}\n\nmodule.exports = require('./common')(exports);\nvar formatters = module.exports.formatters;\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n  try {\n    return JSON.stringify(v);\n  } catch (error) {\n    return '[UnexpectedJSONParseError]: ' + error.message;\n  }\n};\n\n","\"use strict\";\n\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\nfunction setup(env) {\n  createDebug.debug = createDebug;\n  createDebug.default = createDebug;\n  createDebug.coerce = coerce;\n  createDebug.disable = disable;\n  createDebug.enable = enable;\n  createDebug.enabled = enabled;\n  createDebug.humanize = require('ms');\n  Object.keys(env).forEach(function (key) {\n    createDebug[key] = env[key];\n  });\n  /**\n  * Active `debug` instances.\n  */\n\n  createDebug.instances = [];\n  /**\n  * The currently active debug mode names, and names to skip.\n  */\n\n  createDebug.names = [];\n  createDebug.skips = [];\n  /**\n  * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n  *\n  * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n  */\n\n  createDebug.formatters = {};\n  /**\n  * Selects a color for a debug namespace\n  * @param {String} namespace The namespace string for the for the debug instance to be colored\n  * @return {Number|String} An ANSI color code for the given namespace\n  * @api private\n  */\n\n  function selectColor(namespace) {\n    var hash = 0;\n\n    for (var i = 0; i < namespace.length; i++) {\n      hash = (hash << 5) - hash + namespace.charCodeAt(i);\n      hash |= 0; // Convert to 32bit integer\n    }\n\n    return createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n  }\n\n  createDebug.selectColor = selectColor;\n  /**\n  * Create a debugger with the given `namespace`.\n  *\n  * @param {String} namespace\n  * @return {Function}\n  * @api public\n  */\n\n  function createDebug(namespace) {\n    var prevTime;\n\n    function debug() {\n      // Disabled?\n      if (!debug.enabled) {\n        return;\n      }\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var self = debug; // Set `diff` timestamp\n\n      var curr = Number(new Date());\n      var ms = curr - (prevTime || curr);\n      self.diff = ms;\n      self.prev = prevTime;\n      self.curr = curr;\n      prevTime = curr;\n      args[0] = createDebug.coerce(args[0]);\n\n      if (typeof args[0] !== 'string') {\n        // Anything else let's inspect with %O\n        args.unshift('%O');\n      } // Apply any `formatters` transformations\n\n\n      var index = 0;\n      args[0] = args[0].replace(/%([a-zA-Z%])/g, function (match, format) {\n        // If we encounter an escaped % then don't increase the array index\n        if (match === '%%') {\n          return match;\n        }\n\n        index++;\n        var formatter = createDebug.formatters[format];\n\n        if (typeof formatter === 'function') {\n          var val = args[index];\n          match = formatter.call(self, val); // Now we need to remove `args[index]` since it's inlined in the `format`\n\n          args.splice(index, 1);\n          index--;\n        }\n\n        return match;\n      }); // Apply env-specific formatting (colors, etc.)\n\n      createDebug.formatArgs.call(self, args);\n      var logFn = self.log || createDebug.log;\n      logFn.apply(self, args);\n    }\n\n    debug.namespace = namespace;\n    debug.enabled = createDebug.enabled(namespace);\n    debug.useColors = createDebug.useColors();\n    debug.color = selectColor(namespace);\n    debug.destroy = destroy;\n    debug.extend = extend; // Debug.formatArgs = formatArgs;\n    // debug.rawLog = rawLog;\n    // env-specific initialization logic for debug instances\n\n    if (typeof createDebug.init === 'function') {\n      createDebug.init(debug);\n    }\n\n    createDebug.instances.push(debug);\n    return debug;\n  }\n\n  function destroy() {\n    var index = createDebug.instances.indexOf(this);\n\n    if (index !== -1) {\n      createDebug.instances.splice(index, 1);\n      return true;\n    }\n\n    return false;\n  }\n\n  function extend(namespace, delimiter) {\n    return createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n  }\n  /**\n  * Enables a debug mode by namespaces. This can include modes\n  * separated by a colon and wildcards.\n  *\n  * @param {String} namespaces\n  * @api public\n  */\n\n\n  function enable(namespaces) {\n    createDebug.save(namespaces);\n    createDebug.names = [];\n    createDebug.skips = [];\n    var i;\n    var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n    var len = split.length;\n\n    for (i = 0; i < len; i++) {\n      if (!split[i]) {\n        // ignore empty strings\n        continue;\n      }\n\n      namespaces = split[i].replace(/\\*/g, '.*?');\n\n      if (namespaces[0] === '-') {\n        createDebug.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n      } else {\n        createDebug.names.push(new RegExp('^' + namespaces + '$'));\n      }\n    }\n\n    for (i = 0; i < createDebug.instances.length; i++) {\n      var instance = createDebug.instances[i];\n      instance.enabled = createDebug.enabled(instance.namespace);\n    }\n  }\n  /**\n  * Disable debug output.\n  *\n  * @api public\n  */\n\n\n  function disable() {\n    createDebug.enable('');\n  }\n  /**\n  * Returns true if the given mode name is enabled, false otherwise.\n  *\n  * @param {String} name\n  * @return {Boolean}\n  * @api public\n  */\n\n\n  function enabled(name) {\n    if (name[name.length - 1] === '*') {\n      return true;\n    }\n\n    var i;\n    var len;\n\n    for (i = 0, len = createDebug.skips.length; i < len; i++) {\n      if (createDebug.skips[i].test(name)) {\n        return false;\n      }\n    }\n\n    for (i = 0, len = createDebug.names.length; i < len; i++) {\n      if (createDebug.names[i].test(name)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n  /**\n  * Coerce `val`.\n  *\n  * @param {Mixed} val\n  * @return {Mixed}\n  * @api private\n  */\n\n\n  function coerce(val) {\n    if (val instanceof Error) {\n      return val.stack || val.message;\n    }\n\n    return val;\n  }\n\n  createDebug.enable(createDebug.load());\n  return createDebug;\n}\n\nmodule.exports = setup;\n\n"],"sourceRoot":""}