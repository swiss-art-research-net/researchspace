(window.webpackJsonp=window.webpackJsonp||[]).push([[197],{2353:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0});var a=t(11),r=t(16),i=t(10),o=t(1),s=t(1),u=t(72),l=t(3357);t(1503);var c=t(2363),h=t(3387),p=t(1505);var d="OutsideOfRange",g="BeginLaterThenEnd",v="NoResultsInRange",f=function f(){var e=this;this.fromNumberFn=function(e){return i({year:e}).startOf("year")},this.dateToYears=function(e){return null===e?null:e.year()+(e.dayOfYear()-1)/366},this.toStringFn=function(e){return Math.abs(e)+" "+(e>=0?"AD":"BC")},this.toSliderRange=function(n){return{begin:e.dateToYears(n.begin),end:e.dateToYears(n.end)}},this.fromSliderRange=function(n){return{begin:e.fromNumberFn(n.begin),end:e.fromNumberFn(n.end)}},this.toInputValue=function(e){return{epoch:e>=0?"AD":"BC",year:Math.abs(e)}},this.fromInputValue=function(e){var n=e.epoch;return e.year*("AD"===n?1:-1)}};n.DateConverter=f;var m=function m(){this.toStringFn=function(e){return""+e},this.toSliderRange=function(e){return e},this.fromSliderRange=function(e){return e},this.toInputValue=function(e){return""+e},this.fromInputValue=function(e){return parseFloat(e)}};function getConverter(e,n){return function isDateProps(e){return"date-range"===e.kind}(e)?n(e,new f):function isNumericProps(e){return"numeric-range"===e.kind}(e)?n(e,new m):void 0}n.NumericConverter=m;var S=function(e){function CustomHandle(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(CustomHandle,e),CustomHandle.prototype.render=function(){return s.createElement("div",{className:p.handle,style:{left:this.props.offset+"%"}},this.props.toStringFn(this.props.value))},CustomHandle}(o.Component),C=function(e){function FacetSliderComponent(n){var t=e.call(this,n)||this;return t.onSliderValueChange=function(e){var n={begin:e[0],end:e[1]};t.setState({value:n}),t.onNewRange(n)},t.onBeginChange=function(e){getConverter(t.props,(function(n,a){var r={begin:a.fromInputValue(e),end:t.state.value?t.state.value.end:null};t.setState({value:r}),t.onNewRange(r)}))},t.onEndChange=function(e){getConverter(t.props,(function(n,a){var r={begin:t.state.value?t.state.value.begin:null,end:a.fromInputValue(e)};t.setState({value:r}),t.onNewRange(r)}))},t.isRangeValid=function(e){return t.isValidInterval(e)&&t.isInRange(e)&&t.hasResultsInRange(e)},t.isValidInterval=function(e){return e.begin<=e.end},t.isInRange=function(e){return e.begin>=t.state.min&&e.end<=t.state.max},t.hasResultsInRange=function(e){return r.some(t.state.events,(function(n){return n.begin<=e.end&&n.end>=e.begin}))},t.validationMessage=function(){var e=getConverter(t.props,(function(e,n){return n})).toStringFn,n=t.state,a=n.min,r=n.max;switch(t.state.validationError){case d:return"Available range is "+e(a)+" - "+e(r);case g:return"Begin should not be later than end";case v:return"No results in chosen range"}},t.state=r.assign({isValidRange:!0},t.propsToState(n)),t.onNewRange=r.debounce(t.onNewRange,500),t}return a.__extends(FacetSliderComponent,e),FacetSliderComponent.prototype.propsToState=function(e){var n={};return getConverter(e,(function(e,t){for(var a=[],i=0,o=e.data;i<o.length;i++){var s=o[i],u=t.toSliderRange(s),l=u.begin,c=u.end;l&&c&&a.push(new h.GraphEvent(l,c,1))}var p=Math.floor(r.min(a.map((function(e){return e.begin})))),d=Math.ceil(r.max(a.map((function(e){return e.end})))),g=e.value.map(t.toSliderRange).getOrElse({begin:p,end:d});n={min:p,max:d,value:g,events:a}})),n},FacetSliderComponent.prototype.componentWillReceiveProps=function(e){this.setState(this.propsToState(e))},FacetSliderComponent.prototype.onNewRange=function(e){if(this.isRangeValid(e))getConverter(this.props,(function(n,t){return n.actions.toggleFacetValue(t.fromSliderRange(e))})),this.setState({isValidRange:!0});else{var n=void 0;this.isValidInterval(e)?this.isInRange(e)?this.hasResultsInRange(e)||(n=v):n=d:n=g,this.setState({isValidRange:!1,validationError:n})}},FacetSliderComponent.prototype.render=function(){var e=this,n=this.state,t=n.min,r=n.max,i=n.value,o=n.isValidRange,d=this.state.events,g=getConverter(this.props,(function(e,n){return n})),v=g.toStringFn,f=g.toInputValue;return s.createElement("div",null,s.createElement("div",{className:p.slidergraph},s.createElement(h.FacetSliderGraph,{events:d,range:i,min:this.state.min,max:this.state.max}),o?null:s.createElement("div",{className:"has-error"},s.createElement("label",{className:"control-label"},this.validationMessage())),s.createElement(l.Range,{allowCross:!1,min:t,max:r,className:p.slider,value:[i.begin,i.end],handle:function(e){return s.createElement(S,a.__assign({},e,{toStringFn:v}))},onChange:this.onSliderValueChange}),"numeric-range"===this.props.kind?s.createElement("div",{className:p.range},s.createElement(u.FormControl,{value:f(i.begin),onChange:function(n){var t=n.target.value;e.onBeginChange(t)}}),s.createElement("span",null,"to"),s.createElement(u.FormControl,{value:f(i.end),onChange:function(n){var t=n.target.value;e.onEndChange(t)}})):s.createElement("div",{className:p.range},s.createElement(c.YearInput,{value:f(i.begin),onChange:this.onBeginChange,isYearValid:this.state.isValidRange}),s.createElement("span",null,"to"),s.createElement(c.YearInput,{value:f(i.end),onChange:this.onEndChange,isYearValid:this.state.isValidRange}))))},FacetSliderComponent}(o.Component);n.FacetSliderComponent=C,n.FacetSlider=o.createFactory(C),n.default=n.FacetSlider},3387:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0});var a=t(11),r=t(1),i=t(35),o=t(20),s=function s(e,n,t){this.begin=e,this.end=n,this.weight=t};n.GraphEvent=s;var u=function(e){function FacetSliderGraph(n,t){var a=e.call(this,n,t)||this;return a.points=[],a}return a.__extends(FacetSliderGraph,e),FacetSliderGraph.prototype.calculatePoints=function(e){for(var n=[],t=[],a=[],r=0,i=0,o=e;i<o.length;i++){var s=o[i],u=s.weight/Math.max(1,s.end-s.begin);t.push(s.begin),a.push(u),n.push(r),++r,t.push(s.end),a.push(-u),n.push(r),++r}n.sort((function(e,n){return t[e]-t[n]==0?a[n]-a[e]:t[e]-t[n]}));for(var l=t.length,c=l?t[n[0]]:0,h=l?t[n[l-1]]:0,p=0,d=0,g=0;g<l;++g)(p+=a[n[g]])>d&&(d=p);var v=[];p=0;for(var f=0;f<l;++f)v.push([(t[n[f]]-c)/(h-c),p/d]),p+=a[n[f]],v.push([(t[n[f]]-c)/(h-c),p/d]);return v},FacetSliderGraph.prototype.componentWillReceiveProps=function(e){e.events!==this.props.events&&(this.points=this.calculatePoints(e.events))},FacetSliderGraph.prototype.componentWillMount=function(){this.points=this.calculatePoints(this.props.events)},FacetSliderGraph.prototype.componentDidMount=function(){this.updateCanvas()},FacetSliderGraph.prototype.componentDidUpdate=function(e,n){this.updateCanvas()},FacetSliderGraph.prototype.updateCanvas=function(){var e=o.findDOMNode(this.refs.canvas);e.width=this.refs["canvas-container"].clientWidth;var n=e.height,t=e.width,a=e.getContext("2d"),r=this.points;if(r.length>0){a.beginPath(),a.strokeStyle="#008cba",a.lineWidth=.5,a.moveTo(r[0][0]*(t-2)+1,n-r[0][1]*n);for(var i=1;i<r.length;++i)a.lineTo(r[i][0]*(t-2)+1,n-r[i][1]*n);a.stroke()}var s=this.props.min,u=this.props.max;a.strokeStyle="gray",a.lineWidth=1,a.setLineDash([2,4]),a.strokeRect(Math.round((this.props.range.begin-s)/(u-s)*t)+.5,-10.5,Math.round((this.props.range.end-this.props.range.begin)/(u-s)*t),n+20)},FacetSliderGraph.prototype.render=function(){return i.div({ref:"canvas-container"},i.canvas({ref:"canvas",width:"100%",height:"100"}))},FacetSliderGraph}(r.Component);n.FacetSliderGraph=u,n.default=u}}]);
//# sourceMappingURL=default~semantic-search-facet~semantic-search-facet-breadcrumbs-0ac3cd23b9be793a66d5.js.map