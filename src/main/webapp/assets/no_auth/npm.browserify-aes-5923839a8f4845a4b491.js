(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{1839:function(e,t,r){var i=r(1551).Buffer;function asUInt32Array(e){i.isBuffer(e)||(e=i.from(e));for(var t=e.length/4|0,r=new Array(t),c=0;c<t;c++)r[c]=e.readUInt32BE(4*c);return r}function scrubVec(e){for(;0<e.length;e++)e[0]=0}function cryptBlock(e,t,r,i,c){for(var n,a,h,o,p=r[0],s=r[1],l=r[2],u=r[3],f=e[0]^t[0],y=e[1]^t[1],_=e[2]^t[2],v=e[3]^t[3],d=4,S=1;S<c;S++)n=p[f>>>24]^s[y>>>16&255]^l[_>>>8&255]^u[255&v]^t[d++],a=p[y>>>24]^s[_>>>16&255]^l[v>>>8&255]^u[255&f]^t[d++],h=p[_>>>24]^s[v>>>16&255]^l[f>>>8&255]^u[255&y]^t[d++],o=p[v>>>24]^s[f>>>16&255]^l[y>>>8&255]^u[255&_]^t[d++],f=n,y=a,_=h,v=o;return n=(i[f>>>24]<<24|i[y>>>16&255]<<16|i[_>>>8&255]<<8|i[255&v])^t[d++],a=(i[y>>>24]<<24|i[_>>>16&255]<<16|i[v>>>8&255]<<8|i[255&f])^t[d++],h=(i[_>>>24]<<24|i[v>>>16&255]<<16|i[f>>>8&255]<<8|i[255&y])^t[d++],o=(i[v>>>24]<<24|i[f>>>16&255]<<16|i[y>>>8&255]<<8|i[255&_])^t[d++],[n>>>=0,a>>>=0,h>>>=0,o>>>=0]}var c=[0,1,2,4,8,16,32,64,128,27,54],n=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var r=[],i=[],c=[[],[],[],[]],n=[[],[],[],[]],a=0,h=0,o=0;o<256;++o){var p=h^h<<1^h<<2^h<<3^h<<4;p=p>>>8^255&p^99,r[a]=p,i[p]=a;var s=e[a],l=e[s],u=e[l],f=257*e[p]^16843008*p;c[0][a]=f<<24|f>>>8,c[1][a]=f<<16|f>>>16,c[2][a]=f<<8|f>>>24,c[3][a]=f,f=16843009*u^65537*l^257*s^16843008*a,n[0][p]=f<<24|f>>>8,n[1][p]=f<<16|f>>>16,n[2][p]=f<<8|f>>>24,n[3][p]=f,0===a?a=h=1:(a=s^e[e[e[u^s]]],h^=e[e[h]])}return{SBOX:r,INV_SBOX:i,SUB_MIX:c,INV_SUB_MIX:n}}();function AES(e){this._key=asUInt32Array(e),this._reset()}AES.blockSize=16,AES.keySize=32,AES.prototype.blockSize=AES.blockSize,AES.prototype.keySize=AES.keySize,AES.prototype._reset=function(){for(var e=this._key,t=e.length,r=t+6,i=4*(r+1),a=[],h=0;h<t;h++)a[h]=e[h];for(h=t;h<i;h++){var o=a[h-1];h%t==0?(o=o<<8|o>>>24,o=n.SBOX[o>>>24]<<24|n.SBOX[o>>>16&255]<<16|n.SBOX[o>>>8&255]<<8|n.SBOX[255&o],o^=c[h/t|0]<<24):t>6&&h%t==4&&(o=n.SBOX[o>>>24]<<24|n.SBOX[o>>>16&255]<<16|n.SBOX[o>>>8&255]<<8|n.SBOX[255&o]),a[h]=a[h-t]^o}for(var p=[],s=0;s<i;s++){var l=i-s,u=a[l-(s%4?0:4)];p[s]=s<4||l<=4?u:n.INV_SUB_MIX[0][n.SBOX[u>>>24]]^n.INV_SUB_MIX[1][n.SBOX[u>>>16&255]]^n.INV_SUB_MIX[2][n.SBOX[u>>>8&255]]^n.INV_SUB_MIX[3][n.SBOX[255&u]]}this._nRounds=r,this._keySchedule=a,this._invKeySchedule=p},AES.prototype.encryptBlockRaw=function(e){return cryptBlock(e=asUInt32Array(e),this._keySchedule,n.SUB_MIX,n.SBOX,this._nRounds)},AES.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),r=i.allocUnsafe(16);return r.writeUInt32BE(t[0],0),r.writeUInt32BE(t[1],4),r.writeUInt32BE(t[2],8),r.writeUInt32BE(t[3],12),r},AES.prototype.decryptBlock=function(e){var t=(e=asUInt32Array(e))[1];e[1]=e[3],e[3]=t;var r=cryptBlock(e,this._invKeySchedule,n.INV_SUB_MIX,n.INV_SBOX,this._nRounds),c=i.allocUnsafe(16);return c.writeUInt32BE(r[0],0),c.writeUInt32BE(r[3],4),c.writeUInt32BE(r[2],8),c.writeUInt32BE(r[1],12),c},AES.prototype.scrub=function(){scrubVec(this._keySchedule),scrubVec(this._invKeySchedule),scrubVec(this._key)},e.exports.AES=AES},1972:function(e,t,r){var i=r(3191),c=r(3199),n=r(2291);t.createCipher=t.Cipher=i.createCipher,t.createCipheriv=t.Cipheriv=i.createCipheriv,t.createDecipher=t.Decipher=c.createDecipher,t.createDecipheriv=t.Decipheriv=c.createDecipheriv,t.listCiphers=t.getCiphers=function getCiphers(){return Object.keys(n)}},1973:function(e,t,r){var i={ECB:r(3192),CBC:r(3193),CFB:r(3194),CFB8:r(3195),CFB1:r(3196),OFB:r(3197),CTR:r(2289),GCM:r(2289)},c=r(2291);for(var n in c)c[n].module=i[c[n].mode];e.exports=c},2289:function(e,t,r){var i=r(1744),c=r(1551).Buffer,n=r(2290);function getBlock(e){var t=e._cipher.encryptBlockRaw(e._prev);return n(e._prev),t}t.encrypt=function(e,t){var r=Math.ceil(t.length/16),n=e._cache.length;e._cache=c.concat([e._cache,c.allocUnsafe(16*r)]);for(var a=0;a<r;a++){var h=getBlock(e),o=n+16*a;e._cache.writeUInt32BE(h[0],o+0),e._cache.writeUInt32BE(h[1],o+4),e._cache.writeUInt32BE(h[2],o+8),e._cache.writeUInt32BE(h[3],o+12)}var p=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,p)}},2290:function(e,t){e.exports=function incr32(e){for(var t,r=e.length;r--;){if(255!==(t=e.readUInt8(r))){t++,e.writeUInt8(t,r);break}e.writeUInt8(0,r)}}},2291:function(e){e.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')},2292:function(e,t,r){var i=r(1839),c=r(1551).Buffer,n=r(1636),a=r(62),h=r(3198),o=r(1744),p=r(2290);function StreamCipher(e,t,r,a){n.call(this);var o=c.alloc(4,0);this._cipher=new i.AES(t);var s=this._cipher.encryptBlock(o);this._ghash=new h(s),r=function calcIv(e,t,r){if(12===t.length)return e._finID=c.concat([t,c.from([0,0,0,1])]),c.concat([t,c.from([0,0,0,2])]);var i=new h(r),n=t.length,a=n%16;i.update(t),a&&(a=16-a,i.update(c.alloc(a,0))),i.update(c.alloc(8,0));var o=8*n,s=c.alloc(8);s.writeUIntBE(o,0,8),i.update(s),e._finID=i.state;var l=c.from(e._finID);return p(l),l}(this,r,s),this._prev=c.from(r),this._cache=c.allocUnsafe(0),this._secCache=c.allocUnsafe(0),this._decrypt=a,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}a(StreamCipher,n),StreamCipher.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=c.alloc(t,0),this._ghash.update(t))}this._called=!0;var r=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(r),this._len+=e.length,r},StreamCipher.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=o(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function xorTest(e,t){var r=0;e.length!==t.length&&r++;for(var i=Math.min(e.length,t.length),c=0;c<i;++c)r+=e[c]^t[c];return r}(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},StreamCipher.prototype.getAuthTag=function getAuthTag(){if(this._decrypt||!c.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},StreamCipher.prototype.setAuthTag=function setAuthTag(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},StreamCipher.prototype.setAAD=function setAAD(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},e.exports=StreamCipher},2293:function(e,t,r){var i=r(1839),c=r(1551).Buffer,n=r(1636);function StreamCipher(e,t,r,a){n.call(this),this._cipher=new i.AES(t),this._prev=c.from(r),this._cache=c.allocUnsafe(0),this._secCache=c.allocUnsafe(0),this._decrypt=a,this._mode=e}r(62)(StreamCipher,n),StreamCipher.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},StreamCipher.prototype._final=function(){this._cipher.scrub()},e.exports=StreamCipher},3191:function(e,t,r){var i=r(1973),c=r(2292),n=r(1551).Buffer,a=r(2293),h=r(1636),o=r(1839),p=r(1840);function Cipher(e,t,r){h.call(this),this._cache=new Splitter,this._cipher=new o.AES(t),this._prev=n.from(r),this._mode=e,this._autopadding=!0}r(62)(Cipher,h),Cipher.prototype._update=function(e){var t,r;this._cache.add(e);for(var i=[];t=this._cache.get();)r=this._mode.encrypt(this,t),i.push(r);return n.concat(i)};var s=n.alloc(16,16);function Splitter(){this.cache=n.allocUnsafe(0)}function createCipheriv(e,t,r){var h=i[e.toLowerCase()];if(!h)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=n.from(t)),t.length!==h.key/8)throw new TypeError("invalid key length "+t.length);if("string"==typeof r&&(r=n.from(r)),"GCM"!==h.mode&&r.length!==h.iv)throw new TypeError("invalid iv length "+r.length);return"stream"===h.type?new a(h.module,t,r):"auth"===h.type?new c(h.module,t,r):new Cipher(h.module,t,r)}Cipher.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(s))throw this._cipher.scrub(),new Error("data not multiple of block length")},Cipher.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},Splitter.prototype.add=function(e){this.cache=n.concat([this.cache,e])},Splitter.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},Splitter.prototype.flush=function(){for(var e=16-this.cache.length,t=n.allocUnsafe(e),r=-1;++r<e;)t.writeUInt8(e,r);return n.concat([this.cache,t])},t.createCipheriv=createCipheriv,t.createCipher=function createCipher(e,t){var r=i[e.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var c=p(t,!1,r.key,r.iv);return createCipheriv(e,c.key,c.iv)}},3192:function(e,t){t.encrypt=function(e,t){return e._cipher.encryptBlock(t)},t.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},3193:function(e,t,r){var i=r(1744);t.encrypt=function(e,t){var r=i(t,e._prev);return e._prev=e._cipher.encryptBlock(r),e._prev},t.decrypt=function(e,t){var r=e._prev;e._prev=t;var c=e._cipher.decryptBlock(t);return i(c,r)}},3194:function(e,t,r){var i=r(1551).Buffer,c=r(1744);function encryptStart(e,t,r){var n=t.length,a=c(t,e._cache);return e._cache=e._cache.slice(n),e._prev=i.concat([e._prev,r?t:a]),a}t.encrypt=function(e,t,r){for(var c,n=i.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=i.allocUnsafe(0)),!(e._cache.length<=t.length)){n=i.concat([n,encryptStart(e,t,r)]);break}c=e._cache.length,n=i.concat([n,encryptStart(e,t.slice(0,c),r)]),t=t.slice(c)}return n}},3195:function(e,t,r){var i=r(1551).Buffer;function encryptByte(e,t,r){var c=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=i.concat([e._prev.slice(1),i.from([r?t:c])]),c}t.encrypt=function(e,t,r){for(var c=t.length,n=i.allocUnsafe(c),a=-1;++a<c;)n[a]=encryptByte(e,t[a],r);return n}},3196:function(e,t,r){var i=r(1551).Buffer;function encryptByte(e,t,r){for(var i,c,n=-1,a=0;++n<8;)i=t&1<<7-n?128:0,a+=(128&(c=e._cipher.encryptBlock(e._prev)[0]^i))>>n%8,e._prev=shiftIn(e._prev,r?i:c);return a}function shiftIn(e,t){var r=e.length,c=-1,n=i.allocUnsafe(e.length);for(e=i.concat([e,i.from([t])]);++c<r;)n[c]=e[c]<<1|e[c+1]>>7;return n}t.encrypt=function(e,t,r){for(var c=t.length,n=i.allocUnsafe(c),a=-1;++a<c;)n[a]=encryptByte(e,t[a],r);return n}},3197:function(e,t,r){(function(e){var i=r(1744);function getBlock(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}t.encrypt=function(t,r){for(;t._cache.length<r.length;)t._cache=e.concat([t._cache,getBlock(t)]);var c=t._cache.slice(0,r.length);return t._cache=t._cache.slice(r.length),i(r,c)}}).call(this,r(163).Buffer)},3198:function(e,t,r){var i=r(1551).Buffer,c=i.alloc(16,0);function fromArray(e){var t=i.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function GHASH(e){this.h=e,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}GHASH.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},GHASH.prototype._multiply=function(){for(var e,t,r=function toArray(e){return[e.readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)]}(this.h),i=[0,0,0,0],c=-1;++c<128;){for(0!=(this.state[~~(c/8)]&1<<7-c%8)&&(i[0]^=r[0],i[1]^=r[1],i[2]^=r[2],i[3]^=r[3]),t=0!=(1&r[3]),e=3;e>0;e--)r[e]=r[e]>>>1|(1&r[e-1])<<31;r[0]=r[0]>>>1,t&&(r[0]=r[0]^225<<24)}this.state=fromArray(i)},GHASH.prototype.update=function(e){var t;for(this.cache=i.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},GHASH.prototype.final=function(e,t){return this.cache.length&&this.ghash(i.concat([this.cache,c],16)),this.ghash(fromArray([0,e,0,t])),this.state},e.exports=GHASH},3199:function(e,t,r){var i=r(2292),c=r(1551).Buffer,n=r(1973),a=r(2293),h=r(1636),o=r(1839),p=r(1840);function Decipher(e,t,r){h.call(this),this._cache=new Splitter,this._last=void 0,this._cipher=new o.AES(t),this._prev=c.from(r),this._mode=e,this._autopadding=!0}function Splitter(){this.cache=c.allocUnsafe(0)}function createDecipheriv(e,t,r){var h=n[e.toLowerCase()];if(!h)throw new TypeError("invalid suite type");if("string"==typeof r&&(r=c.from(r)),"GCM"!==h.mode&&r.length!==h.iv)throw new TypeError("invalid iv length "+r.length);if("string"==typeof t&&(t=c.from(t)),t.length!==h.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===h.type?new a(h.module,t,r,!0):"auth"===h.type?new i(h.module,t,r,!0):new Decipher(h.module,t,r)}r(62)(Decipher,h),Decipher.prototype._update=function(e){var t,r;this._cache.add(e);for(var i=[];t=this._cache.get(this._autopadding);)r=this._mode.decrypt(this,t),i.push(r);return c.concat(i)},Decipher.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function unpad(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");var r=-1;for(;++r<t;)if(e[r+(16-t)]!==t)throw new Error("unable to decrypt data");if(16===t)return;return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},Decipher.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},Splitter.prototype.add=function(e){this.cache=c.concat([this.cache,e])},Splitter.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},Splitter.prototype.flush=function(){if(this.cache.length)return this.cache},t.createDecipher=function createDecipher(e,t){var r=n[e.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var i=p(t,!1,r.key,r.iv);return createDecipheriv(e,i.key,i.iv)},t.createDecipheriv=createDecipheriv}}]);
//# sourceMappingURL=npm.browserify-aes-5923839a8f4845a4b491.js.map