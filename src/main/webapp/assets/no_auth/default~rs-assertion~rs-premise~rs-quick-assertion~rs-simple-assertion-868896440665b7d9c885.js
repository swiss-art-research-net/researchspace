(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{1848:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var i=t(1237);r.getArgumentsFieldDefinition=function getArgumentsFieldDefinition(e){return i.getFieldDefinitionProp(e).map((function(e){var r=e;return r.iri=r.id,r.id="field",r}))}},1988:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var i=t(11),n=t(19),a=t(217),s=t(33),o=t(10),l=t(16),f=t(23),u=f.vocabularies.rdfs,p=t(118),d=t(121),c=t(1658),g=t(1588),R=t(1848),v=t(2343);function evaluate(e){return function(r){var t=r.iri.getOrElse(f.Rdf.iri(r.field.iri+"/assertion/"+a.v4()));return n.combine(l.map(r.beliefs,v.getBeliefGraphs)).map((function(i){var n=l.flatten(i);return[evaluateAssertion(e,t)(r,n),l.map(n,(function(e){return e.pointer}))]})).flatMap((function(e){var i=e[0],n=e[1],a=new p.LdpService(c.rso.AssertionsContainer.value);return r.iri.isJust?a.update(r.iri.get(),i.graph).map((function(e){return{assertion:r.iri.get(),beliefs:n}})):new p.LdpService(c.rso.AssertionsContainer.value).addResource(i.graph,s.Just(t.value)).map((function(e){return{assertion:e,beliefs:n}}))}))}}function evaluateAssertion(e,r){return function(r,t){var n=f.Rdf.BASE_IRI,s=l.map(t,(function(e){return f.Rdf.union(f.Rdf.graph([f.Rdf.triple(n,c.rso.PX_asserts,e.pointer)]),e.graph)})),u=function createAssertionTimeSpan(){var e=f.Rdf.iri("/time/"+a.v4()),r=o(),t=f.Rdf.literal(r.toISOString(),f.vocabularies.xsd.dateTime),i=f.Rdf.literal(r.format("LL"));return f.Rdf.pg(e,f.Rdf.graph([f.Rdf.triple(e,c.crm.P82a_begin_of_the_begin,t),f.Rdf.triple(e,c.crm.P82a_end_of_the_end,t),f.Rdf.triple(e,c.rso.displayLabel,i),f.Rdf.triple(e,f.vocabularies.rdfs.label,i)]))}(),p=i.__spreadArrays([f.Rdf.triple(n,f.vocabularies.rdf.type,c.rso.EX_Assertion),f.Rdf.triple(n,f.vocabularies.rdfs.label,f.Rdf.literal(r.title)),f.Rdf.triple(n,c.crm.P3_has_note,f.Rdf.literal(r.note)),f.Rdf.triple(n,c.rso.targetsField,f.Rdf.iri(r.field.iri)),f.Rdf.triple(n,c.rso.targetsRecord,r.target),f.Rdf.triple(n,c.crm.P14_carried_out_by,e.user),f.Rdf.triple(n,c.crm.P4_has_time_span,u.pointer)],f.Rdf.union.apply(f.Rdf,s).triples.toJS(),u.graph.triples.toJS());return r.narrative&&p.push(f.Rdf.triple(n,c.crm.P70i_is_documented_in,r.narrative)),f.Rdf.pg(n,f.Rdf.graph(p))}}r.loadAssertion=function loadAssertion(e){return new p.LdpService(c.rso.AssertionsContainer.value).get(e).flatMap((function(r){return function deserializeAssertion(e,r){var t=f.Rdf.pg(e,r),i=f.Rdf.getValueFromPropertyPath([c.rso.targetsRecord],t).getOrElse(void 0),n=f.Rdf.getValueFromPropertyPath([c.rso.targetsField],t).getOrElse(void 0);return R.getArgumentsFieldDefinition(n).map((function(n){var a=f.Rdf.getValuesFromPropertyPath([c.rso.PX_asserts],t).map((function(e){var t=f.Rdf.pg(e,r);return{iri:s.Just(e),beliefType:g.AssertedBeliefTypeKind,target:i,field:n,targetValue:f.Rdf.getValueFromPropertyPath([c.rso.PX_asserts_value],t).getOrElse(void 0),isCanonical:f.Rdf.getValueFromPropertyPath([c.rso.PX_is_canonical_value],t).map((function(e){return"true"===e.value})).getOrElse(!1),originRepository:"default",belief:{type:"simple",value:f.Rdf.getValueFromPropertyPath([c.crminf.J5_holds_to_be],t).map((function(e){return e.value})).getOrElse(void 0)}}}));return{iri:s.Just(e),title:f.Rdf.getValueFromPropertyPath([u.label],t).map((function(e){return e.value})).getOrElse(""),note:f.Rdf.getValueFromPropertyPath([c.crm.P3_has_note],t).map((function(e){return e.value})).getOrElse(""),narrative:f.Rdf.getValueFromPropertyPath([c.crm.P70i_is_documented_in],t).getOrElse(void 0),target:i,field:n,beliefs:a}}))}(e,r)})).toProperty()},r.saveAssertion=function saveAssertion(e){return n.fromPromise(d.Util.getUser()).toProperty().flatMap((function(r){return evaluate({user:f.Rdf.iri(r.userURI)})(e)})).toProperty()},r.evaluate=evaluate},2343:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var i=t(11),n=t(217),a=t(33),s=t(16),o=t(23),l=t(61),f=t(118),u=t(1658),p=t(1588);function serializeBelief(e,r,t){var i=[o.Rdf.triple(e,o.vocabularies.rdf.type,u.crminf.I2_Belief),o.Rdf.triple(e,u.crminf.J4_that,t),o.Rdf.triple(e,u.crminf.J5_holds_to_be,o.Rdf.literal(r.belief.value)),o.Rdf.triple(e,o.vocabularies.rdfs.label,o.Rdf.literal("Belief"))];return r.beliefType===p.AssertedBeliefTypeKind?i.push(o.Rdf.triple(e,u.rso.PX_asserts_value,r.targetValue),o.Rdf.triple(e,u.rso.PX_is_canonical_value,o.Rdf.literal(r.isCanonical))):r.argumentBeliefType===p.ArgumentsBeliefTypeAssertionKind?i.push(o.Rdf.triple(e,u.rso.PX_premise_assertion,r.assertion)):i.push(o.Rdf.triple(e,u.rso.PX_premise_target,r.target),o.Rdf.triple(e,u.rso.PX_premise_field,o.Rdf.iri(r.field.iri)),o.Rdf.triple(e,u.rso.PX_premise_target_repository,o.Rdf.literal(r.originRepository))),o.Rdf.pg(e,o.Rdf.graph(i))}function savePropositionSet(e,r,t){var n=function createPropositionIri(e){return o.Rdf.iri(e.value+"/proposition")}(r),s=function serializePropSet(e,r){var t=o.Rdf.iri("");return o.Rdf.graph(i.__spreadArrays([o.Rdf.triple(t,o.vocabularies.rdf.type,u.crminf.I4_Proposition_Set),o.Rdf.triple(t,o.vocabularies.rdfs.label,o.Rdf.literal("Proposition Set"))],r))}(0,e),l=f.ldpc(u.rso.PropositionsContainer.value);return t.iri.isJust?l.update(n,s):l.addResource(s,a.Just(n.value))}function createBeliefIri(e){return e.iri.getOrElse(o.Rdf.iri("http://researchspace.org/instances/belief/"+n.v4()))}function createBeliefLabel(e){return"Belief"}r.getBeliefGraphs=function getBeliefGraphs(e){return p.matchBelief({AssertedBelief:function(e){return function getBeliefGraphForAssertedBelief(e){var r=createBeliefIri(e);return function propSetForAssertedBelief(e){var r=function buildQueryForAssertedBelief(e,r){var t=e.updates[0];return{prefixes:e.prefixes,type:"query",queryType:"CONSTRUCT",template:t.insert[0].triples,where:r?[]:s.cloneDeep(t.where)}}(l.SparqlUtil.parseQuerySync(e.field.insertPattern),e.isCanonical);return l.SparqlClient.construct(l.SparqlClient.setBindings(r,{subject:e.target,value:e.targetValue}))}(e).flatMap((function(t){return savePropositionSet(t,r,e).map((function(t){return serializeBelief(r,e,t)}))})).toProperty()}(e).map((function(e){return[e]}))},ArgumentsBelief:function(e){return function getBeliefGraphForArgumentsBelief(e){return p.matchArgumentsBelief({AssertionBelief:function(e){return function getBeliefsForAssertion(e){return f.ldpc(u.rso.AssertionsContainer.value).get(e).map((function(r){return s.map(o.Rdf.getValuesFromPropertyPath([u.rso.PX_asserts],o.Rdf.pg(e,r)),(function(r){return o.Rdf.pg(r,o.Rdf.graph([o.Rdf.triple(r,u.rso.PX_premise_assertion,e)]))}))}))}(e.assertion)},FieldBelief:function(e){return function getBeliefsForField(e){var r=createBeliefIri(e);return function propSetForArgumentsBelief(e){var r=function buildQueryForArgumentsBelief(e){var r=e.updates[0];return{prefixes:e.prefixes,type:"query",queryType:"CONSTRUCT",template:r.insert[0].triples,where:[{type:"bgp",triples:r.insert[0].triples}]}}(l.SparqlUtil.parseQuerySync(e.field.insertPattern));return l.SparqlClient.construct(l.SparqlClient.setBindings(r,{subject:e.target}))}(e).flatMap((function(t){return savePropositionSet(t,r,e).map((function(t){return serializeBelief(r,e,t)}))})).toProperty()}(e).map((function(e){return[e]}))}})(e)}(e)}})(e)},r.createBeliefLabel=createBeliefLabel}}]);
//# sourceMappingURL=default~rs-assertion~rs-premise~rs-quick-assertion~rs-simple-assertion-868896440665b7d9c885.js.map