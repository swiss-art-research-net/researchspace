{"version":3,"sources":["webpack:///./src/main/web/components/ui/resource-label.ts","webpack:///./src/main/web/components/ui/highlight/index.ts"],"names":["props","context","fetchLabel","iri","semanticContext","subscription","LabelsService","getLabel","observe","value","label","setState","error","undefined","state","componentDidMount","this","Rdf","componentWillReceiveProps","nextProps","unsubscribe","componentWillUnmount","render","className","style","highlight","highlightProps","createElement","ErrorNotification","errorMessage","HighlightComponent","Spinner","Component","ResourceLabel","Props"],"mappings":"6IAmBA,OAGA,QACA,QACA,UACA,SACA,SAEA,SAkCA,cAEE,uBAAYA,EAAcC,GAA1B,MACE,YAAMD,EAAOC,IAAQ,K,OAoBf,EAAAC,WAAa,SAACC,GACpB,IAAMF,EAAU,EAAKA,QAAQG,gBAC7B,EAAKC,aAAeC,EAAcC,SAASJ,EAAK,CAAEF,QAAO,IAAIO,QAAQ,CACnEC,MAAO,SAACC,GAAU,SAAKC,SAAS,CAAED,MAAOA,EAAOE,WAAOC,KACvDD,MAAO,SAACA,GAAU,SAAKD,SAAS,CAAED,WAAOG,EAAWD,MAAOA,QAvB7D,EAAKE,MAAQ,G,EAuCjB,OA3CmC,6BAOjC,wBAAAC,kBAAA,WACEC,KAAKd,WAAW,EAAAe,IAAId,IAAIa,KAAKhB,MAAMG,OAGrC,wBAAAe,0BAAA,SAA0BC,GAChB,IAAAhB,EAAA,WAAAA,IACJgB,EAAUhB,MAAQA,IACpBa,KAAKX,aAAae,cAClBJ,KAAKd,WAAW,EAAAe,IAAId,IAAIgB,EAAUhB,QAItC,wBAAAkB,qBAAA,WACEL,KAAKX,aAAae,eAWpB,wBAAAE,OAAA,WACQ,iBAAEC,EAAA,EAAAA,UAAWC,EAAA,EAAAA,MAAOC,EAAA,EAAAA,UAAWC,EAAA,EAAAA,eAC/B,aAAEhB,EAAA,EAAAA,MAAOE,EAAA,EAAAA,MAEf,OAAIA,EACK,EAAAe,cAAc,EAAAC,kBAAmB,CAAEC,aAAcjB,IAGlC,iBAAVF,EACV,EAAAiB,cAAc,EAAAG,mBAAoB,CAAEP,UAAS,EAAEC,MAAK,EAAEC,UAAS,EAAEC,eAAc,GAAIhB,GACnF,EAAAiB,cAAc,EAAAI,UAEtB,cA3CA,CAAmC,EAAAC,WAAtB,EAAAC,gBA6Cb,UAAeA,G,sECxFf,cAAS,EAAAH,mBAAA,EAAAA,mBAAoB,EAAAI,MAAA,EAAAA","file":"mp-label-2f8a0c8371cc25063e34.js","sourcesContent":["/**\n * ResearchSpace\n * Copyright (C) 2020, © Trustees of the British Museum\n * Copyright (C) 2015-2019, metaphacts GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { CSSProperties, ReactElement, HTMLProps, createElement } from 'react';\nimport * as Kefir from 'kefir';\n\nimport { Rdf } from 'platform/api/rdf';\nimport { Component } from 'platform/api/components';\nimport { HighlightComponent } from 'platform/components/ui/highlight';\nimport { ErrorNotification } from 'platform/components/ui/notification';\nimport { Spinner } from 'platform/components/ui/spinner';\n\nimport * as LabelsService from 'platform/api/services/resource-label';\n\nexport interface Props {\n  /**\n   * IRI of resource to fetch label for\n   */\n  iri: string;\n  /**\n   * Additional class names for component root element\n   */\n  className?: string;\n  /**\n   * Additional styles for label element\n   */\n  style?: CSSProperties;\n  /**\n   * Substring to highlight\n   */\n  highlight?: string;\n  /**\n   * Props for highlighted substring span\n   */\n  highlightProps?: HTMLProps<HTMLSpanElement>;\n}\n\nexport interface State {\n  label?: string;\n  error?: any;\n}\n\n/**\n * @example\n * <mp-label iri='some:resource'></mp-label>\n */\nexport class ResourceLabel extends Component<Props, State> {\n  private subscription: Kefir.Subscription;\n  constructor(props: Props, context) {\n    super(props, context);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    this.fetchLabel(Rdf.iri(this.props.iri));\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    const { iri } = this.props;\n    if (nextProps.iri !== iri) {\n      this.subscription.unsubscribe();\n      this.fetchLabel(Rdf.iri(nextProps.iri));\n    }\n  }\n\n  componentWillUnmount() {\n    this.subscription.unsubscribe();\n  }\n\n  private fetchLabel = (iri: Rdf.Iri) => {\n    const context = this.context.semanticContext;\n    this.subscription = LabelsService.getLabel(iri, { context }).observe({\n      value: (label) => this.setState({ label: label, error: undefined }),\n      error: (error) => this.setState({ label: undefined, error: error }),\n    });\n  };\n\n  render(): ReactElement<any> {\n    const { className, style, highlight, highlightProps } = this.props;\n    const { label, error } = this.state;\n\n    if (error) {\n      return createElement(ErrorNotification, { errorMessage: error });\n    }\n\n    return typeof label === 'string'\n      ? createElement(HighlightComponent, { className, style, highlight, highlightProps }, label)\n      : createElement(Spinner);\n  }\n}\n\nexport default ResourceLabel;\n","/**\n * ResearchSpace\n * Copyright (C) 2020, © Trustees of the British Museum\n * Copyright (C) 2015-2019, metaphacts GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nexport { HighlightComponent, Props } from './HighlightComponent';\n"],"sourceRoot":""}