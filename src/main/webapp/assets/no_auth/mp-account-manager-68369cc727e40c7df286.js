(window.webpackJsonp=window.webpackJsonp||[]).push([[329],{1407:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0});var n=o(11),a=o(1),r=o(35),c=o(33),s=o(1625),i=o(121),l=o(1690),u=o(327),p=o(630),d=o(3016);o(1268);var m=function(t){function AccountManagerComponent(e){var o=t.call(this,e)||this;return o.getRowClass=function(t){return o.state.selectedAccount.isNothing?"":t.principal===o.state.selectedAccount.get().principal?"bg-success":""},o.onRowClick=function(t){var e=t.props.data,n=o.state.selectedAccount.map((function(t){return t.principal===e.principal?c.Nothing():c.Just(e)})).getOrElse(c.Just(e));o.setState({isLoading:!1,selectedAccount:n})},o.fetchAccounts=function(){o.setState({isLoading:!0,selectedAccount:c.Nothing()}),i.Util.getAllAccounts().onValue((function(t){return o.setState({isLoading:!1,data:c.Just(t)})})).onError((function(t){return o.setState({isLoading:!1,err:c.Just(t)})}))},o.state={isLoading:!0,data:c.Nothing(),selectedAccount:c.Nothing(),err:c.Nothing()},o}return n.__extends(AccountManagerComponent,t),AccountManagerComponent.prototype.render=function(){return this.state.err.isJust?a.createElement(p.TemplateItem,{template:{source:this.state.err.get()}}):this.state.isLoading?a.createElement(u.Spinner):r.div({},this.renderAccountTable(),d.default({selectedAccount:this.state.selectedAccount,refreshCallback:this.fetchAccounts}))},AccountManagerComponent.prototype.componentWillMount=function(){this.fetchAccounts()},AccountManagerComponent.prototype.renderAccountTable=function(){var t={onRowClick:this.onRowClick.bind(this),rowMetadata:{bodyCssClassName:this.getRowClass}};return r.div({},a.createElement(l.Table,{layout:c.Just({options:t,tupleTemplate:c.Nothing()}),numberOfDisplayedRows:c.Just(10),data:s.Left(this.state.data.get()),columnConfiguration:[{variableName:"principal",displayName:"User Principal"},{variableName:"roles",displayName:"Roles"},{variableName:"permissions",displayName:"Permissions",cellTemplate:'<ul class="account-manager-component__account-permissions-ul">{{#each this.permissions as |permission|}}<li class="account-manager-component__account-permissions-li">{{ permission }} </li>{{/each}}</ul>'}]}))},AccountManagerComponent}(a.Component),g=a.createFactory(m);e.default=g},3016:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0});var n=o(11),a=o(1),r=o(35),c=o(19),s=o(16),i=o(33),l=o(72),u=o(121),p=o(327),d=o(631),m=o(3017);o(1268);var g=a.createFactory(l.FormControl),h=a.createFactory(l.FormGroup),f=a.createFactory(l.ControlLabel),S=a.createFactory(l.Button),A=a.createFactory(l.Panel),b=function b(){var t=this;this.getAccountStream=function(){return t.accountStream},this.getPool=function(e){return t[e]},this.principal=c.pool(),this.password=c.pool(),this.passwordrepeat=c.pool(),this.roles=c.pool(),this.accountStream=c.pool(),c.combine([this.principal,this.password,this.passwordrepeat,this.roles],(function(e,o,n,a){if(null===e||null===a)return t.accountStream.plug(c.constant(i.Nothing()));var r=[];if(s.isEmpty(e)&&r.push("Principal must not be empty."),(s.isEmpty(a)||s.isNull(a))&&r.push("Roles must not be empty."),null!==o&&(s.isEmpty(o)||s.isEmpty(n))?r.push("Passwords must not be empty."):o!==n&&r.push("Passwords must be equal."),!s.isEmpty(r))return t.accountStream.plug(c.constantError(r.join("<br>")));t.accountStream.plug(c.constant(i.Just({principal:e,password:o,roles:a})))})).onValue((function(t){return t}))},C=function(t){function AccountFormComponent(e){var o=t.call(this,e)||this;return o.initStore=function(){o.accountStore=new b,o.accountStore.getAccountStream().onError((function(t){o.setState({isLoading:!1,updateAccount:i.Nothing(),alert:i.Just(d.Error(t))})})).onValue((function(t){o.setState({isLoading:!1,updateAccount:t,alert:i.Nothing()})})),o.accountStore.getPool("principal").onValue((function(t){o.setState({isLoading:!1,principal:t})})),o.accountStore.getPool("password").onValue((function(t){o.setState({isLoading:!1,password:t})})),o.accountStore.getPool("passwordrepeat").onValue((function(t){o.setState({isLoading:!1,passwordrepeat:t})})),o.accountStore.getPool("roles").onValue((function(t){o.setState({isLoading:!1,roles:t})}))},o.onChangeAccount=function(t){var e=t.target;o.plugValueToAccountStore(e.name,e.value)},o.plugValueToAccountStore=function(t,e){o.accountStore.getPool(t).plug(c.constant(e))},o.plugInitialValuesIntoAccountStore=function(t){o.accountStore.getPool("principal").plug(c.constant(t.isNothing?null:t.get().principal)),o.accountStore.getPool("password").plug(c.constant(null)),o.accountStore.getPool("passwordrepeat").plug(c.constant(null)),o.accountStore.getPool("roles").plug(c.constant(t.isNothing?null:t.get().roles))},o.renderNewAccountForm=function(t){var e=t.isNothing;return r.div({className:"account-manager-component__create-account-panel"},A({header:e?"New Account":"Update Account"},r.form({key:"account-panel",onSubmit:e?o.onSubmitCreateAccount:o.onSubmitUpdateAccount},h({controlId:"principal"},f({},"Principal"),g({name:"principal",type:"text",placeholder:"Unique username",disabled:!e,value:o.state.principal,onChange:o.onChangeAccount})),h({controlId:"password"},f({},"Password"),g({name:"password",type:"password",placeholder:"Password",value:o.state.password,onChange:o.onChangeAccount})),h({controlId:"passwordrepeat"},f({},"Repeat Password"),g({name:"passwordrepeat",type:"password",placeholder:"Repeat Password",value:o.state.passwordrepeat,onChange:o.onChangeAccount})),r.div({key:"role-selector-container",className:"account-manager-component__role-multi-selector"},[r.label({key:"control-label",className:"control-label"},"Roles"),r.div({key:"role-multi-selector"},m.default({initialRoles:i.Just(o.state.roles),inputName:"roles",onChangeCallback:o.plugValueToAccountStore}))]),r.div({key:"alert"},a.createElement(d.Alert,o.state.alert.map((function(t){return t})).getOrElse({alert:d.AlertType.NONE,message:""}))),r.div({key:"create-account-btn",className:"account-manager-component__create-account-btn"},S({type:"submit",bsSize:"small",bsStyle:"primary",disabled:o.submitDisabled()},e?"Create":"Update"))),e?null:S({key:"delete-account-btn",type:"submit",bsSize:"small",bsStyle:"primary",onClick:o.onClickDeleteAccount},"Delete")))},o.submitDisabled=function(){return o.state.updateAccount.isNothing},o.onClickDeleteAccount=function(){u.Util.deleteAccount(o.props.selectedAccount.get()).onValue((function(t){return o.props.refreshCallback()})).onError((function(t){return o.setState({isLoading:!1,alert:i.Just(d.Error(t))})}))},o.onSubmitUpdateAccount=function(t){t.stopPropagation(),t.preventDefault(),o.state.updateAccount.map((function(t){return u.Util.updateAccount(t).onValue((function(t){return o.props.refreshCallback()})).onError((function(t){return o.setState({isLoading:!1,alert:i.Just(d.Error(t))})}))}))},o.onSubmitCreateAccount=function(t){t.stopPropagation(),t.preventDefault(),o.state.updateAccount.map((function(t){return u.Util.createAccount(t).onValue((function(t){return o.props.refreshCallback()})).onError((function(t){return o.setState({isLoading:!1,alert:i.Just(d.Error(t))})}))}))},o.state={isLoading:!1,updateAccount:i.Nothing(),alert:i.Nothing(),principal:"",password:"",passwordrepeat:""},o}return n.__extends(AccountFormComponent,t),AccountFormComponent.prototype.render=function(){return this.state.isLoading?a.createElement(p.Spinner):this.renderNewAccountForm(this.props.selectedAccount)},AccountFormComponent.prototype.componentDidMount=function(){this.initStore(),this.plugInitialValuesIntoAccountStore(this.props.selectedAccount)},AccountFormComponent.prototype.componentWillReceiveProps=function(t){this.plugInitialValuesIntoAccountStore(t.selectedAccount)},AccountFormComponent}(a.Component),y=a.createFactory(C);e.default=y},3017:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0});var n=o(11),a=o(1),r=o(35),c=o(16),s=o(33),i=o(1559),l=o(121),u=o(327),p=function(t){function RoleMultiSelectorComponent(e,o){var n=t.call(this,e,o)||this;return n.onChangeRoleSelection=function(t){var e=c.map(t,"value").join(",");n.setState({isLoading:!1,roleString:s.Just(e)}),c.isUndefined(n.props.onChangeCallback)||n.props.onChangeCallback(n.props.inputName,e)},n.state={isLoading:!0,roleString:s.Nothing(),backendRoles:s.Nothing()},n}return n.__extends(RoleMultiSelectorComponent,t),RoleMultiSelectorComponent.prototype.render=function(){return this.state.isLoading||this.state.backendRoles.isNothing?a.createElement(u.Spinner):r.div({},this.renderSelector())},RoleMultiSelectorComponent.prototype.renderSelector=function(){var t=new Array;c.map(this.state.backendRoles.get(),(function(e){return t.push({value:e.roleName,label:e.roleName})}));var e={value:this.state.roleString.map((function(t){return t})).getOrElse(this.props.initialRoles.map((function(t){return t})).getOrElse("")),className:"dataset-selector__multi-select",name:this.props.inputName,multi:!0,options:t,clearable:!0,autoload:!0,clearAllText:"Remove all",clearValueText:"Remove role",delimiter:",",disabled:!1,ignoreCase:!0,matchPos:"any",matchProp:"any",noResultsText:"No roles found",placeholder:"Select roles",onChange:this.onChangeRoleSelection};return a.createElement(i.default,e)},RoleMultiSelectorComponent.prototype.componentWillMount=function(){var t=this;l.Util.getRoleDefinitions().onValue((function(e){return t.setState({isLoading:!1,backendRoles:s.Just(e)})}))},RoleMultiSelectorComponent.prototype.componentWillReceiveProps=function(t){this.setState({isLoading:!1,roleString:s.Just(t.initialRoles.map((function(t){return t})).getOrElse(""))})},RoleMultiSelectorComponent}(a.Component),d=a.createFactory(p);e.default=d}}]);
//# sourceMappingURL=mp-account-manager-68369cc727e40c7df286.js.map