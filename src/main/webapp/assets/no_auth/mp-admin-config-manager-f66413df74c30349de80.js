(window.webpackJsonp=window.webpackJsonp||[]).push([[331],{1396:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var a=r(11),n=r(19),o=r(1),i=r(1),s=r(33),l=r(16),p=r(72),u=r(1625),d=r(640),c=r(1690),g=r(116),m=r(631),f=r(1601),v=r(327),y=r(2982),E=r(1399),h=function(e){function ConfigManager(t,r){var a=e.call(this,t,r)||this;return a.state={isLoading:!0,loadingError:void 0,alertError:void 0,alertType:m.AlertType.NONE,editedProperty:void 0,savingProperty:!1},a}return a.__extends(ConfigManager,e),ConfigManager.prototype.render=function(){return this.state.loadingError?o.createElement(g.ErrorNotification,{errorMessage:this.state.loadingError}):this.state.isLoading?o.createElement(v.Spinner,null):o.createElement("div",{className:E.component},this.getTable(),this.props.editable?null:o.createElement("i",null,function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}(this.props.group),"Â configuration group is not editable during runtime."))},ConfigManager.prototype.componentDidMount=function(){this.props.group?this.loadConfigData():this.setState({isLoading:!1,loadingError:new Error("Config property group must not be empty.")})},ConfigManager.prototype.getTable=function(){for(var e=this,t=this.props.editable,r=this.state,n=r.apps,l=r.editedProperty,d=r.savingProperty,h=r.alertError,C=r.alertType,setEditedProperty=function(t){var r=h&&t===h.propertyName;e.setState({editedProperty:t,alertError:r?void 0:h,alertType:r?m.AlertType.NONE:C})},submitProperty=function(t,r){e.onSetConfig(l,t,r)},N=new Set,S=0,A=n;S<A.length;S++){var _=A[S];_.writable&&N.add(_.appId)}var b=[{displayName:"Name",variableName:"name"},{displayName:"Value",cellComponent:function(e){function class_1(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(class_1,e),class_1.prototype.render=function(){var e=this.props.rowData;if(e.name===l)return d?o.createElement(v.Spinner,null):o.createElement(y.InlineValuesEditor,{className:E.valuesEditor,source:e,apps:n,onSave:submitProperty,onCancel:function(){return setEditedProperty(void 0)}});var r=h&&e.name===h.propertyName;return o.createElement("div",null,0===e.values.length?o.createElement("div",{className:E.noValue},"(no value)"):o.createElement("div",{className:E.propertyValuesCell},o.createElement("div",{className:E.propertyValues},e.values.map((function(e,t){return o.createElement("div",{key:t,className:E.propertyValue},e)}))),o.createElement(p.Button,{className:"btn-grey",disabled:!t||d,onClick:function(){return setEditedProperty(e.name)}},o.createElement("span",{className:"fa fa-pencil"})," Edit")),r?o.createElement(m.Alert,{alert:C,message:""},o.createElement(g.ErrorPresenter,{error:h.originalError})):"")},class_1}(i.Component)},{displayName:"Defined by apps",cellComponent:function(r){function class_2(){return null!==r&&r.apply(this,arguments)||this}return a.__extends(class_2,r),class_2.prototype.render=function(){var r=this.props.rowData;return o.createElement("div",{className:E.propertyApps},r.definedByApps.map((function(a){return o.createElement(f.RemovableBadge,{key:a,className:E.propertyApp,disableClick:!0,disableRemove:!t||!N.has(a)||d,onRemove:function(){return t=r.name,n=a,void e.onDeleteConfig(t,n);var t,n}},a)})))},class_2}(i.Component)},{displayName:"Shadowed",cellComponent:function(e){function class_3(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(class_3,e),class_3.prototype.render=function(){return this.props.rowData.shadowed?o.createElement("span",null,"yes"):null},class_3}(i.Component)}],T={tupleTemplate:s.Nothing(),options:{resultsPerPage:20}};return o.createElement(c.Table,{numberOfDisplayedRows:s.Just(10),columnConfiguration:b,data:u.Left(this.state.data),layout:s.Just(T)})},ConfigManager.prototype.loadConfigData=function(){var e=this;this.setState({isLoading:!0,loadingError:void 0,alertError:void 0,alertType:m.AlertType.NONE}),n.combine({apps:d.getStorageStatus(),data:d.getConfigsInGroup(this.props.group)}).observe({value:function(t){var r=t.apps,a=t.data;e.setState({isLoading:!1,apps:r,data:l.map(a,(function(e,t){return{name:t,type:e.parameterType,values:d.configValueToArray(e.value),definedByApps:e.definedByApps,shadowed:e.shadowed}}))})},error:function(t){e.setState({isLoading:!1,loadingError:t})}})},ConfigManager.prototype.onSetConfig=function(e,t,r){var a=this;this.setState({editedProperty:e,savingProperty:!0,alertError:void 0,alertType:m.AlertType.NONE}),d.setConfig(this.props.group,e,t,r).observe({value:function(){a.setState({editedProperty:void 0,savingProperty:!1}),a.loadConfigData()},error:function(t){a.setState({editedProperty:void 0,savingProperty:!1,alertError:{propertyName:e,originalError:t},alertType:m.AlertType.DANGER})}})},ConfigManager.prototype.onDeleteConfig=function(e,t){var r=this;this.setState({editedProperty:e,savingProperty:!0,alertError:void 0,alertType:m.AlertType.NONE}),d.deleteConfig(this.props.group,e,t).observe({value:function(){r.setState({editedProperty:void 0,savingProperty:!1}),r.loadConfigData()},error:function(t){r.setState({editedProperty:void 0,savingProperty:!1,alertError:{propertyName:e,originalError:t},alertType:m.AlertType.DANGER})}})},ConfigManager}(i.Component);t.ConfigManager=h,t.default=h},2982:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var a=r(11),n=r(7),o=r(16),i=r(1),s=r(72),l=r(1949),p=r(56),u=r(1830),d=r(2244),c=r(1398),g=function(e){function InlineValuesEditor(t,r){var a=e.call(this,t,r)||this;return a.onSave=function(){var e=a.props.onSave,t=a.state,r=t.order,n=t.targetValues,o=t.targetApp;e(r.apply(n),o)},a.state={order:u.Ordering.empty,targetValues:a.props.source.values,targetApp:d.chooseDefaultTargetApp(a.props.apps,o.last(a.props.source.definedByApps))},a}return a.__extends(InlineValuesEditor,e),InlineValuesEditor.prototype.render=function(){var e=this,t=this.props,r=t.className,a=t.source,l=t.apps,p=t.onCancel,u=this.state,g=u.targetValues,m=u.targetApp,f=u.order,v=m&&!(m===o.last(a.definedByApps)&&function isConfigValuesEqual(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(a.values,f.apply(g)));return i.createElement("div",{className:n(c.component,r)},this.renderInput(a.type,g),i.createElement(d.StorageSelector,{className:c.storageSelector,allApps:l,sourceApps:a.definedByApps,targetApp:m,onChange:function(t){return e.setState({targetApp:t})}}),i.createElement("div",{className:c.footer},i.createElement("div",{className:c.submitControls},i.createElement(s.Button,{className:c.save,bsStyle:"primary",disabled:!v,onClick:this.onSave},"Save"),i.createElement(s.Button,{onClick:p},"Cancel"))))},InlineValuesEditor.prototype.renderInput=function(e,t){var r=this;if("boolean"===e){var n=0!==t.length&&"false"!==t[0];return i.createElement("input",{type:"checkbox",checked:n,onChange:function(e){var t=e.currentTarget.checked;r.setState({targetValues:[t?"true":"false"]})}})}if("stringList"===e)return i.createElement("div",null,i.createElement(u.ReorderableList,{dragByHandle:!0,itemClass:c.reorderedItem,ordering:this.state.order,onOrderChanged:function(e){return r.setState({order:e})}},t.map((function(e,n){return i.createElement("div",{key:n,className:c.removableItem},r.renderMultilineEditor(e,n),i.createElement(s.Button,{className:c.removeItemButton,onClick:function(){var e=a.__spreadArrays(t);e.splice(n,1),r.setState({targetValues:e})}},i.createElement("span",{className:"fa fa-times"})))}))),i.createElement("a",{className:void 0,onClick:function(e){e.preventDefault(),r.setState({targetValues:a.__spreadArrays(t,[""])})}},"+ Add configuration value"));var o=0===t.length?"":t[0];return this.renderMultilineEditor(o,0)},InlineValuesEditor.prototype.renderMultilineEditor=function(e,t){var r=this;return i.createElement(l.default,{className:c.multilineEditor,value:e,onChange:function(e){var n=e.currentTarget.value;r.setState((function(e){var r=a.__spreadArrays(e.targetValues);return r.splice(t,1,n),{targetValues:r}}))}})},InlineValuesEditor}(p.Component);t.InlineValuesEditor=g}}]);
//# sourceMappingURL=mp-admin-config-manager-f66413df74c30349de80.js.map