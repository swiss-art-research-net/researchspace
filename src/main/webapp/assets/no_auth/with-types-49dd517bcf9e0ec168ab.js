(window.webpackJsonp=window.webpackJsonp||[]).push([[512],{1540:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var s=n(11),a=n(1),i=n(16),p=n(23),l=n(216),r=n(61),o=n(34),u=n(56),c=n(630),y=n(327),L=function(e){function WithTypes(t,n){var s=e.call(this,t,n)||this;return s.cancellation=new o.Cancellation,s.fetchTypes=function(e){var t=r.SparqlUtil.parseQuerySync('CONSTRUCT {\n          ?iri a ?t .\n          ?t rdfs:label ?tLabel .\n          ?t rdfs:subClassOf ?type .\n          ?type rdfs:label ?label .\n        } WHERE {\n          BIND(COALESCE(?__iri__, <http://example.com>) AS ?iri) .\n          OPTIONAL {\n            ?t rdfs:label ?tEngLabel .\n            FILTER(LANG(?tEngLabel) = "en")\n          }\n          OPTIONAL {\n            ?t rdfs:label ?tNoLangLabel .\n            FILTER(LANG(?tNoLangLabel) = "")\n          }\n          BIND(COALESCE(?tEngLabel, ?tNoLangLabel, REPLACE(STR(?t), "^.*/(.*)$", "$1")) AS ?tLabel) .\n          OPTIONAL {\n            ?t rdfs:subClassOf+ ?type .\n            OPTIONAL {\n              ?type rdfs:label ?engLabel .\n              FILTER(LANG(?engLabel) = "en")\n            }\n            OPTIONAL {\n              ?type rdfs:label ?noLangLabel .\n              FILTER(LANG(?noLangLabel) = "")\n            }\n            BIND(COALESCE(?engLabel, ?noLangLabel, REPLACE(STR(?type), "^.*/(.*)$", "$1")) AS ?label) .\n          }\n        }');e.types&&!i.isEmpty(e.types)?t=r.SparqlClient.prepareParsedQuery(e.types.map((function(e){return{t:p.Rdf.iri(e)}})))(t):e.iri&&(t.where.unshift({type:"bgp",triples:[{subject:"?__iri__",predicate:l.rdf.type.value,object:"?t"}]}),t=r.SparqlClient.setBindings(t,{__iri__:p.Rdf.iri(e.iri)})),s.cancellation.map(r.SparqlClient.construct(t)).observe({value:function(e){var t={},n=[],a=[];e.forEach((function(e){e.p.equals(l.rdfs.label)&&(t[e.s.value]=e.o.value),e.p.equals(l.rdf.type)&&n.push(e.o.value),e.p.equals(l.rdfs.subClassOf)&&a.push(e.o.value)}));var i=n.concat(a),p=[];i.forEach((function(e){return p.push(t[e])}));var r=[];n.forEach((function(e){return r.push(t[e])})),s.setState({loading:!1,result:{directTypes:n,inferredTypes:a,allTypes:i,allTypesLabels:p.join(", "),directTypesLabels:r.join(", ")}})}})},s.state={loading:!0,result:{directTypes:[],inferredTypes:[],allTypes:[],allTypesLabels:"",directTypesLabels:""}},s}return s.__extends(WithTypes,e),WithTypes.prototype.componentDidMount=function(){this.props.iri||!i.isEmpty(this.props.types)?this.fetchTypes(this.props):this.setState({loading:!1})},WithTypes.prototype.componentWillReceiveProps=function(e){this.props.iri!==e.iri?this.fetchTypes(e):i.isEqual(this.props.types,e.types)||i.isEmpty(e.types)||this.fetchTypes(e)},WithTypes.prototype.render=function(){return this.state.loading?a.createElement(y.Spinner,null):a.createElement(c.TemplateItem,{template:{source:this.props.template,options:s.__assign(s.__assign(s.__assign({},this.props.templateContext),this.state.result),this.props.variables)}})},WithTypes}(u.Component);t.WithTypes=L,t.default=L}}]);
//# sourceMappingURL=with-types-49dd517bcf9e0ec168ab.js.map