(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1235:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),o=r(1),i=r(72),s=r(43),a=r(1581),l=r(1208),u=r(1553),c=r(1631),p=r(1946),d=r(1948),f="semantic-form-tree-picker-input",h=function(e){function TreePickerInput(t,r){var o=e.call(this,t,r)||this;o.onNestedFormSubmit=function(e){o.setState({nestedFormOpen:!1});var t=o.props.values.concat(e);o.onValuesChanged(t)},o.toggleNestedForm=function(){o.setState((function(e){return{nestedFormOpen:!e.nestedFormOpen}}))};var i=t.definition.treePatterns;t.treePatterns&&(i=Object.assign({},t.definition.treePatterns||{},n.__assign({type:"simple"},t.treePatterns))),t.scheme&&!i?i={type:"simple",scheme:t.scheme}:t.scheme&&"simple"===i.type&&(i.scheme=t.scheme);var s="full"===(null==i?void 0:i.type)?i:a.createDefaultTreeQueries(i);return o.state={treeVersionKey:0,treeQueries:s},o}return n.__extends(TreePickerInput,e),TreePickerInput.prototype.componentWillReceiveProps=function(e){var t=this.state.treeSelectionSet,r=function toSetOfIris(e){return e.filter((function(e){return u.FieldValue.isAtomic(e)&&e.value.isIri()})).map((function(e){return e.value})).toSet()}(e.values);!t&&0===r.size||t&&t.equals(r)||this.setState((function(e){return{treeVersionKey:e.treeVersionKey+1,treeSelection:r.toArray(),treeSelectionSet:r}}))},TreePickerInput.prototype.render=function(){var e=this,t=this.props.definition.maxOccurs,r=this.state.treeSelection,n=p.tryExtractNestedForm(this.props.children),i=n&&(!r||r.length<t);return o.createElement("div",{className:f},this.renderTreePicker(),i?this.renderCreateNewButton():null,this.state.nestedFormOpen?o.createElement(p.NestedModalForm,{definition:this.props.definition,onSubmit:this.onNestedFormSubmit,onCancel:function(){return e.setState({nestedFormOpen:!1})}},n):null)},TreePickerInput.prototype.renderTreePicker=function(){var e=this,t=this.props,r=t.openDropdownOnFocus,n=t.closeDropdownOnSelection,i=t.definition,s=this.state,u=s.treeVersionKey,c=s.treeQueries,p=s.treeSelection,h=c.rootsQuery,m=c.childrenQuery,y=c.parentsQuery,S=c.searchQuery,v="string"==typeof this.props.placeholder?this.props.placeholder:function createDefaultPlaceholder(e){return"Search or browse for values of "+(l.getPreferredLabel(e.label)||"entity").toLocaleLowerCase()+" here..."}(i);return o.createElement(a.SemanticTreeInput,{key:u,droppable:{query:d.createDropAskQueryForField(i),styles:{enabled:{outline:"2px solid #1D0A6E"},disabled:{}}},className:f+"__picker",placeholder:v,rootsQuery:h,childrenQuery:m,parentsQuery:y,searchQuery:S,initialSelection:p,multipleSelection:!0,openDropdownOnFocus:r,closeDropdownOnSelection:n,onSelectionChanged:function(t){var r=a.TreeSelection.leafs(t),n=r.map((function(e){return e.iri})).toSet();e.setState({treeSelection:n.toArray(),treeSelectionSet:n,nestedFormOpen:!1},(function(){return e.onTreeSelectionChanged(r)}))}})},TreePickerInput.prototype.onTreeSelectionChanged=function(e){var t=s.List(e.map((function(e){var t=e.iri,r=e.label;return u.FieldValue.fromLabeled({value:t,label:r?r.value:void 0})})));this.onValuesChanged(t)},TreePickerInput.prototype.onValuesChanged=function(e){var t=this.props,r=t.updateValues,n=t.handler;r((function(t){var r=t.errors;return n.validate({values:e,errors:r})}))},TreePickerInput.prototype.renderCreateNewButton=function(){return o.createElement(i.Button,{className:f+"__create-button",bsStyle:"default",onClick:this.toggleNestedForm},o.createElement("span",{className:"fa fa-plus"}),o.createElement("span",null,"Create new"))},TreePickerInput.makeHandler=function(e){return new c.CardinalityCheckingHandler(e)},TreePickerInput.defaultProps={openDropdownOnFocus:!0,closeDropdownOnSelection:!0},TreePickerInput}(c.MultipleValuesInput);t.TreePickerInput=h,c.MultipleValuesInput.assertStatic(h),t.default=h}}]);
//# sourceMappingURL=semantic-form-tree-picker-input-f40e1ec51b04c1a8580e.js.map