(window.webpackJsonp=window.webpackJsonp||[]).push([[460],{1475:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var a=r(11),s=r(1),n=r(1),i=r(35),o=r(139),l=r(33),c=r(19),p=r(16),d=r(72),u=r(61),m=r(1562),h=r(631),f=r(1654),w=r(1265),g=n.createFactory(d.ProgressBar);r(1476);var b=[{id:"title",label:"Title",minOccurs:1,maxOccurs:1,xsdDatatype:"xsd:string"},{id:"person",label:"Digitized By",maxOccurs:1,xsdDatatype:"xsd:anyURI",autosuggestionPattern:"prefix owl: <http://www.w3.org/2002/07/owl#>\n    prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n    prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    prefix bds: <http://www.bigdata.com/rdf/search#>\n    prefix rso: <http://www.researchspace.org/ontology/>\n    prefix crm: <http://www.cidoc-crm.org/cidoc-crm/>\n\n    SELECT DISTINCT ?value ?label ?type WHERE {\n      ?value rso:displayLabel ?label .\n      ?value rdf:type ?type .\n      ?type rdfs:subClassOf* crm:E39_Actor .\n      SERVICE <http://www.bigdata.com/rdf/search#search> {\n        ?label bds:search '*?token*' ;\n          bds:relevance ?score .\n      }\n    } ORDER BY ?score"},{id:"date",label:"Date",maxOccurs:1,xsdDatatype:"xsd:dateTime"},{id:"type",label:"Type",maxOccurs:1,xsdDatatype:"xsd:anyURI",valueSetPattern:"select ?value ?label where {\n      values(?value ?label) {\n        (<http://collection.britishmuseum.org/id/thesauri/imgtype/scan> 'Scan')\n        (<http://collection.britishmuseum.org/id/thesauri/imgtype/2d> '2D')\n        (<http://collection.britishmuseum.org/id/thesauri/imgtype/3d> '3D')\n       }\n     }\n      "},{id:"owner",label:"Owner",maxOccurs:1,xsdDatatype:"xsd:anyURI",autosuggestionPattern:"prefix owl: <http://www.w3.org/2002/07/owl#>\n    prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n    prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    prefix bds: <http://www.bigdata.com/rdf/search#>\n    prefix rso: <http://www.researchspace.org/ontology/>\n    prefix crm: <http://www.cidoc-crm.org/cidoc-crm/>\n\n    SELECT DISTINCT ?value ?label ?type WHERE {\n      ?value rso:displayLabel ?label .\n      ?value rdf:type ?type .\n      ?type rdfs:subClassOf* crm:E39_Actor .\n      SERVICE <http://www.bigdata.com/rdf/search#search> {\n        ?label bds:search '*?token*' ;\n          bds:relevance ?score .\n      }\n    } ORDER BY ?score"},{id:"copyright",label:"Copyright",maxOccurs:1,xsdDatatype:"xsd:string"},{id:"description",label:"Description",maxOccurs:1,xsdDatatype:"xsd:string"},{id:"scientificType",label:"Scientific Type",maxOccurs:1,xsdDatatype:"xsd:anyURI",valueSetPattern:"select ?value ?label where {\n      values(?value ?label) {\n        (<http://collection.britishmuseum.org/id/thesauri/scitype/xray> 'X-Ray')\n        (<http://collection.britishmuseum.org/id/thesauri/scitype/uv> 'Ultra Violet')\n        (<http://collection.britishmuseum.org/id/thesauri/scitype/ir> 'Infra Red')\n        (<http://collection.britishmuseum.org/id/thesauri/scitype/color> 'Visible light')\n      }\n    }"},{id:"width",label:"Width",maxOccurs:1,xsdDatatype:"xsd:decimal"},{id:"height",label:"Height",maxOccurs:1,xsdDatatype:"xsd:decimal"},{id:"unit",label:"Unit",maxOccurs:1,xsdDatatype:"xsd:anyURI",valueSetPattern:"select ?value ?label where {\n      values(?value ?label) {\n        (<http://collection.britishmuseum.org/id/thesauri/unit/mm> 'Millimeters')\n        (<http://collection.britishmuseum.org/id/thesauri/unit/px> 'Pixels')\n      }\n    }"},{id:"depicts",label:"Depicts",maxOccurs:1,xsdDatatype:"xsd:anyURI",autosuggestionPattern:"prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    prefix bds: <http://www.bigdata.com/rdf/search#>\n    prefix rso: <http://www.researchspace.org/ontology/>\n\n    SELECT DISTINCT ?value ?label WHERE {\n      ?value a rso:Concept;\n        rso:displayLabel ?label .\n      SERVICE <http://www.bigdata.com/rdf/search#search> {\n        ?label bds:search '*?token*' ;\n          bds:relevance ?score .\n      }\n    } ORDER BY ?score"},{id:"subjects",label:"Carries subject",maxOccurs:1,xsdDatatype:"xsd:anyURI",autosuggestionPattern:"prefix owl: <http://www.w3.org/2002/07/owl#>\n    prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\n    prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    prefix bds: <http://www.bigdata.com/rdf/search#>\n    prefix rso: <http://www.researchspace.org/ontology/>\n    prefix crm: <http://www.cidoc-crm.org/cidoc-crm/>\n\n    SELECT DISTINCT ?value ?label ?type WHERE {\n      ?value rso:displayLabel ?label .\n      ?value rdf:type ?type .\n      ?type rdfs:subClassOf* crm:E24_Physical_Man-Made_Thing .\n      SERVICE <http://www.bigdata.com/rdf/search#search> {\n        ?label bds:search '*?token*' ;\n          bds:relevance ?score .\n      }\n    } ORDER BY ?score"},{id:"refers",label:"Refers To",maxOccurs:1,xsdDatatype:"xsd:anyURI",autosuggestionPattern:"prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    prefix bds: <http://www.bigdata.com/rdf/search#>\n    prefix rso: <http://www.researchspace.org/ontology/>\n\n    SELECT DISTINCT ?value ?label WHERE {\n      ?value rso:displayLabel ?label .\n      SERVICE <http://www.bigdata.com/rdf/search#search> {\n        ?label bds:search '*?token*' ;\n          bds:relevance ?score .\n      }\n    } ORDER BY ?score"},{id:"about",label:"Is about",maxOccurs:1,xsdDatatype:"xsd:anyURI",autosuggestionPattern:"prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n    prefix bds: <http://www.bigdata.com/rdf/search#>\n    prefix rso: <http://www.researchspace.org/ontology/>\n\n    SELECT DISTINCT ?value ?label WHERE {\n      ?value rso:displayLabel ?label .\n      SERVICE <http://www.bigdata.com/rdf/search#search> {\n        ?label bds:search '*?token*' ;\n          bds:relevance ?score .\n      }\n    } ORDER BY ?score"}],y=function(e){function ImageUploadWidget(t){var r=e.call(this,t)||this;return r.state={files:[]},r}return a.__extends(ImageUploadWidget,e),ImageUploadWidget.prototype.componentDidMount=function(){var e=this;this.messages=c.pool(),this.messages.onValue((function(t){var r=e.state.alertState?e.state.alertState.message:"";e.setState(o({},e.state,{alertState:{alert:h.AlertType.WARNING,message:r+t}}))}))},ImageUploadWidget.prototype.onDrop=function(e){this.setState(o({},this.state,{files:e}))},ImageUploadWidget.prototype.submit=function(e){var t=this;if(0!==this.state.files.length){var r=e.fields.get("title");if(r&&0!==r.values.size){var a=this.state.files[0],s=p.isEmpty(this.props.config)||p.isEmpty(this.props.config.contentType)?w.FileUploadService.getMimeType(a):this.props.config.contentType,n=u.SparqlUtil.serializeQuery(function parametrizeQueryWithFormValues(e,t){var r=u.SparqlUtil.parseQuery(e);if("query"!==r.type)throw new Error("createResourceQuery must be a SELECT or CONSTRUCT query");return t.fields.reduce((function(e,t,r){var a=t.values.filter(m.FieldValue.isAtomic).map(m.FieldValue.asRdfNode).map((function(e){var t;return(t={})[r]=e,t})).toArray();return u.SparqlClient.prepareParsedQuery(a)(e)}),r)}(this.props.config.createResourceQuery,e));return w.FileUploadService.uploadFile({createResourceQuery:n,generateIdQuery:this.props.config.generateIdQuery,storage:this.props.config.storage,metadataExtractor:this.props.config.metadataExtractor,contextUri:this.props.config.contextUri,file:a,contentType:s,onProgress:function(e){return t.setState(o({},t.state,{progress:e}))}}).map((function(e){t.messages.plug(c.constant("File: "+a.name+" uploaded.<br/>")),window.location.reload()})).mapErrors((function(e){return t.messages.plug(c.constant("File: "+a.name+" failed ("+e+").<br/>"))}))}this.messages.plug(c.constant("Please fill in title to proceed with image upload.<br>"))}else this.messages.plug(c.constant("You have selected no images.<br>"))},ImageUploadWidget.prototype.render=function(){var e=this,t=l.fromNullable(this.state.progress),r=p.isEmpty(this.props.config)||p.isEmpty(this.props.config.description)?"Please drag & drop your image file here or click to browse the file system.":this.props.config.description;return i.div({className:"iiif-upload__holder"},this.state.alertState?s.createElement(h.Alert,this.state.alertState):null,t.map((function(e){return g({active:!0,min:0,max:100,now:e})})).getOrElse(null),s.createElement(f.Dropzone,{className:"iiif-upload__dropzone",onDrop:this.onDrop.bind(this),multiple:!1},i.div({className:"iiif-upload__description"},i.p({},r)),i.button({className:"iiif-upload__dropzone-button btn btn-sm btn-default"},"Browse")),this.state.files.map((function(e){return i.h4({key:e.name},"Selected file: "+e.name)})),s.createElement(m.ResourceEditorForm,{fields:b,persistence:{persist:function(t,r){if(!m.FieldValue.isEmpty(r))return e.submit(r)}}},n.createElement(m.PlainTextInput,{for:"title",placeholder:"Type title here"}),n.createElement(m.AutocompleteInput,{for:"person"}),n.createElement(m.DatePickerInput,{for:"date",mode:"date"}),n.createElement(m.SelectInput,{for:"type"}),n.createElement(m.AutocompleteInput,{for:"owner"}),n.createElement(m.PlainTextInput,{for:"copyright"}),n.createElement(m.PlainTextInput,{for:"description",multiline:!0}),n.createElement(m.SelectInput,{for:"scientificType"}),n.createElement(m.PlainTextInput,{for:"width"}),n.createElement(m.PlainTextInput,{for:"height"}),n.createElement(m.SelectInput,{for:"unit"}),n.createElement(m.AutocompleteInput,{for:"depicts"}),n.createElement(m.AutocompleteInput,{for:"subjects"}),n.createElement(m.AutocompleteInput,{for:"refers"}),n.createElement(m.AutocompleteInput,{for:"about"}),i.button({className:"btn btn-sm btn-success iiif-upload__submit-button pull-right",name:"submit"},"Submit"),i.button({className:"btn btn-sm btn-danger iiif-upload__cancel-button pull-right",onClick:function(){return window.location.reload()}},"Cancel")),this.state.alertState?s.createElement(h.Alert,this.state.alertState):null,t.map((function(e){return g({active:!0,min:0,max:100,now:e})})).getOrElse(null))},ImageUploadWidget}(s.Component);t.c=y,t.f=n.createFactory(t.c),t.default=t.c}}]);
//# sourceMappingURL=rs-image-upload-a04d1efa3a4dc8afe2e5.js.map