{"version":3,"sources":["webpack:///./src/main/web/components/security/HasPermission.tsx"],"names":["props","cancellation","Cancellation","state","allowedToSee","componentWillMount","this","map","isPermitted","permission","onValue","setState","render","Children","only","children","Component","HasPermission"],"mappings":"6IAkBA,OAEA,QACA,SAmBA,cAGE,uBAAYA,GAAZ,MACE,YAAMA,IAAM,K,OAHG,EAAAC,aAAe,IAAI,EAAAC,aAIlC,EAAKC,MAAQ,CAAEC,cAAc,G,EAgBjC,OArBmC,6BAQjC,wBAAAC,mBAAA,sBACEC,KAAKL,aACFM,IAAI,OAASC,YAAYF,KAAKN,MAAMS,aACpCC,SAAQ,SAACN,GAAiB,SAAKO,SAAS,CAAEP,aAAY,QAG3D,wBAAAQ,OAAA,WACE,OAAIN,KAAKH,MAAMC,aACN,EAAAS,SAASC,KAAKR,KAAKN,MAAMe,UAEzB,MAGb,cArBA,CAAmC,EAAAC,WAAtB,EAAAC,gBAuBb,UAAeA","file":"mp-has-permission-ada962f91183b78bb225.js","sourcesContent":["/**\n * ResearchSpace\n * Copyright (C) 2020, Â© Trustees of the British Museum\n * Copyright (C) 2015-2019, metaphacts GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\nimport { Component, Children, createFactory } from 'react';\n\nimport { Cancellation } from 'platform/api/async';\nimport { Util as Security } from 'platform/api/services/security';\n\ninterface HasPermisssionProps {\n  /**\n   * Required permission key to display a child component.\n   */\n  permission: string;\n}\n\ninterface State {\n  readonly allowedToSee?: boolean;\n}\n\n/**\n * Displays child component if user has the required permission; otherwise displays nothing.\n *\n * @example\n * <mp-has-permission permission='delete:all:data'></mp-has-permission>\n */\nexport class HasPermission extends Component<HasPermisssionProps, State> {\n  private readonly cancellation = new Cancellation();\n\n  constructor(props: HasPermisssionProps) {\n    super(props);\n    this.state = { allowedToSee: false };\n  }\n\n  componentWillMount() {\n    this.cancellation\n      .map(Security.isPermitted(this.props.permission))\n      .onValue((allowedToSee) => this.setState({ allowedToSee }));\n  }\n\n  render() {\n    if (this.state.allowedToSee) {\n      return Children.only(this.props.children);\n    } else {\n      return null;\n    }\n  }\n}\n\nexport default HasPermission;\n"],"sourceRoot":""}