(window.webpackJsonp=window.webpackJsonp||[]).push([[327],{1462:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),a=n(43),o=n(16),i=n(1),s=n(1579),l=n(34),u=n(56),c=n(162),p=n(23),d=n(61),f=n(1243),m=n(2335),g=n(214),h=n(116),v=n(327),S=s.InternalApi.TemplateProperties,y=function(e){function DiagramSearchResult(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(DiagramSearchResult,e),DiagramSearchResult.prototype.render=function(){var e=this,t=this.context.semanticContext;return i.createElement(m.SemanticSearchContext.Consumer,null,(function(n){return i.createElement(_,r.__assign({},e.props,{context:r.__assign(r.__assign({},n),{semanticContext:t})}))}))},DiagramSearchResult}(u.Component);t.DiagramSearchResult=y;var _=function(e){function DiagramSearchResultInner(t){var n=e.call(this,t)||this;return n.cancellation=new l.Cancellation,n.query=g.Action(),n.loadQueryData=function(e){var t=n.props.context.semanticContext,r=d.SparqlClient.select(e.query,{context:t});return r.onValue((function(t){n.setState({queryResult:t,iris:n.buildElements(e,t),isLoading:!1})})),r.onError((function(e){n.setState({errorMessage:e,isLoading:!1})})),r.onEnd((function(){n.props.id&&c.trigger({eventType:c.BuiltInEvents.ComponentLoaded,source:n.props.id})})),r},n.onLoadWorkspace=function(e){var t=e.getModel(),onLoaded=function(){return function pinRelevantProperties(e,t){if(!t.graphScopeResults||!t.graphScopeResults.isJust)return;for(var n=new Set,a=t.graphScopeResults.get(),o=0,i=a.columns;o<i.length;o++){var s=i[o];"var-value"===s.type&&n.add(p.Rdf.fullIri(s.attribute.iri).value)}for(var _loop_1=function(e){n.forEach((function(t){var n,a;if(e.data.properties[t]){var o=e.elementState?e.elementState[S.PinnedProperties]:void 0,i=r.__assign(r.__assign({},e.elementState),((n={})[S.PinnedProperties]=r.__assign(r.__assign({},o),((a={})[t]=!0,a)),n));e.setElementState(i)}}))},l=0,u=e.elements;l<u.length;l++){var c=u[l];_loop_1(c)}}(t,n.props.context)};t.events.on("loadingSuccess",onLoaded),n.cancellation.onCancel((function(){return t.events.off("loadingSuccess",onLoaded)}))},n.state={isLoading:!0},n.cancellation.map(n.query.$property.debounce(300)).flatMap(n.loadQueryData).onValue((function(){})),n.loadQueryData(n.props),n}return r.__extends(DiagramSearchResultInner,e),DiagramSearchResultInner.prototype.componentWillReceiveProps=function(e){e.query!==this.props.query&&(this.setState({isLoading:!0,errorMessage:void 0}),this.loadQueryData(e))},DiagramSearchResultInner.prototype.render=function(){var e=this.state,t=e.iris,n=e.isLoading,r=e.errorMessage;if(n)return i.createElement(v.Spinner,null);if(r)return i.createElement("div",null,i.createElement(h.ErrorNotification,{errorMessage:r}));if(t){var a={};this.props.context.searchProfileStore.map((function(e){return e.categories.forEach((function(e){return a[e.iri.value]={image:e.thumbnail,color:e.color}}))}));var o=i.Children.only(this.props.children);if(!g.componentHasType(o,f.Ontodia))throw Error("The child element should be Ontodia");var s=i.cloneElement(o,{onLoadWorkspace:this.onLoadWorkspace,nodeStyles:a});return 1===t.length?i.cloneElement(s,{iri:t[0]}):i.cloneElement(s,{iris:t})}},DiagramSearchResultInner.prototype.buildElements=function(e,t){return a.Set(o.flatMap(t.results.bindings,(function(e){return o.values(e)}))).filter((function(e){return e.isIri()})).map((function(e){return e.value})).toArray()},DiagramSearchResultInner}(i.Component);t.default=y}}]);
//# sourceMappingURL=diagram-search-result-94a786856e54a7d4573c.js.map