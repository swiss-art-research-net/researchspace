(window.webpackJsonp=window.webpackJsonp||[]).push([[363],{1412:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(11),n=r(1),i=r(1),a=r(72),l=r(139),s=r(23),c=r(56),p=r(633),u=r(63),m=r(118),d=r(1214),f=r(639),h=function(e){function ImportResourceComponent(t,r){var o=e.call(this,t,r)||this;return o.performPostAction=function(e){o.props.postAction&&"reload"!==o.props.postAction?"redirect"===o.props.postAction?u.navigateToResource(s.Rdf.iri(e)).onValue((function(e){return e})):u.navigateToResource(s.Rdf.iri(o.props.postAction)).onValue((function(e){return e})):u.refresh()},o.importFromText=function(e){o.setState({wait:!0}),o.getLDPService().importFromText(e,o.props.container,o.props.force).onValue(o.onServerResponse).onError(o.onServerError)},o.importFromURL=function(e){var t=o.getLDPService();t.importGetTextFromURL(e).flatMap((function(e){return t.importFromText(e,o.props.container,o.props.force).onValue(o.onServerResponse).onError(o.onServerError)})).onError(o.onServerError)},o.importFromDelayedId=function(e,t){o.getLDPService().importFromDelayedId(e,t).onValue(o.onServerResponse).onError(o.onServerError)},o.onServerResponse=function(e){202===e.status?o.setState({serverDialog:e.text}):201===e.status&&o.setState({serverDone:e.header.location,wait:!1})},o.onServerError=function(e){console.error("Error during import: "+JSON.stringify(e)),o.setState({serverError:e,wait:!1})},o.state={show:!1,wait:!1},o}return o.__extends(ImportResourceComponent,e),ImportResourceComponent.prototype.shouldComponentUpdate=function(e,t){return!this.state.show&&t.show?this.refs.trigger.show():this.state.show&&!t.show&&this.refs.trigger.hide(),!0},ImportResourceComponent.prototype.getLDPService=function(){return new m.LdpService("",this.context.semanticContext)},ImportResourceComponent.prototype.renderContainerList=function(e,t){var r=this;return n.createElement(a.FormGroup,null,"Select container to import into",n.createElement(a.FormGroup,null,t.map((function(t){return n.createElement(a.Radio,{name:"select-container",value:t["@id"],checked:e===t["@id"],onChange:function(){return r.setState({selectedContainer:t["@id"]})}},n.createElement("span",{title:t["@id"]},n.createElement(d.ResourceLabel,{iri:t["@id"]})))}))))},ImportResourceComponent.prototype.renderContainerMessage=function(e,t){return this.props.container?n.createElement(a.FormGroup,null,"Import will be made into ",n.createElement(p.ResourceLinkComponent,{uri:this.props.container})):0===t.length?n.createElement(a.FormGroup,null,"Suitable for import container not found"):1===t.length?n.createElement(a.FormGroup,null,"Import will be made into ",n.createElement(p.ResourceLinkComponent,{uri:t[0]["@id"]})):t.length>1?this.renderContainerList(e,t):null},ImportResourceComponent.prototype.renderUnknownObjectsMessage=function(e){return e.length>0?n.createElement(a.FormGroup,null,"These object IRIs are not present in target DB:",e.map((function(e){return n.createElement("div",null,n.createElement(a.ControlLabel,null,e["@id"]+"\n"))}))):null},ImportResourceComponent.prototype.renderModal=function(){var e=this,t=this.state,r=t.wait,o=t.serverDone,i=t.serverDialog,l=t.serverError,s=t.selectedContainer;if(o)return n.createElement(a.Modal,{show:!0,onHide:function(){e.setState({serverDone:void 0},(function(){return e.performPostAction(o)}))}},n.createElement(a.ModalHeader,null,n.createElement(a.ModalTitle,null,"Success")),n.createElement(a.ModalBody,null,"Import successfully done, resource ",n.createElement(p.ResourceLinkComponent,{uri:o})," created"));if(l)return n.createElement(a.Modal,{show:!0,onHide:function(){e.setState({serverError:void 0})}},n.createElement(a.ModalHeader,null,n.createElement(a.ModalTitle,null,"Error")),n.createElement(a.ModalBody,null,"Unexpected error during import"));if(i){var c=JSON.parse(i),u=c.delayedImportRequestId,m=c.possibleContainers,d=c.unknownObjects,h=(this.props.container||m.length>0)&&(this.state.selectedContainer||this.props.container||!this.props.container&&1===m.length),v=h?this.state.selectedContainer||this.props.container||m[0]["@id"]:null;return n.createElement(a.Modal,{show:!0,onHide:function(){e.setState({serverDialog:void 0})}},n.createElement(a.ModalHeader,null,n.createElement(a.ModalTitle,null,"Clarification needed")),n.createElement(a.ModalBody,null,this.renderContainerMessage(s,m),this.renderUnknownObjectsMessage(d)),n.createElement(a.ModalFooter,null,n.createElement(a.Button,{disabled:!h,onClick:function(){e.importFromDelayedId(u,v),e.setState({serverDialog:void 0,selectedContainer:void 0})}},"Proceed"),n.createElement(a.Button,{onClick:function(){return e.setState({serverDialog:void 0,selectedContainer:void 0,wait:!1})}},"Cancel")))}return r?n.createElement(a.Modal,{show:!0,onHide:function(){}},n.createElement(a.ModalBody,null,n.createElement(f.Spinner,null))):null},ImportResourceComponent.prototype.render=function(){var e=this,t=i.Children.only(this.props.children),r=n.createElement(a.Popover,{id:"import-resource"},n.createElement(a.FormControl,{type:"file",className:"input-sm",onChange:function(t){var r=t.target.files;if(1===r.length){var o=r[0],n=new FileReader;n.onload=function(t){var r=t.target.result;e.setState({show:!1}),e.importFromText(r)},n.readAsText(o)}}}));return n.createElement(a.OverlayTrigger,{ref:"trigger",trigger:[],placement:"bottom",rootClose:!0,overlay:r,onExit:function(){e.setState({show:!1})}},i.cloneElement.apply(void 0,o.__spreadArrays([t,l({},t.props,{onClick:function(){return e.setState({show:!e.state.show})}})],t.props.children,[this.renderModal()])))},ImportResourceComponent}(c.Component);t.ImportResourceComponent=h,t.default=h}}]);
//# sourceMappingURL=mp-ldp-import-resource-95b9ec09a3d09d9f3a05.js.map