(window.webpackJsonp=window.webpackJsonp||[]).push([[468],{1488:function(e,i,t){Object.defineProperty(i,"__esModule",{value:!0});var r=t(11),a=t(1),n=t(1),o=t(16),l=t(33),s=t(23),u=t(61),c=t(118),v=t(63),p=t(116),b=t(1601);t(1489);var f={public:s.vocabularies.VocabPlatform.publicVisibility.value,private:s.vocabularies.VocabPlatform.privateVisibility.value,shared:s.vocabularies.VocabPlatform.sharedVisibility.value,group:s.vocabularies.VocabPlatform.groupVisibility.value},d="\n  SELECT ?value ?label {\n    ?value a Platform:Group .\n    ?value rdfs:label ?label .\n  }\n",y=function(e){function ShareComponent(i,t){var r=e.call(this,i,t)||this;return r.renderGroupSelector=function(){return a.createElement(b.AutoCompletionInput,{className:"visibility-group-selector",placeholder:"select groups",value:r.state.groups,query:d,defaultQuery:d,actions:{onSelected:r.onGroupsSelected},multi:!0})},r.isSelected=function(e){return r.state.visibility===e},r.onClick=function(e){var i=e.target.value,t=c.LdpService.setVisibility(v.getCurrentResource(),s.Rdf.iri(i),[]);t.onValue((function(e){r.setState({visibility:i,groups:[]}),r.notifyVisibilityChange()})),t.onError((function(e){r.setState({errorMessage:l.Just("error"),visibility:f.private})}))},r.selectGroups=function(e){return u.SparqlClient.select("\n      SELECT ?value ?label WHERE {\n         <"+e+"> <"+s.vocabularies.VocabPlatform.visibleToGroups.value+"> ?value .\n         ?value rdfs:label ?label .\n      }\n    ").onValue((function(e){return r.setState({groups:e.results.bindings})}))},r.onGroupsSelected=function(e){var i=o.map(e,(function(e){return e.value}));c.LdpService.setVisibility(v.getCurrentResource(),s.Rdf.iri(r.state.visibility),i).onValue((function(i){r.setState({groups:e}),r.notifyVisibilityChange()}))},r.notifyVisibilityChange=function(){return p.addNotification({message:"Visibility of item has been changed",level:"success",autoDismiss:2})},r.state={visibility:f.private,errorMessage:l.Nothing(),groups:[]},r}return r.__extends(ShareComponent,e),ShareComponent.prototype.componentDidMount=function(){var e=this,i=this.props.iri||v.getCurrentResource().value;u.SparqlClient.select("SELECT ?visibility WHERE {\n         OPTIONAL { <"+i+"> <"+s.vocabularies.VocabPlatform.visibility.value+"> ?vis }\n         BIND(COALESCE(?vis, <"+s.vocabularies.VocabPlatform.privateVisibility.value+">) as ?visibility).\n      }").onValue((function(t){var r=t.results.bindings[0].visibility.value;e.setState({visibility:r}),r===f.group&&e.selectGroups(i)})).onError((function(i){return e.setState({visibility:f.private,errorMessage:l.Just(i)})}))},ShareComponent.prototype.render=function(){var e=this;return a.createElement("div",{className:"share-component"},a.createElement("fieldset",{id:"visibility-input"},o.keys(f).map((function(i){return a.createElement("div",{className:"radio"},a.createElement("label",{className:"control-label",key:"visibility"+i},a.createElement("input",{type:"radio",name:"visibility",value:f[i],onClick:e.onClick,checked:e.isSelected(f[i])}),o.upperFirst(i)),f[i]===f.group&&e.isSelected(f.group)?e.renderGroupSelector():null)}))))},ShareComponent}(n.Component);i.ShareComponent=y,i.default=y}}]);
//# sourceMappingURL=rs-visibility-5f87de4d38a2d48dff0c.js.map