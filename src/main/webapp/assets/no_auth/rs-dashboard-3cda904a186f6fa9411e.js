(window.webpackJsonp=window.webpackJsonp||[]).push([[455],{1538:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),r=n(1),i=n(16),o=n(1579),s=n(63),c=n(56),l=n(630),d=n(117),m=n(636),u=n(3532),p=n(1308),f=n(34),h=n(162),v=n(2395),g=0;function emptyItem(){return g+=1,{id:i.uniqueId("frame"),index:g}}t.emptyItem=emptyItem;var y=function(e){function DashboardComponent(t,n){var r=e.call(this,t,n)||this;return r.cancellation=new f.Cancellation,r.onAddNewItem=function(e){void 0===e&&(e=emptyItem());var t=r.props.views.find((function(t){return t.id===e.viewId}));(null==t?void 0:t.unique)&&r.state.items.find((function(t){return t.viewId===e.viewId}))||r.setState((function(t){var n=a.__spreadArrays(t.items);return n.push(e),{items:n}}),(function(){r.onSelectView({itemId:e.id,viewId:e.viewId,resourceIri:e.resourceIri})}))},r.state={items:[]},r}return a.__extends(DashboardComponent,e),DashboardComponent.prototype.componentDidMount=function(){var e=this;if(this.cancellation.map(h.listen({eventType:v.AddFrameEvent,target:this.props.id})).observe({value:function(t){var n=t.data;e.onAddNewItem(a.__assign(a.__assign({},emptyItem()),n))}}),this.props.initialView){var t=a.__assign(a.__assign({},emptyItem()),{resourceIri:this.props.initialView.resource,viewId:this.props.initialView.view});this.onAddNewItem(t)}else this.onAddNewItem();s.setFrameNavigation(!0,(function(e,t){return e.value.startsWith("http://www.researchspace.org/instances/narratives")?(h.trigger({eventType:"Dashboard.AddFrame",source:"link",targets:["thinking-frames"],data:{resourceIri:e.value,viewId:"semantic-narrative"}}),!0):"http://www.researchspace.org/resource/ThinkingFrames"===e.value&&t&&t.view?(h.trigger({eventType:"Dashboard.AddFrame",source:"link",targets:["thinking-frames"],data:{resourceIri:t.resource,viewId:t.view}}),!0):"http://www.researchspace.org/resource/ThinkingFrames"===e.value?(h.trigger({eventType:"Dashboard.AddFrame",source:"link",targets:["thinking-frames"]}),!0):!e.value.startsWith("http://www.researchspace.org/resource/")&&(h.trigger({eventType:"Dashboard.AddFrame",source:"link",targets:["thinking-frames"],data:{resourceIri:e.value,viewId:"resource"}}),!0)}))},DashboardComponent.prototype.componentWillUnmount=function(){s.setFrameNavigation(!1),this.cancellation.cancelAll()},DashboardComponent.prototype.onExpandItem=function(e){this.setState((function(t){return{items:t.items.map((function(t){return t.id===e?a.__assign(a.__assign({},t),{isExpanded:!t.isExpanded}):t}))}}))},DashboardComponent.prototype.renderLabel=function(e){var t=this,n=this.state.focus===e.id?p.itemLabelActive:"",a=e.viewId?this.props.views.find((function(t){return t.id===e.viewId})):void 0;if(a&&e.resourceIri){var i=r.createElement("span",null,"[",a.label,"] ");return a.iconClass?i=r.createElement("i",{className:a.iconClass}):a.image&&(i=r.createElement("img",{src:a.image,className:p.itemImage,alt:a.label})),r.createElement("span",{className:p.itemLabel+" "+n},r.createElement("span",{className:p.itemIcon},i),r.createElement("span",null,r.createElement(l.TemplateItem,{key:e.id,template:{source:a.itemLabelTemplate||"<mp-label iri='{{iri}}'></mp-label>",options:{iri:e.resourceIri,dashboardId:e.id}}})),r.createElement("button",{className:"btn btn-xs pull-right "+p.deleteItemButton,onClick:function(){return t.onRemoveItem(e)}},r.createElement("i",{className:"fa fa-times"})))}return r.createElement("span",{className:p.itemLabel+" "+n},"Frame ",e.index,r.createElement("button",{className:"btn btn-xs pull-right "+p.deleteItemButton,onClick:function(){return t.onRemoveItem(e)}},r.createElement("i",{className:"fa fa-times"})))},DashboardComponent.prototype.renderBody=function(e){var t=e.viewId?this.props.views.find((function(t){return t.id===e.viewId})):void 0;return t&&t.itemBodyTemplate?r.createElement(l.TemplateItem,{key:e.id,template:{source:t.itemBodyTemplate,options:{iri:e.resourceIri,dashboardId:e.id}}}):null},DashboardComponent.prototype.removeItem=function(e){this.setState((function(t){var n=a.__spreadArrays(t.items),r=n.findIndex((function(t){return t.id===e}));return n.splice(r,1),i.isEmpty(n)&&(n=[emptyItem()]),{items:n}}))},DashboardComponent.prototype.onRemoveItem=function(e){var t=this,removeItem=function(){e.linkedBy?t.state.items.forEach((function(n){var a=n.id;n.linkedBy===e.linkedBy&&t.removeItem(a)})):t.removeItem(e.id)};if(e.isDirty){var onHide_1=function(){return d.getOverlaySystem().hide("removing-confirmation")};d.getOverlaySystem().show("removing-confirmation",r.createElement(m.ConfirmationDialog,{message:"Frame has unsaved changes. Are you sure you want to delete it?",onHide:onHide_1,onConfirm:function(e){onHide_1(),e&&removeItem()}}))}else removeItem()},DashboardComponent.prototype.renderItems=function(){var e=this,t=this.state.items;return t.length?r.createElement("div",{className:"list-group "+p.itemsList},t.map((function(t){var n=e.renderBody(t);return r.createElement("div",{key:t.id,className:"list-group-item",onClick:function(){return e.setState({focus:t.id})}},r.createElement("div",{className:p.itemLabelContainer},n?r.createElement("button",{className:"btn btn-xs "+p.expandItemButton,onClick:function(){return e.onExpandItem(t.id)}},r.createElement("i",{className:"fa "+(t.isExpanded?"fa fa-caret-down":"fa-caret-right")})):null,e.renderLabel(t)),n&&t.isExpanded?n:null)}))):r.createElement("div",{className:"text-center"},"No frames")},DashboardComponent.prototype.onSelectView=function(e){var t=e.itemId,n=e.viewId,r=e.resourceIri,i=this.props.linkedViews;this.setState((function(e){var o=a.__spreadArrays(e.items);return o.forEach((function(e,s){if(e.id===t){var c=i.find((function(e){return e.id===n}));if(c){var l=o.findIndex((function(e){return e.id===t})),d=c.viewIds.map((function(e){return a.__assign(a.__assign({},emptyItem()),{viewId:e,resourceIri:r,linkedBy:t})}));o.splice.apply(o,a.__spreadArrays([l,1],d))}else o[s]=a.__assign(a.__assign({},e),{viewId:n,resourceIri:r})}})),{items:o}}))},DashboardComponent.prototype.onStatusChange=function(e,t){this.setState((function(n){return{items:n.items.map((function(n){return n.id===e?a.__assign(a.__assign({},n),{isDirty:t}):n}))}}))},DashboardComponent.prototype.onResourceChange=function(e,t,n){this.setState((function(r){return{items:r.items.map((function(r){return r.id===e?a.__assign(a.__assign({},r),{resourceIri:t,data:n}):r}))}}))},DashboardComponent.prototype.renderView=function(e){var t=this,n=this.props,i=n.views,o=n.linkedViews,s=a.__spreadArrays(i);o.forEach((function(e){s.push({id:e.id,label:e.label,template:"",image:e.image,iconClass:e.iconClass,description:e.description,checkQuery:e.checkQuery})}));var c=[];return e.linkedBy&&this.state.items.forEach((function(t){var n=t.id,a=t.viewId;if(t.linkedBy===e.linkedBy){var r=i.find((function(e){return e.id===a}));r&&c.push({frameId:n,frameVariable:r.frameVariable})}})),r.createElement("div",{key:e.id,className:p.viewContainer},r.createElement(u.DashboardItem,{id:e.id,views:s,viewId:e.viewId,gridView:!0,resourceIri:e.resourceIri,data:e.data,linkedFrames:c,onSelect:function(n){var a=n.viewId,r=n.resourceIri;return t.onSelectView({itemId:e.id,viewId:a,resourceIri:r})},onStatusChange:function(n){return t.onStatusChange(e.id,n)},onResourceChange:function(n,a){return t.onResourceChange(e.id,n,a)},onFocus:function(){return t.setState({focus:e.id})}}))},DashboardComponent.prototype.render=function(){var e=this,t=this.state.items,n=r.Children.toArray(this.props.children),a=t.map((function(t){return{id:t.id,type:o.WorkspaceLayoutType.Component,className:"thinking-frames__frames",content:e.renderView(t),heading:e.renderLabel(t),minSize:e.props.frameMinSize}}));n.length>1&&a.unshift({id:"heading",type:o.WorkspaceLayoutType.Component,className:"thinking-frames__frames",content:r.Children.only(n[1]),heading:null,minSize:60,defaultSize:60});var i={type:o.WorkspaceLayoutType.Row,children:[{type:o.WorkspaceLayoutType.Column,children:[{id:"thought-board",type:o.WorkspaceLayoutType.Component,className:"thinking-frames__clipboard-sidebar",content:r.Children.only(n[0]),heading:"Clipboard"},{id:"items",type:o.WorkspaceLayoutType.Component,defaultCollapsed:!0,className:"thinking-frames__frames-sidebar",content:r.createElement("div",{className:p.itemsContainer},this.renderItems()),heading:r.createElement("div",null,"Thinking Frames ",r.createElement("button",{className:"btn btn-link btn-xs pull-right "+p.addItemButton,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.onAddNewItem()}},r.createElement("i",{className:"fa fa-plus"})," Add frame"))}],defaultSize:300},{type:o.WorkspaceLayoutType.Column,children:a,undocked:!0}]};return r.createElement(o.WorkspaceLayout,{layout:i,_onResize:function(){return window.dispatchEvent(new Event("resize"))}})},DashboardComponent.defaultProps={frameMinSize:150,linkedViews:[]},DashboardComponent}(c.Component);t.DashboardComponent=y,t.default=y},2395:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(162);t.AddFrameEvent="Dashboard.AddFrame";var r=a.EventMaker;t.StatusChanged=r("Dashboard.StatusChanged"),t.ResourceChanged=r("Dashboard.ResourceChanged")},3532:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var a=n(11),r=n(1),i=n(72),o=n(56),s=n(630),c=n(1632),l=n(34),d=n(162),m=n(1308),u=n(2395),p=function(e){function DashboardItem(t,n){var a=e.call(this,t,n)||this;return a.cancellation=new l.Cancellation,a.onFocus=function(){var e=a.props.onFocus;e&&e(!0)},a.onDrop=function(e,t){var n=a.props.onSelect;n&&n({viewId:t,resourceIri:e.value}),a.onFocus()},a.renderDefaultDropArea=function(e,t){return r.createElement(c.DropArea,{query:e.checkQuery,onDrop:function(t){return a.onDrop(t,e.id)},childrenClassName:m.dropAreaChildren+" "+m.notOpacity,dropMessageWrapperStyle:{display:"none"},dropStyles:{enabledHover:{backgroundColor:"#f6f6f6",outline:"3px dashed #1d0a6e"},enabled:{outline:"1px solid #ddd"},disabled:{opacity:".2"}}},r.createElement("div",{className:m.defaultComponent,onClick:function(){return a.onDefaultDropAreaClick(e)}},r.createElement("div",{className:"media"},r.createElement("div",{className:"media-left media-middle"},t),r.createElement("div",{className:"media-body"},r.createElement("strong",{className:"media-heading"},e.label),r.createElement("div",{className:"media-description"},e.description)))))},a.onDefaultDropAreaClick=function(e){e.resourceNotRequired?a.props.onSelect({viewId:e.id}):a.setState({selectedView:e.id})},a.renderDefaultDashboard=function(){var e=a.props.views;return r.createElement("div",{className:m.defaultDashboard+" container-fluid",onClick:a.onFocus},r.createElement(i.Row,null,e.map((function(e){var t;return e.image?t=r.createElement("img",{src:e.image,className:"media-object "+m.image,alt:e.label}):e.iconClass&&(t=r.createElement("span",{className:e.iconClass+" "+m.icon})),r.createElement(i.Col,{key:e.id,md:4,xs:12,lg:4,sm:6},r.createElement("div",{className:m.defaultColumnItem},a.renderDefaultDropArea(e,t)))}))))},a.renderItemCard=function(e){var t;return e.image?t=r.createElement("img",{src:e.image,className:"media-object "+m.image,alt:e.label}):e.iconClass&&(t=r.createElement("span",{className:e.iconClass+" "+m.icon})),r.createElement("div",{key:e.id},r.createElement("div",null,a.renderDefaultDropArea(e,t)))},a.renderGridViewDashboard=function(){var e=a.props.views,t=e.filter((function(e){return"authoring"===e.type||!e.type})),n=e.filter((function(e){return"search"===e.type||"view"===e.type}));return r.createElement("div",{className:m.gridViewDashboard,onClick:a.onFocus},r.createElement("div",{className:m.help},r.createElement("i",{className:"fa fa-question"}),r.createElement("div",{className:m.helpText},"What is the Thinking Frames?")),r.createElement("div",{className:m.gridViewTitle1},"Search and View"),r.createElement("div",{className:m.gridViewItemsView},n.map(a.renderItemCard)),r.createElement("div",{className:m.gridViewTitle2},"Authoring"),r.createElement("div",{className:m.gridViewItemsAuth},t.map(a.renderItemCard)),r.createElement("div",{className:m.dropResourceContainer},r.createElement("div",null,r.createElement("div",{className:m.dropResourceIcon},r.createElement("i",{className:"rs-icon rs-icon-drop_resource"})),r.createElement("div",{className:m.dropResourceText},"drop resource here"))))},a.renderEmptySelectedComponent=function(){var e,t=a.props,n=t.views,i=t.onSelect,o=n.find((function(e){return e.id===a.state.selectedView}));return o.image?e=r.createElement("img",{src:o.image,className:m.imageComponent,alt:o.label}):o.iconClass&&(e=r.createElement("span",{className:o.iconClass+" "+m.icon+" "+m.iconComponent})),r.createElement("div",{className:m.emptyPageDropArea,onClick:a.onFocus},r.createElement(c.DropArea,{onDrop:function(e){return a.onDrop(e,o.id)},query:o.checkQuery,childrenClassName:m.dropAreaChildren+" "+m.notOpacity,style:{display:"flex",flex:1,width:"100%"},dropMessageWrapperStyle:{display:"none"},dropStyles:{enabledHover:{backgroundColor:"#f6f6f6"},enabled:{outline:"3px dashed #1d0a6e"},disabled:{backgroundColor:"#ff000054"}}},r.createElement("div",{className:m.emptyPageTitle},e,r.createElement("div",null,r.createElement("div",{className:m.emptyPageLabel},o.label),r.createElement("div",{className:m.emptyPageDescription},o.description))),r.createElement("div",{className:m.emptyPageDrop},r.createElement("div",null,r.createElement("i",{className:"rs-icon rs-icon-drop_resource"})),r.createElement("div",{className:m.emptyPageDroptext},"drop resource here"),o.resourceNotRequired?r.createElement("div",null,"or",r.createElement("br",null),r.createElement("a",{href:"",onClick:function(e){e.preventDefault(),i&&i({viewId:o.id})}},"Create New ",o.label)):null)))},a.renderComponent=function(){var e,t=a.props,n=t.id,i=t.views,o=t.viewId,c=t.resourceIri,l=t.data,d=t.linkedFrames,u=void 0===d?[]:d,p=i.find((function(e){return e.id===o})),f=p.template,h=p.frameVariable,v=((e={iri:c})[void 0===h?"dashboardId":h]=n,e.data=l,e);return u.forEach((function(e){return v[e.frameVariable]=e.frameId})),r.createElement("div",{className:m.template,onClick:a.onFocus,onWheel:a.onFocus,onDrop:a.onFocus},r.createElement(s.TemplateItem,{template:{source:f,options:v}}))},a.state={},a}return a.__extends(DashboardItem,e),DashboardItem.prototype.componentWillUnmount=function(){this.cancellation.cancelAll()},DashboardItem.prototype.componentDidMount=function(){var e=this.props,t=e.id,n=e.onStatusChange,a=e.onResourceChange;this.cancellation.map(d.listen({eventType:u.StatusChanged,target:t})).observe({value:function(e){var t=e.data;n&&n(t.hasChanges)}}),this.cancellation.map(d.listen({eventType:u.ResourceChanged,target:t})).observe({value:function(e){var t=e.data;a&&a(t.resourceIri,t.data)}}),this.onFocus()},DashboardItem.prototype.render=function(){var e=this.props,t=e.views,n=e.viewId,a=e.gridView,r=this.state.selectedView;return 0===t.length?null:n?this.renderComponent():r?this.renderEmptySelectedComponent():a?this.renderGridViewDashboard():this.renderDefaultDashboard()},DashboardItem}(o.Component);t.DashboardItem=p,t.default=p}}]);
//# sourceMappingURL=rs-dashboard-3cda904a186f6fa9411e.js.map