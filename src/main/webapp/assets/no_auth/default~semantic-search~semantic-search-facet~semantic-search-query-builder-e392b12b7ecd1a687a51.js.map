{"version":3,"sources":["webpack:///./src/main/web/components/semantic/search/config/Defaults.ts"],"names":["DefaultInlineProfile","DefaultProfile","DefaultSearchProfileCategoriesQuery","DefaultSearchProfileRelationsQuery","DefaultTextPattern","kind","queryPattern","ConfigHolder","getUIConfig","labelPropertyPattern","CategoryViewTemplate","RelationViewTemplate","ResultLimit","DefaultFacetValuesQueries","forResource","FACET_VARIABLES","RELATION_PATTERN_VAR","forLiteral","forDateRange","forNumericRange","ResourceRelationPattern","RELATION_VAR","LiteralRelationPattern","DefaultFacetValueTemplate","resource","literal","DefaultFacetRelationTupleTemplate","DefaultFacetCategoriesTupleTemplate","DefaultResourceSelectorQuery","SEMANTIC_SEARCH_VARIABLES","DefaultResourceSelectorRelationPattern","DefaultResourceSelectorSuggestionTemplate","DefaultResourceSelectorNoSuggestionsTemplate"],"mappings":"iIAmBA,aACA,UAEa,EAAAA,qBAAuB,2EAEvB,EAAAC,eAAiB,yFACjB,EAAAC,oCAAsC,88CA4CtC,EAAAC,mCAAqC,uyCA+BlD,8BAAgBC,qBACd,MAAO,CACL,oFAAqF,CACnF,CACEC,KAAM,OACNC,aAAc,gFAGE,EAAAC,aAAaC,cAAcC,qBAAoB,2QAa1D,EAAAC,qBAAuB,sTAYvB,EAAAC,qBAAuB,yCAKvB,EAAAC,YAAc,IAE3B,SAAiBC,GACC,EAAAC,YAAhB,SAAgBA,cACd,MAAO,uFAEO,EAAAC,gBAAgBC,qBAAoB,kEAOpC,EAAAC,WAAhB,SAAgBA,aACd,MAAO,yFAEO,EAAAF,gBAAgBC,qBAAoB,sEAOpC,EAAAE,aAAhB,SAAgBA,eACd,MAAO,yEAEO,EAAAH,gBAAgBC,qBAAoB,6CAKpC,EAAAG,gBAAhB,SAAgBA,kBACd,MAAO,yFAEO,EAAAJ,gBAAgBC,qBAAoB,qDAKvC,EAAAI,wBAA0B,aAAa,EAAAL,gBAAgBM,aAAY,UACnE,EAAAC,uBAAyB,aAAa,EAAAP,gBAAgBM,aAAY,YAtCjF,CAAiB,EAAAR,4BAAA,EAAAA,0BAAyB,KAyC7B,EAAAU,0BAA4B,CACvCC,SAAU,wGACVC,QAAS,2GAGE,EAAAC,kCAAoC,2UAWpC,EAAAC,oCAAsC,wVAYnD,wCAAgBC,+BACd,MAAO,sQAQW,EAAArB,aAAaC,cAAcC,qBAAoB,uDAE/C,EAAAoB,0BAA0Bb,qBAAoB,4DAKrD,EAAAc,uCAAyC,aAAa,EAAAD,0BAA0BR,aAAY,eAC5F,EAAAU,0CAA4C,uDAC5C,EAAAC,6CAA+C","file":"default~semantic-search~semantic-search-facet~semantic-search-query-builder-e392b12b7ecd1a687a51.js","sourcesContent":["/**\n * ResearchSpace\n * Copyright (C) 2020, Â© Trustees of the British Museum\n * Copyright (C) 2015-2019, metaphacts GmbH\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { ConfigHolder } from 'platform/api/services/config-holder';\nimport { SEMANTIC_SEARCH_VARIABLES, FACET_VARIABLES, Patterns } from './SearchConfig';\n\nexport const DefaultInlineProfile = '<http://www.researchspace.org/semantic-search/dummyInlineDefaultProfile>';\n\nexport const DefaultProfile = '<http://www.researchspace.org/resource/system/semantic-search-profile/default-profile>';\nexport const DefaultSearchProfileCategoriesQuery = `\n  PREFIX ssp: <http://www.researchspace.org/resource/system/semantic-search-profile/>\n  PREFIX schema: <http://schema.org/>\n\n  SELECT DISTINCT ?profile ?category ?label ?description ?thumbnail WHERE {\n    {\n      SELECT ?category ?label ?profile ?description ?thumbnail {\n        ?profile ssp:hasCategory ?hasCategory.\n        {\n          ?hasCategory ssp:category ?category .\n          ?category rdf:type ssp:Category ;\n            rdfs:label ?label ;\n            rdfs:label ?description ;\n            schema:thumbnail ?thumbnail ;\n            ssp:order ?order .\n        } UNION {\n          BIND(ssp:TextCategory AS ?category) .\n          BIND(\"text search\" AS ?label) .\n          BIND(\"text search\" AS ?description) .\n          BIND(\"../images/fcs/keywords.svg\" AS ?thumbnail) .\n          BIND(10 AS ?order) .\n        }\n      }\n    } UNION {\n      SELECT ?profile ?category ?label ?description ?thumbnail {\n        ?category rdf:type ssp:Category ;\n          rdfs:label ?label ;\n          rdfs:label ?description ;\n          schema:thumbnail ?thumbnail ;\n          ssp:order ?order .\n        BIND(ssp:default-profile as ?profile) .\n      }\n    } UNION {\n      BIND(ssp:TextCategory as ?category) .\n      BIND(\"text search\" as ?label) .\n      BIND(\"text search\" as ?description) .\n      BIND(\"../images/fcs/keywords.svg\" AS ?thumbnail) .\n      BIND(10 AS ?order) .\n      BIND(ssp:default-profile AS ?profile) .\n    }\n  }\n  ORDER BY ?order\n`;\n\nexport const DefaultSearchProfileRelationsQuery = `\n  PREFIX ssp: <http://www.researchspace.org/resource/system/semantic-search-profile/>\n\n  SELECT DISTINCT ?profile ?relation ?label ?description ?hasDomain ?hasRange ?order WHERE {\n    {\n      SELECT ?profile ?relation ?label ?hasDomain ?hasRange ?description ?orderLabel ?order {\n        ?profile ssp:hasRelation/ssp:relation ?relation.\n          ?relation rdfs:label ?label ;\n          rdfs:label ?description ;\n          ssp:hasDomain ?hasDomain ;\n          ssp:hasRange ?hasRange .\n        OPTIONAL { ?relation ssp:hasBroaderRelation ?broader }.\n        BIND(IF(BOUND(?broader), CONCAT(STR(?broader), \\\"1\\\"), CONCAT(STR(?relation), \\\"0\\\")) AS ?orderLabel)\n        BIND(IF(BOUND(?broader), 15, 0) AS ?order)\n      }\n    } UNION {\n      SELECT ?profile ?relation ?label ?hasDomain ?hasRange ?description ?orderLabel ?order  {\n        ?relation rdfs:label ?label ;\n          rdfs:label ?description ;\n          ssp:hasDomain ?hasDomain ;\n          ssp:hasRange ?hasRange .\n        BIND(ssp:default-profile as ?profile) .\n        OPTIONAL { ?relation ssp:hasBroaderRelation ?broader }.\n        BIND(IF(BOUND(?broader), CONCAT(STR(?broader), \\\"1\\\"), CONCAT(STR(?relation), \\\"0\\\")) AS ?orderLabel)\n        BIND(IF(BOUND(?broader), 25, 0) AS ?order)\n      }\n    }\n  }\n  ORDER BY ?orderLabel ?label\n`;\n\nexport function DefaultTextPattern(): Patterns {\n  return {\n    'http://www.researchspace.org/resource/system/semantic-search-profile/TextCategory': [\n      {\n        kind: 'text',\n        queryPattern: `\n           {\n             $subject a ?__domain__ .\n             $subject ${ConfigHolder.getUIConfig().labelPropertyPattern} ?label .\n             SERVICE <http://www.bigdata.com/rdf/search#search> {\n               ?label bds:search ?__value__ ;\n                      bds:minRelevance \"0.3\" ;\n                      bds:matchAllTerms \"true\"  .\n             }\n           }\n      `,\n      },\n    ],\n  };\n}\n\nexport const CategoryViewTemplate = `\n  <div style=\"display: flex; align-items: center;\">\n    {{#if thumbnail}}\n      {{#ifCond thumbnail.length '>' 0}}\n        <div class=\"semantic-search__class-selector-item\">\n          <img src=\"{{thumbnail}}\" />\n        </div>\n      {{/ifCond}}\n    {{/if}}\n    <span>{{label}}</span>\n  </div>\n`;\nexport const RelationViewTemplate = `\n  <div>\n    {{label}}\n  </div>\n  `;\nexport const ResultLimit = 1000;\n\nexport namespace DefaultFacetValuesQueries {\n  export function forResource() {\n    return `\n      SELECT ?value (COUNT(DISTINCT $subject) AS ?count) WHERE {\n        FILTER(?${FACET_VARIABLES.RELATION_PATTERN_VAR})\n      }\n      GROUP BY ?value\n      ORDER BY ?value\n    `;\n  }\n\n  export function forLiteral() {\n    return `\n      SELECT ?literal (COUNT(DISTINCT $subject) AS ?count) WHERE {\n        FILTER(?${FACET_VARIABLES.RELATION_PATTERN_VAR})\n      }\n      GROUP BY ?literal\n      ORDER BY ?literal\n    `;\n  }\n\n  export function forDateRange() {\n    return `\n      SELECT ?dateBeginValue ?dateEndValue WHERE {\n        FILTER(?${FACET_VARIABLES.RELATION_PATTERN_VAR})\n      } ORDER BY ?dateBeginValue\n    `;\n  }\n\n  export function forNumericRange() {\n    return `\n      SELECT ?numericRangeBeginValue ?numericRangeEndValue WHERE {\n        FILTER(?${FACET_VARIABLES.RELATION_PATTERN_VAR})\n      } ORDER BY ?numericRangeBeginValue\n    `;\n  }\n\n  export const ResourceRelationPattern = `$subject ?${FACET_VARIABLES.RELATION_VAR} ?value`;\n  export const LiteralRelationPattern = `$subject ?${FACET_VARIABLES.RELATION_VAR} ?literal`;\n}\n\nexport const DefaultFacetValueTemplate = {\n  resource: '<span><mp-highlight highlight=\"{{highlight}}\">{{label.value}}</mp-highlight> ({{count.value}})</span>',\n  literal: '<span><mp-highlight highlight=\"{{highlight}}\">{{literal.value}}</mp-highlight> ({{count.value}})</span>',\n};\n\nexport const DefaultFacetRelationTupleTemplate = `\n <div class=\"facet-relation__content\" title=\"{{$relation.label.value}}\">\n   {{$relation.label.value}}\n   {{#if $range.thumbnail}}\n     {{#ifCond $range.thumbnail.value.length '>' 0}}\n       <img class=\"facet__relation__content__category-image\" src=\"{{$range.thumbnail.value}}\"/>\n     {{/ifCond}}\n   {{/if}}\n  </div>\n`;\n\nexport const DefaultFacetCategoriesTupleTemplate = `\n  {{#if $category.thumbnail}}\n    {{#ifCond $category.thumbnail.value.length '>' 0}}\n      <div class=\"category-item\" style=\"background-image: url('{{$category.thumbnail.value}}')\"></div>\n    {{else}}\n      <span>{{$category.label.value}}</span>\n    {{/ifCond}}\n  {{else}}\n    <span>{{$category.label.value}}</span>\n  {{/if}}\n`;\n\nexport function DefaultResourceSelectorQuery() {\n  return `\n    prefix bds: <http://www.bigdata.com/rdf/search#>\n    SELECT DISTINCT ?suggestion ?label WHERE {\n      ?label bds:search ?__token__ ;\n      bds:relevance ?score ;\n      bds:minRelevance \"0.5\" ;\n      bds:matchAllTerms \"true\"  .\n\n      ?suggestion ${ConfigHolder.getUIConfig().labelPropertyPattern} ?label .\n      FILTER(EXISTS {\n        { FILTER(?${SEMANTIC_SEARCH_VARIABLES.RELATION_PATTERN_VAR}) }\n      })\n    } ORDER BY DESC(?score)  LIMIT 30\n  `;\n}\nexport const DefaultResourceSelectorRelationPattern = `?subject $${SEMANTIC_SEARCH_VARIABLES.RELATION_VAR} ?suggestion`;\nexport const DefaultResourceSelectorSuggestionTemplate = `<span title=\"{{label.value}}\">{{label.value}}</span>`;\nexport const DefaultResourceSelectorNoSuggestionsTemplate = `<div class=\"suggestion-no-matches\">no matches found</div>`;\n"],"sourceRoot":""}